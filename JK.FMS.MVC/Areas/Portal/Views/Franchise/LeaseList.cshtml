
@{
    /**/

    ViewBag.Title = "LeaseList";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@section styles{
    <link href="~/Content/admin/assets/global/plugins/jquery-ui/jquery-ui.min.css" rel="stylesheet" />
    <link href="@Url.Content("~/Content/admin/assets/global/plugins/bootstrap-multiselect/css/bootstrap-multiselect.css")" rel="stylesheet" />

    <style type="text/css">
        .lbl-p5 {
            padding: 5px;
        }

            .lbl-p5.red {
                color: red;
            }


            .lbl-p5.green {
                color: lightgreen;
            }

        input[type="text"].txtcolon:before {
            content: ": ";
        }

        .credit-field {
            width: 80px !important;
        }

        .alignRight {
            text-align: right;
        }

        .alignCenter {
            text-align: center;
        }

        .btn.multiselect {
            text-align: left;
            padding-top: 4px;
            padding-bottom: 4px;
            font-size: 11px;
            color: #555;
        }

        .multiselect .caret {
            right: 0;
            position: absolute;
            margin-top: 8px;
            margin-right: 8px;
        }

        .multiselect-container.dropdown-menu {
            text-transform: none;
            font-size: 14px;
            padding-right: 10px;
            padding-left: 40px;
        }

        .no-padding {
            padding: 0;
        }

        .row {
            margin: 0;
        }

        .topheader {
            font-size: 14px;
            font-weight: bold;
            color: #FFF !important;
            text-transform: uppercase;
            margin-top: 3px;
        }

        .custom-form .headerbox {
            padding: 3px 0px 3px 5px;
            font-weight: normal;
        }
         #ui-datepicker-div {
            z-index: 99999 !important;
        }
    </style>

}

<div class="headerbox">
    <div class="row" style="background-color: #3598DC;color: #fff;">
        <div class="col-md-12 no-padding">
            <div class="alignCenter">
                <div class="col-md-4" style="text-align:right;">
                </div>
                <div class="col-md-4 topheader">
                    EQUIPMENT LEASE LIST
                </div>
                <div class="col-md-4" style="padding-right:5px;">
                    <div class="col-md-7 pull-right no-padding" style="margin-top: 2px;margin-bottom: 3px;">
                        <div style="display:table-cell;padding-right: 5px;">
                            Region
                        </div>
                        <div style="display:table-cell;width:100%;">
                            @if (ViewBag.regionlist != null)
                            {
                                <select class="form-control input-sm" id="regionlist" multiple="multiple" style="display:none;">
                                    @foreach (var item in (SelectList)ViewBag.regionlist)
                                    {
                                        <option @(item.Selected ? "selected" : "") value="@item.Value">@item.Text</option>
                                    }
                                </select>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="custom-form portlet light form-horizontal">
    <div class="custom-listbox">
        <div class="headerbox">
            <div class="row no-padding">
                <div class="col-md-1 page-size">
                    <select class="form-control input-sm" id="pageSize" style="width:65px;">
                        <option value="-1">All</option>
                        <option value="100" selected>100</option>
                        <option value="50">50</option>
                        <option value="25">25</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <div class="input-icon" style="width:280px;">
                        <i class="icon-magnifier icon-align-right" style="margin-top: 8px;"></i>
                        <input id="input_Search" type="text" required name="customernumber" autocomplete="off" placeholder="Search..." value="" class="form-control input-sm typeahead" />
                    </div>
                </div>
                <div class="col-md-4"></div>
                <div class="col-md-4 pull-right" style="padding-right:5px;">
                    @if (ViewBag.StatusList != null)
                    {
                        <div class="col-md-12 pull-right no-padding">
                            <div class="col-md-6 no-padding" style="text-transform:none;font-weight:normal;text-align: right;margin-top: 3px;">
                                Lease Status
                            </div>
                            <div class="col-md-6 no-padding" style="padding-left: 6px;">
                                <select id="ddlStatus" multiple="multiple" style="display:none;">
                                    @foreach (var item in (MultiSelectList)ViewBag.StatusList)
                                    {
                                        <option @(item.Selected ? "selected" : "") value="@item.Value">@item.Text</option>
                                    }
                                </select>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            <div class="table-responsive" style="overflow-y: hidden;overflow-x:hidden;">
                <table class="table table-striped table-bordered table-hover order-column" style="display:none;" id="tbllist">
                    <thead>
                        <tr>
                            <th style="width:30px;text-align:center;">
                                Region
                            </th>
                            <th style="width:100px;text-align:center;">
                                Franchisee No.
                            </th>
                            <th style="width:180px;text-align:center;">
                                Franchisee Name
                            </th>
                            <th style="width:80px;text-align:center;">
                                Number of Lease
                            </th>
                            <th style="text-align:center;width:100px;">
                                Monthly Payment Amount
                            </th>
                            <th style="text-align:center;width:110px;">
                                Total Amount Paid
                            </th>
                            <th style="text-align:center;width:70px;">
                                Total Balance
                            </th>
                            <th style="text-align:center;width:50px;">
                                Status
                            </th>
                        </tr>
                    </thead>
                    <tbody></tbody>

                </table>
            </div>
        </div>
    </div>
</div>


<form class="form-horizontal" action="" id="form_service" method="POST">
    <div class="modal fade custom-model custom-form-design" id="modal_LeaseDetail" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-lg">
            <div class="modal-content" style="border-radius: 8px;">
                <div class="modal-header headerbox list" style="padding:0px!important;border-bottom: none;">
                    <div class="row">
                        <div class="col-lg-8 modal-title" style="margin-top: 0px; margin-bottom: 4px; height:40px;  padding: 7px!important;font-size: 12px;font-weight: bold;background: #3598DC !important;color: #FFF !important;border: 1px solid #3598DC !important;padding: 0px;border-radius: 8px 0px 0 0;text-transform: uppercase;">
                            Franchisee Lease Info
                        </div>
                        <div class="modal-title col-lg-3" style="margin-top: 0px; margin-bottom: 4px;  padding: 7px!important;background: #3598DC !important;color: #FFF !important;border: 1px solid #3598DC !important;padding: 0px;border-radius: 0px 0px 0 0;">
                            <div class="col-md-4 control-label">
                                Status<span style="color:#000000;">&nbsp;</span>
                            </div>
                            <div class="col-md-8">
                                <select class="form-control input-sm" id="ddlStatusList" name="ddlStatusList">
                                    @foreach (var item in (MultiSelectList)ViewBag.StatusList)
                                    {
                                        <option value="@item.Value">@item.Text</option>
                                    }
                                </select>
                            </div>
                        </div>
                        <div class="modal-title col-lg-1" style="margin-top: 0px; margin-bottom:    4px;  padding: 7px!important;background: #3598DC !important;color: #FFF !important;border: 1px solid #3598DC !important;padding: 0px;border-radius: 0px 0px 0 0;">                            
                            <button type="button" class="btn btn-primary button-next  pull-right"  data-dismiss="modal"><i class="fa fa-close"></i></button>
                        </div>
                        @*<div class="col-lg-1" style="margin-top: 0px; margin-bottom: 4px; height:40px; padding: 7px!important;background: #3598DC !important;color: #FFF !important;border: 1px solid #3598DC !important;padding: 0px;border-radius: 0px 8px 0 0;text-transform: uppercase;">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="margin-top: 12px !important;margin-right: 12px !important;"></button>
                        </div>*@
                    </div>


                    @*<h4 class="modal-title" style="margin-top: 0px; margin-bottom: 4px;  padding: 7px!important;font-size: 12px;font-weight: bold;background: #3598DC !important;color: #FFF !important;border: 1px solid #3598DC !important;padding: 0px;border-radius: 8px 8px 0 0;text-transform: uppercase;">
                            <select class="form-control input-sm" id="ddlStatusList" name="ddlStatusList"></select>
                        </h4>*@

                </div>
                <div class="modal-body" style="padding: 0px 30px 15px 30px;">
                    <section>
                        <div style="max-width: 100%;margin: 0px auto;padding-left: 0px;padding-right: 0px;border-radius: 8px;">

                            <div class="form-group">
                                <div class="col-md-5" style="border: 1px solid #999;border-radius: 7px;padding: 7px;">
                                    <div class="row">
                                        <div class="col-md-4 control-label" style="padding-top: 0px;">
                                            <b>Franchise No.</b>
                                        </div>
                                        <div class="col-md-8">
                                            <span id="spnFranchiseeNumber"></span>
                                        </div>

                                    </div>
                                    <div class="row">
                                        <div class="col-md-4 control-label" style="padding-top: 0px;">
                                            <b>Franchise Name</b>
                                        </div>
                                        <div class="col-md-8">
                                            <span id="spnFranchiseeName"></span>
                                        </div>

                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="col-md-4 control-label">
                                        @*Status<span style="color:#000000;">&nbsp;:</span>*@
                                    </div>
                                    <div class="col-md-8">
                                        @*<select class="form-control input-sm" id="ddlStatusList" name="ddlStatusList"></select>*@

                                        @*<select class="form-control input-sm" id="ddlStatusList2" name="ddlStatusList2">
                                                @foreach (var item in (MultiSelectList)ViewBag.StatusList)
                                                {
                                                    <option value="@item.Value">@item.Text</option>
                                                }
                                            </select>*@

                                    </div>
                                </div>
                                <div class="col-md-4" style="border: 1px solid #999;border-radius: 7px;padding: 7px;">
                                    <div class="row">
                                        <div class="col-md-4 control-label" style="padding-top: 0px;">
                                            <b>Address</b>
                                        </div>
                                        <div class="col-md-8">
                                            <span id="spnFranchiseeAddress"></span>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-4 control-label" style="padding-top: 0px;">

                                        </div>
                                        <div class="col-md-8">
                                            <span id="spnCityStatePincode"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>


                            <div class="headerbox row" style="margin-bottom: 10px;">
                                <div class="row" style="background-color: #999;color: #fff;padding: 5px 8px;font-weight: bold;">
                                    Lease Information
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-2 control-label">
                                    Lease No<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm" id="txtLeaseNumber" value="70-2121" readonly />
                                </div>


                                <div class="col-md-2 control-label">
                                    Date Signed<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <div class="input-group date" data-date-format="mm/dd/yyyy">
                                        <input type="text" class="form-control input-sm date-picker" id="txtSignDate" value="4/27/2015" disabled />
                                        <span class="input-group-btn">
                                            <button class="btn default" type="button" style="margin-top: 2px;">
                                                <i class="fa fa-calendar"></i>
                                            </button>
                                        </span>
                                    </div>
                                </div>
                                <div class="col-md-2 control-label">
                                    Payment Starts<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <div class="input-group date" data-date-format="mm/dd/yyyy">
                                        <input type="text" class="form-control input-sm date-picker" id="txtStartDate" value="4/27/2015" disabled />
                                        <span class="input-group-btn">
                                            <button class="btn default" type="button" style="margin-top: 2px;">
                                                <i class="fa fa-calendar"></i>
                                            </button>
                                        </span>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">


                                <div class="col-md-2 control-label">
                                    Make<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm" id="txtMake" value="" readonly />
                                </div>
                                <div class="col-md-2 control-label">
                                    Model<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm" id="txtModel" value="" readonly />
                                </div>
                                <div class="col-md-2 control-label">
                                    Serial No<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm" id="txtSerialNo" value="" readonly />
                                </div>
                            </div>


                            <div class="form-group">
                                <div class="col-md-2 control-label">
                                    Description<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-10">
                                    <input type="text" class="form-control input-sm" id="txtDescription" value="" readonly />
                                </div>
                            </div>
                            <div class="headerbox row" style="margin-bottom: 10px;">
                                <div class="row" style="background-color: #999;color: #fff;padding: 5px 8px;font-weight: bold;">
                                    Lease Payment Information
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-offset-1 col-md-3">
                                    <label class="mt-checkbox input-sm" style="margin-bottom: 0px;">
                                        <input type="checkbox" class="i-check" checked="checked" id="chkChargeTaxUpFront" />Charge Tax Upfront
                                        <span style="margin-top: 4px;"></span>
                                    </label>
                                </div>
                                <div class="col-md-4">
                                    <label class="mt-checkbox input-sm" style="margin-bottom: 0px;">
                                        <input type="checkbox" class="i-check" checked="checked" id="IncludeFirstPaymentInDownPayment" />Include First Payment in Down Payment
                                        <span style="margin-top: 4px;"></span>
                                    </label>
                                </div>
                                <div class="col-md-2 control-label">
                                    # of Down Payment<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm text-right" id="txtInstallmentDownPaymentNum" value="" disabled />
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-2 control-label">
                                    Lease Amount<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm text-right" id="txtLeaseAmount" value="" readonly />
                                </div>

                                <div class="col-md-2 control-label">
                                    Monthly Payment Amount<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm text-right" id="txtMonthlyPaymentAmount" value="" readonly />
                                </div>
                                <div class="col-md-2 control-label">
                                    # of Monthly Payments<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm text-right" id="txtInstallmentMonthlyPaymentNum" value="13" readonly />
                                </div>

                            </div>

                            <div class="form-group">
                                <div class="col-md-2 control-label">
                                    Total Tax<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm text-right" id="txtLeaseTotalTax" value="" readonly />
                                </div>
                                <div class="col-md-2 control-label">
                                    Tax Rate<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm text-right" id="txtMonthlyTaxRate" value="0%" readonly />
                                </div>
                                <div class="col-md-2 control-label">
                                    # of Last Payment<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm text-right" id="txtInstallmentLastPaymentNum" value="0" disabled />
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-2 control-label">
                                    Total Lease<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm text-right" id="txtLeaseTotal" value="" readonly />
                                </div>

                                <div class="col-md-2 control-label">
                                    Monthly payment<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm text-right" id="txtMonthlyPaymentTotal" value="" readonly />
                                </div>


                                <div class="col-md-2 control-label">
                                    Total # of payment<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm text-right" id="txtInstallmentTotalPaymentNum" value="" disabled />
                                </div>
                            </div>
                        </div>
                        <input type="hidden" id="hdnFranchiseeID" name="hdnFranchiseeID" />
                        @*<div class="headerbox row" style="margin-bottom: 10px;">
                                <div class="col-md-12 row" style="padding: 5px 8px;font-weight: bold;">
                                    <div class="col-md-8"></div>

                                    @if (ViewBag.StatusList != null)
                                    {
                                        <div class="col-md-2 control-label">
                                            Lease Status<span style="color:#000000;">&nbsp;:</span>
                                        </div>
                                            <div class="col-md-2">
                                                <select id="ddlStatusModel" multiple="multiple" style="display:none;">
                                                    @foreach (var item in (MultiSelectList)ViewBag.StatusList)
                                                    {
                                                        <option @(item.Selected ? "selected" : "") value="@item.Value">@item.Text</option>
                                                    }
                                                </select>
                                            </div>
                                    }
                                </div>
                            </div>*@
                        <div class="form-group">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="table-responsive" style="min-height:155px;">
                                        <table class="table table-striped table-bordered table-hover order-column" id="tbllistdetail">
                                            <thead>
                                                <tr>
                                                    <th style="width:100px;text-align:center;">
                                                        Lease No.
                                                    </th>
                                                    <th style="width:100px;text-align:center;">
                                                        Total
                                                    </th>
                                                    <th style="width:80px;text-align:center;">
                                                        Payment Total
                                                    </th>
                                                    <th style="text-align:center;width:80px;">
                                                        Payments
                                                    </th>
                                                    <th style="text-align:center;width:80px;">
                                                        Balance
                                                    </th>
                                                    <th style="text-align:center;width:50px;">
                                                        Status
                                                    </th>
                                                    <th style="text-align:center;width:20px;">
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td class="text-center">70-2129</td>
                                                    <td class="text-center">0.00</td>
                                                    <td class="text-center">98.20</td>
                                                    <td class="text-center">18 of 28</td>
                                                    <td class="text-center">$1,767.60</td>
                                                    <td class="text-center"><i class="fa fa-check" style="color: green;font-size: 15px;"></i></td>
                                                    <td class="text-center"><i class="fa fa-edit" style="color: cornflowerblue;font-size: 15px;"></i></td>
                                                    <td class="text-center"><i class="fa fa-trash" style="color: red;font-size: 15px;"></i></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </section>
                </div>
                <!-- /.modal-content -->
            </div>
        </div>
    </div>
</form>
<div class="modal fade in" id="modal_RegionModel" tabindex="-1" role="basic" aria-hidden="true" style="display: none; padding-right: 17px;">
    <div class="modal-dialog modal-lg">
        <div class="modal-content" style="border-radius: 8px;width: 60%;margin-left: 140px;">
            <div class="modal-header headerbox list" style="padding:0px!important;border-bottom: none;">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="margin-top: 12px !important;margin-right: 12px !important;"></button>
                <h4 class="modal-title text-center" style="margin-top: 0px; margin-bottom: 4px;  padding: 7px!important;font-size: 12px;font-weight: bold;background: #3598DC !important;color: #FFF !important;border: 1px solid #3598DC !important;padding: 0px;text-transform: uppercase;">
                    Select Region
                </h4>
            </div>
            <div class="modal-body form form-horizontal" style="padding-top: 1px;margin-top: -5px;">
                <div class="form-body">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label class="control-label col-md-12" style="text-align: center;padding: 5px;background-color: #e8e8e8;margin-bottom:5px;font-weight:bold;">Select Region</label>
                                @if (ViewBag.regionlist != null)
                                {
                                    <select class="form-control input-sm" id="selectregionlist">
                                        <option value="">Select Region</option>
                                        @foreach (var item in (SelectList)ViewBag.regionlist)
                                        {
                                            <option @(item.Selected ? "selected" : "") value="@item.Value">@item.Text</option>
                                        }
                                    </select>
                                }
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-actions">
                    <div class="col-md-12">
                        <button type="button" name="SaveNew" id="btnRegion" class="btn btn-primary button-next pull-right" onclick="" style="margin-right:0px;">Select Region</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<form class="form-horizontal" action="" id="form_LeaseTransferDetail" method="POST">
    <div class="modal fade custom-model custom-form-design" id="modal_LeaseTransferDetail" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-lg">
            <div class="modal-content" style="border-radius: 8px;">
                <div class="modal-header headerbox list" style="padding:0px!important;border-bottom: none;">
                    <div class="row">
                        <div class="col-lg-11 modal-title" style="margin-top: 0px; margin-bottom: 4px; height:40px;  padding: 7px!important;font-size: 12px;font-weight: bold;background: #3598DC !important;color: #FFF !important;border: 1px solid #3598DC !important;padding: 0px;border-radius: 8px 0px 0 0;text-transform: uppercase;">
                            Transfer Lease
                        </div>
                        <div class="col-lg-1" style="margin-top: 0px; margin-bottom: 4px; height:40px; padding: 7px!important;background: #3598DC !important;color: #FFF !important;border: 1px solid #3598DC !important;padding: 0px;border-radius: 0px 8px 0 0;text-transform: uppercase;">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="margin-top: 12px !important;margin-right: 12px !important;"></button>
                        </div>
                    </div>
                </div>
                <div class="modal-body" style="padding: 0px 30px 15px 30px;">
                    <section>
                        <div style="max-width: 100%;margin: 0px auto;padding-left: 0px;padding-right: 0px;border-radius: 8px;">
                            <input type="hidden" id="hdnLTFranchiseeID" name="hdnLTFranchiseeID" />
                            <div class="form-group">
                                <div class="col-md-12">
                                    <b>Transfer Select Leases From:</b>
                                </div>
                                <div class="col-md-2 control-label">
                                    <b>Franchisee No.</b>
                                </div>
                                <div class="col-md-2">
                                    <input type="hidden" name="hdfLTFromFranchiseeId" id="hdfLTFromFranchiseeId" value="" />
                                    <input type="text" class="form-control input-sm" name="txtLF_FromFranchiseeNo" id="txtLF_FromFranchiseeNo" value="" />
                                </div>
                                <div class="col-md-2 control-label">
                                    <b>Franchisee Name</b>
                                </div>
                                <div class="col-md-6">
                                    <input type="text" class="form-control input-sm" name="txtLF_FromFranchiseeName" id="txtLF_FromFranchiseeName" value="" />
                                </div>
                            </div>


                            <div class="form-group">
                                <div class="col-md-12">
                                    <b>Transfer Select Leases To:</b>
                                </div>
                                <div class="col-md-2 control-label">
                                    <b>Franchisee No.</b>
                                </div>
                                <div class="col-md-2">
                                    <input type="hidden" name="hdfLTToFranchiseeId" id="hdfLTToFranchiseeId" value="" />
                                    <input type="text" class="form-control input-sm" name="txtLF_ToFranchiseeNo" id="txtLF_ToFranchiseeNo" value="" />
                                </div>
                                <div class="col-md-2 control-label">
                                    <b>Franchisee Name</b>
                                </div>
                                <div class="col-md-6">
                                    <input type="text" class="form-control input-sm" name="txtLF_ToFranchiseeName" id="txtLF_ToFranchiseeName" value="" />
                                </div>
                            </div>
                            <br />

                        </div>


                        <div class="form-group">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="table-responsive">
                                        <table class="table table-striped table-bordered table-hover order-column" id="tblleaseTransferList">
                                            <thead>
                                                <tr>
                                                    <th style="padding:3px;text-align:center;width:30px;text-align:center;"><input type="checkbox" id="chkSelectAll" name="chkSelectAll" /></th>
                                                    <th style="padding:3px;text-align:center;width:65px;text-align:center;">Lease No.</th>
                                                    <th style="padding:3px;text-align:center;width:100px;text-align:center;">Signed Date</th>
                                                    <th style="padding:3px;text-align:center;">Description</th>
                                                    <th style="padding:3px;text-align:center;width:80px;">Stop</th>
                                                    <th style="padding:3px;text-align:center;width:80px;">Pay #</th>
                                                    <th style="padding:3px;text-align:center;width:80px;">Pay Total#</th>
                                                    <th style="padding:3px;text-align:center;width:80px;">Payment Amount</th>
                                                    <th style="padding:3px;text-align:center;width:80px;">Balance</th>
                                                </tr>
                                            </thead>
                                            <tbody></tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row">
                                <div class="col-md-12">
                                    <input type="button" name="btnLT_submit" id="btnLT_submit" class="btn-custom btn btn-primary pull-right" value="Submit" />
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
                <!-- /.modal-content -->
            </div>
        </div>
    </div>
</form>

<div class="modal fade custom-model custom-form-design" id="modelFranchiseEditLeasePopup" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
    <div class="modal-dialog modal-lg" id="renderFranchiseEditLeasePopup">                
    </div>
</div>

@section pageplugins{
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/jquery-ui/jquery-ui.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/jquery-validation/js/jquery.validate.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/jquery-inputmask/jquery.inputmask.bundle.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/scripts/datatable.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/datatables/datatables.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/scripts/app.min.js")" type="text/javascript" )"></script>
    <script src="@Url.Content("~/Content/admin/assets/pages/scripts/table-datatables-managed.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/moment.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/bootstrap-typeahead/bootstrap3-typeahead.min.js")" type="text/javascript"></script>
}
@section scripts{
    <script>
        var dtable;
        function getLeaseListLink() {
            //var _isactive = false;
            //if ($("#chkActive").prop("checked") == true && $("#chkInActive").prop("checked") == true) {
            //    _isactive = null;
            //}
            //else if ($("#chkActive").prop("checked") == true && $("#chkInActive").prop("checked") == false) {
            //    _isactive = true;
            //}
            //else if ($("#chkInActive").prop("checked") == true && $("#chkActive").prop("checked") == false) {
            //    _isactive = false;
            //}
            //else {
            //    _isactive = null;
            //}
            var r = $('#regionlist').val();
            var _searchtext = '';
            return '@Url.Action("LeaseListDataWithSearch", "Franchise", new { area = "Portal" })?statusIds=' + ($("#ddlStatus").val() != null ? $("#ddlStatus").val() : '') + '&RegionIds=' + (r == null ? '' : r) + '&searchtext=' + _searchtext

            @*return '@Url.Action("FinderFeeListDataResult", "Franchise", new { area = "Portal" })?regionIds=' + $("#regionlist").val() + '&statusIds=' + ($("#ddlStatus").val()!=null?$("#ddlStatus").val():'');*@
        }


        $(window).load(function () {
            @*if ('@ViewBag.selectedRegionId' == 0) {
                $("#modal_RegionModel").modal({ backdrop: 'static' });
            }*@
            if ('@ViewBag.selectedRegionId' == 0) {
                $("#modal_RegionModel").modal({ backdrop: 'static' });
            } else {
                initTable();
            }

        });

        @*$(document).on('init.dt', function (e, settings) {
            //var api = new $.fn.dataTable.Api(settings);
            //if ($(api.table().node()).attr('id') == 'tbllist') {
            //    setPaging();
            //}
            if ('@ViewBag.selectedRegionId' == 0) {
                $("#modal_RegionModel").modal({ backdrop: 'static' });
            } else {
                //reloadTable();
                initTable();
            }
        });*@
        jQuery(document).ready(function () {
            $("#btnRegion").click(function () {
                if ($("#selectregionlist").val() != "") {
                    $("#regionlist option[value='" + $("#selectregionlist").val() + "']").attr("selected", 1);
                    $("#regionlist").multiselect("refresh");
                    initTable();
                    $(".close").click();
                }
            });

            $("#btnRegion").click(function () {
                if ($("#selectregionlist").val() != "") {
                    $("#ddlStatus option[value='" + $("#selectregionlist").val() + "']").attr("selected", 1);
                    $("#ddlStatus").multiselect("refresh");
                    //reloadTable();
                    initTable();
                    $(".close").click();
                }
            });

            $("#ddlStatus").multiselect({
                includeSelectAllOption: true,
                selectAllText: 'Select all',
                buttonWidth: '100%',
                nonSelectedText: 'Select Status..',
                dropRight: true,
                numberDisplayed: 2,
                autoclose: true

            });

            $("#ddlStatusModel").multiselect({
                includeSelectAllOption: true,
                selectAllText: 'Select all',
                buttonWidth: '100%',
                nonSelectedText: 'Select Status..',
                dropRight: true,
                numberDisplayed: 2,
                autoclose: true

            });

            $("#ddlStatusList").change(function () {
     var fid =  $("#hdnFranchiseeID").val();
    var _isactive = null;
     var sURL = '@Url.Action("FLeaseListData", "Franchise", new { area = "Portal" })?franchiseeid=' + fid + '&IsActive=' + _isactive + '&StatusListId=' + $(this).val()
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    var isFirst = true;
                    $('#tbllistdetail > tbody').html('');
                    $.each(data.FLeaseList, function (index, value) {
                        tempRowLineNo = value.LineNumber;
                        tempRowDistribution = "";
                        if (isFirst) {
                            bindFranchiseeLeaseDetail(value.LeaseId);
                            isFirst = false;
                        }

                        tempRowDistribution += '<tr>';
                        tempRowDistribution += '<td class="text-center"><a onclick="bindFranchiseeLeaseDetail(' + value.LeaseId + ')">' + value.LeaseNumber + '</a></td>';
                        tempRowDistribution += '<td class="text-center">$ ' + parseFloat(value.MonthlyPaymentTotal, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';
                        tempRowDistribution += '<td class="text-center">$ ' + parseFloat(value.LeaseTotal, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';
                        tempRowDistribution += '<td class="text-center">' + value.NumOfPaymentsPaid + ' of ' + value.InstallmentMonthlyPaymentNum + '</td>';
                        //tempRowDistribution += '<td class="text-center">$ ' + parseFloat((value.LeaseTotal - value.TotalAmountPaid), 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';
                        tempRowDistribution += '<td class="text-center">$ ' + parseFloat(value.Balance, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';
                        tempRowDistribution += '<td class="text-center">' + value.StatusListName + '</td>';
                        tempRowDistribution += '<td class="text-center"><i class="fa fa-edit" style="color: cornflowerblue;font-size: 15px;"></i></td>';
                        tempRowDistribution += '</tr>';




                        $('#tbllistdetail>tbody').append(tempRowDistribution);
                    });
                },
                error: function () {
                    alert("Content load failed.");
                }
            });
            });

            $("#ddlStatus").change(function () {
                //reloadTable();
                initTable();
            });

            $('.modal-dialog').draggable();
            $('#tbllist').hide();
            $("#chkActive").prop("checked", true);
            $("#chkActivePopUp").prop("checked", true);
            // initTable();
            //$(".chkActivecls").change(function () {
            //    refreshTable();
            //});
            //$(".chkActiveclsPopUp").change(function () {
            //    bindFranchiseeLeaseList($("#hdnFranchiseeID").val());
            //});
            $("#regionlist").multiselect({
                includeSelectAllOption: true,
                selectAllText: 'Select all',
                buttonWidth: '100%',
                nonSelectedText: 'Select region..',
                dropRight: true,
                numberDisplayed: 2,
                onChange: initTable,
                onSelectAll: initTable,
                onDeselectAll: initTable
            });


        });

        $("#pageSize").change(function () {
            setPaging();
        });

        function setPaging() {
            var z = $("#pageSize").val();
            var table = $("#tbllist").DataTable();
            if (z > 0) {
                table.page.len(z).draw();
            }
            else if (z == -1) {
                table.page.len(table.rows().count()).draw();
            }
            else {
                table.page.page.len(25).draw();
            }
        }

        function initTable() {
            var ps = $('#pageSize').val();
            dtable = $('#tbllist').DataTable({
                "bAutoWidth": false,
                cache: false,
                "iDisplayLength": ps == '-1' ? 25 : ps,
                "bDestroy": true,
                "aLengthMenu": [[5, 7, 10, 25, 50, -1], [5, 7, 10, 25, 50, "All"]],
                //"dom": "<'headerbox list'<'row'<'col-md-1'l><'col-md-4'f><'#divrightckbox.col-md-5 pull-right text-center'>>><'table-responsive't><'bottom'ip><'clear'>",
                "dom": "<'table-responsive't><'bottom'ip><'clear'>",
                "aaSorting": [[0, "desc"]],
                "bServerSide": false,
                "sAjaxSource": getLeaseListLink(),
                "sAjaxDataProp": "LeaseData",  // Internationalisation. For more info refer to http://datatables.net/manual/i18n
                "rowCallback": function (nRow, data) { },
                "aoColumns": [
                    {
                        "sName": "Region",
                        "bSortable": true,
                        "sClass": "alignCenter",
                        "mRender": function (data, type, full) {
                            return full.RegionName;
                        }
                    },
                    {
                        "sName": "FranchiseeNo",
                        "bSortable": true,
                        "sClass": "alignCenter",
                        "mRender": function (data, type, full) {
                            return full.FranchiseeNo;
                        }
                    },
                    {
                        "sName": "FranchiseeName",
                        "bSortable": true,
                        "mRender": function (data, type, full) {                            
                            var leaseDetail = "<a onclick='LeaseDetail(" + full.FranchiseeId + "," + full.StatusListId + ")'>" + full.FranchiseeName + "</a>"
                            return leaseDetail;
                        }
                    },
                    {
                        "sName": "LeaseCount",
                        "bSortable": true,
                        "sClass": "alignCenter",
                        "mRender": function (data, type, full) {
                            return full.LeaseCount;
                        }
                    },
                    {
                        "sName": "TotalMonthlyPaymentAmount",
                        "bSortable": true,
                        "sClass": "alignRight",
                        "mRender": function (data, type, full) {
                            return '$ ' + parseFloat(full.TotalMonthlyPaymentAmount, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString();
                        }
                    },
                    {
                        "sName": "TotalPaidAmount",
                        "bSortable": true,
                        "sClass": "alignRight",
                        "mRender": function (data, type, full) {
                            return '$ ' + parseFloat(full.TotalPaidAmount, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString();
                        }
                    },
                    {
                        "sName": "TotalBalance",
                        "bSortable": true,
                        "sClass": "alignRight",
                        "mRender": function (data, type, full) {
                            return '$ ' + parseFloat(full.TotalBalance, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString();
                        }
                    },
                    {
                        "sName": "Status",
                        "bSortable": true,
                        "sClass": "alignCenter",
                        "mRender": function (data, type, full) {
                            return full.Status;
                        }
                    },
                ],
                //    "footerCallback": function (row, data, start, end, display) {
                //        var api = this.api(), data;

                //        // Remove the formatting to get integer data for summation
                //        var intVal = function (i) {
                //            return typeof i === 'string' ?
                //                i.replace(/[\$,]/g, '') * 1 :
                //                typeof i === 'number' ?
                //                    i : 0;
                //        };

                //        // Total over all pages
                //        var total = api
                //            .column(7)
                //            .data()
                //            .reduce(function (a, b) {
                //                return intVal(a) + intVal(b);
                //            }, 0);

                //        // Total over this page
                //        pageTotal = api
                //            .column(7, { page: 'current' })
                //            .data()
                //            .reduce(function (a, b) {
                //                return intVal(a) + intVal(b);
                //            }, 0);

                //        // Update footer
                //        $(api.column(7).footer()).html(
                //            '$' + pageTotal
                //        );
                //    }
            });
            $("#input_Search").keyup(function () {
                var table = $("#tbllist").DataTable();
                table.search($(this).val()).draw();
            });

            $(".search-field").change(function () {
                refreshTable();
            });

            $('#tbllist').show();
        }

        function bindFranchiseeLeaseList(fid) {            
            $("#hdnFranchiseeID").val(fid);
            var _isactive = false;
            if ($("#chkActivePopUp").prop("checked") == true && $("#chkInActivePopUp").prop("checked") == true) {
                _isactive = null;
            }
            else if ($("#chkActivePopUp").prop("checked") == true && $("#chkInActivePopUp").prop("checked") == false) {
                _isactive = true;
            }
            else if ($("#chkInActivePopUp").prop("checked") == true && $("#chkActivePopUp").prop("checked") == false) {
                _isactive = false;
            }
            else {
                _isactive = null;
            }
            var sURL = '@Url.Action("FLeaseListData", "Franchise", new { area = "Portal" })?franchiseeid=' + fid + '&IsActive=' + _isactive+ '&StatusListId=' + $("#ddlStatusList").val()
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    var isFirst = true;
                    $('#tbllistdetail > tbody').html('');
                    $.each(data.FLeaseList, function (index, value) {
                        tempRowLineNo = value.LineNumber;
                        tempRowDistribution = "";
                        if (isFirst) {
                            bindFranchiseeLeaseDetail(value.LeaseId);
                            isFirst = false;
                        }

                        tempRowDistribution += '<tr>';
                        tempRowDistribution += '<td class="text-center"><a onclick="bindFranchiseeLeaseDetail(' + value.LeaseId + ')">' + value.LeaseNumber + '</a></td>';
                        tempRowDistribution += '<td class="text-center">$ ' + parseFloat(value.MonthlyPaymentTotal, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';
                        tempRowDistribution += '<td class="text-center">$ ' + parseFloat(value.LeaseTotal, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';
                        tempRowDistribution += '<td class="text-center">' + value.NumOfPaymentsPaid + ' of ' + value.InstallmentMonthlyPaymentNum + '</td>';
                        //tempRowDistribution += '<td class="text-center">$ ' + parseFloat((value.LeaseTotal - value.TotalAmountPaid), 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';
                        tempRowDistribution += '<td class="text-center">$ ' + parseFloat(value.Balance, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';
                        tempRowDistribution += '<td class="text-center">' + value.StatusListName + '</td>';
                        tempRowDistribution += '<td class="text-center"><div class="btn-group dropdown"><a target="_blank" dropdown-toggle data-toggle="dropdown" > <i class="fa fa-hand-o-right" aria-hidden="true"></i></a > <ul class="dropdown-menu pull-right">';
                        tempRowDistribution += '<li><a href="#" onclick="bindLeaseTransferDetail(' + fid + ')"><i class="fa fa-plus"></i> Transfer </a></li>';
                        
                        if (value.DownPaymentPaid == false) {
                            tempRowDistribution += '<li><a href="#" onclick="FranchiseEditLeasePopup(' + value.LeaseId + ',' + fid + ')"><i class="fa fa-plus"></i> Edit </a></li>';
                        }
                        tempRowDistribution += '</ul></div></td>';
                        tempRowDistribution += '</tr>';

                        $('#tbllistdetail>tbody').append(tempRowDistribution);
                    });
                    $("#modal_LeaseDetail").modal("show");
                },
                error: function () {
                    alert("Content load failed.");
                }
            });
        }


        function bindFranchiseeLeaseDetail(leaseid) {
            var sURL = '@Url.Action("FranchiseeLeaseDetailData", "Franchise", new { area = "Portal" })?leaseId=' + leaseid
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {


                    //var items = [];
                    ////items.push("<option>Select</option>");

                    //items.push("<option value=" + data.LeaseDetail.StatusListId + ">" + data.LeaseDetail.StatusListName + "</option>");

                    //$('#ddlStatusList').html(items.join(' '));
                    $('#ddlStatusList').val(data.LeaseDetail.StatusListId);

                    $('#spnFranchiseeNumber').html(data.LeaseDetail.FranchiseeNo);
                    $('#spnFranchiseeAddress').html(data.LeaseDetail.Address);
                    $('#spnFranchiseeName').html(data.LeaseDetail.Name);
                    $('#spnCityStatePincode').html(data.LeaseDetail.City + ',' + data.LeaseDetail.StateName + ' ' + data.LeaseDetail.PostalCode);
                    $('#spnLeaseStatus').val(data.LeaseDetail.LeaseStatus);
                    $('#txtSignDate').val(moment(new Date(parseInt(data.LeaseDetail.SignDate.substr(6)))).format("MM/DD/YYYY"));
                    if (data.LeaseDetail.StartDate != 'null' && data.LeaseDetail.StartDate != null)
                        $('#txtStartDate').val(moment(new Date(parseInt(data.LeaseDetail.StartDate.substr(6)))).format("MM/DD/YYYY"));
                    else
                        $('#txtStartDate').val('');
                    $('#txtLeaseNumber').val(data.LeaseDetail.LeaseNumber);
                    $('#txtMake').val(data.LeaseDetail.Make);
                    $('#txtModel').val(data.LeaseDetail.Model);
                    $('#txtSerialNo').val(data.LeaseDetail.SerialNo);
                    $('#txtDescription').val(data.LeaseDetail.LeaseDescription);
                    $('#chkChargeTaxUpFront').prop("checked", data.LeaseDetail.ChargeTaxUpFront);
                    console.log(data.LeaseDetail.IncludeFirstPaymentInDownPayment);
                    $('#IncludeFirstPaymentInDownPayment').prop("checked", data.LeaseDetail.IncludeFirstPaymentInDownPayment);
                    $('#txtLeaseAmount').val('$ ' + parseFloat(data.LeaseDetail.LeaseAmount, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString());
                    $('#txtLeaseTotalTax').val('$ ' + parseFloat(data.LeaseDetail.LeaseTotalTax, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString());
                    $('#txtLeaseTotal').val('$ ' + parseFloat(data.LeaseDetail.LeaseTotal, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString());
                    $('#txtMonthlyPaymentAmount').val('$ ' + parseFloat(data.LeaseDetail.MonthlyPaymentAmount, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString());
                    $('#txtMonthlyTaxRate').val(data.LeaseDetail.MonthlyTaxRate);
                    $('#txtMonthlyPaymentTotal').val('$ ' + parseFloat(data.LeaseDetail.MonthlyPaymentTotal, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString());
                    $('#txtInstallmentDownPaymentNum').val(data.LeaseDetail.InstallmentDownPaymentNum);
                    $('#txtInstallmentMonthlyPaymentNum').val(data.LeaseDetail.InstallmentMonthlyPaymentNum);
                    $('#txtInstallmentLastPaymentNum').val(data.LeaseDetail.InstallmentLastPaymentNum);
                    $('#txtInstallmentTotalPaymentNum').val(data.LeaseDetail.InstallmentTotalPaymentNum);



                },
                error: function () {
                    alert("Content load failed.");
                }
            });
        }

        function refreshTable() {
            var url = getLeaseListLink();
            $.blockUI();

            $('#CustomerPaymentList').DataTable().ajax.url(url).load(function () { $.unblockUI(); });
        }

        function BindLeaseBillDataSearch(_isactive, _searchtext) {

            var sURL = '@Url.Action("LeaseListDataWithSearch", "Franchise", new { area = "Portal" })?isactive=' + _isactive + '&searchtext=' + _searchtext
            $.ajax(
            {
                type: "GET", //HTTP GET Method
                url: sURL,
                success: function (res) {
                    if (res.legnth > 0) {

                    }
                },
                error: function (err) {
                    alert('failure');
                },
            });

        }


        function LeaseDetail(id, StatusListId) {            
            $("#ddlStatusList").val(StatusListId) ;            
            bindFranchiseeLeaseList(id);
        }

        $('#chkSelectAll').change(function () {
            if ($(this).is(":checked")) {
                $('input[rel="mgglchk"]').prop('checked', true);
            }
            else {
                $('input[rel="mgglchk"]').prop('checked', false);
            }
        });

        $('#btnLT_submit').click(function () {
            if ($("#hdfLTFromFranchiseeId").val() != '' && $("#hdfLTToFranchiseeId").val() != '') {

                var Ids = "";
                $('input[rel="mgglchk"]').each(function (item) {
                    if ($(this).is(":checked")) {
                        var mId = $(this).attr('value');
                        if (Ids != "")
                            Ids = Ids + "," + mId;
                        else
                            Ids = mId;
                    }
                });
                if (Ids != "") {
                    swal({
                        title: "Lease Transfer",
                        text: "Are you sure to transfer lease.",
                        type: "warning",
                        showCancelButton: true,
                        //confirmButtonColor: '#DD6B55',
                        confirmButtonText: 'Yes',
                        cancelButtonText: "No",
                        closeOnConfirm: false,
                        closeOnCancel: false
                    },
                   function (isConfirm) {
                       if (isConfirm) {
                           //var Ids = "";
                           //$('input[rel="mgglchk"]').each(function (item) {
                           //    if ($(this).is(":checked")) {
                           //        var mId = $(this).attr('value');
                           //        if (Ids != "")
                           //            Ids = Ids + "," + mId;
                           //        else
                           //            Ids = mId;
                           //    }
                           //});
                           if (Ids != "") {
                               var sURL = '@Url.Action("FranchiseeLeaseListDataForTransferSubmit", "Franchise", new { area = "Portal" })?ids=' + Ids + '&fid=' + $("#hdfLTFromFranchiseeId").val() + '&tofid=' + $("#hdfLTToFranchiseeId").val();
                               $.ajax(
                               {
                                   type: "GET", //HTTP POST Method
                                   url: sURL, // Controller/View
                                   success: function (res) {
                                       console.log(res);
                                       swal(
                                           'Lease Transferd.',
                                           '',
                                           'success'
                                       )
                                       $("#modal_LeaseTransferDetail").modal('hide');
                                       initTable();
                                       $("#modal_LeaseDetail").modal("hide");
                                   },
                                   error: function (err) {
                                       alert('failure');
                                   },
                               });
                           }
                       }
                       else {
                           swal('Cancelled.', '', 'error');
                           $("#modal_LeaseTransferDetail").modal('hide');
                       }
                   });
                }
                else {
                    swal('Please select at least one leases.', '', '');
                }
            }
            else {
                swal('Please select franchisee for transfer leases to.', '', '');
            }
        });

        function bindLeaseTransferDetail(fid) {

            $("#hdfLTFromFranchiseeId").val(fid);
            $("#txtLF_FromFranchiseeNo").val($("#spnFranchiseeNumber").html());
            $("#txtLF_FromFranchiseeName").val($("#spnFranchiseeName").html());

            $("#txtLF_FromFranchiseeNo").prop('disabled', true)
            $("#txtLF_FromFranchiseeName").prop('disabled', true)


            $.ajax({
                type: "GET",
                url: '@Url.Action("FranchiseeLeaseListDataForTransfer", "Franchise", new { area = "Portal" })?franchiseeid=' + fid,
                data: {},
                success: function (data) {
                    console.log(data);

                    $('#tblleaseTransferList > tbody').html('');
                    $.each(data.FLeaseList, function (index, value) {
                        tempRowDistribution = "";
                        tempRowDistribution += '<tr>';
                        tempRowDistribution += '<td style="padding:3px;text-align:center;" ><input rel="mgglchk" type="checkbox" value="' + value.LeaseId + '"/></td>';
                        tempRowDistribution += '<td style="padding:3px;text-align:center;" ><a onclick="bindFranchiseeLeaseDetail(' + value.LeaseId + ')">' + value.LeaseNumber + '</a></td>';
                        tempRowDistribution += '<td style="padding:3px;text-align:center;" >' + moment(new Date(parseInt(value.SignDate.substr(6)))).format("MM/DD/YYYY")  + '</td>';
                        tempRowDistribution += '<td style="padding:3px;text-align:center;" >' + value.LeaseDescription + '</td>';
                        tempRowDistribution += '<td style="padding:3px;text-align:center;" ></td>';
                        tempRowDistribution += '<td style="padding:3px;text-align:center;" >' + value.NumOfPaymentsPaid + ' of ' + value.InstallmentMonthlyPaymentNum + '</td>';
                        //tempRowDistribution += '<td style="padding:3px;text-align: right;" >$ ' + parseFloat((value.LeaseTotal - value.TotalAmountPaid), 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';                        
                        tempRowDistribution += '<td style="padding:3px;text-align: right;" >$ ' + parseFloat(value.Balance, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';
                        tempRowDistribution += '<td style="padding:3px;text-align: right;" >$ ' + parseFloat(value.MonthlyPaymentTotal, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';
                        tempRowDistribution += '<td style="padding:3px;text-align: right;" >$ ' + parseFloat(value.LeaseTotal, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';
                        tempRowDistribution += '</tr>';
                        $('#tblleaseTransferList>tbody').append(tempRowDistribution);
                    });


                    $.ajax({
                        type: "GET",
                        url: '@Url.Action("GetAllFranchisees", "Franchise", new { area = "Portal" })',
                        data: {},
                        success: function (data) {
                            var typeaheadSource = [];
                            $.each(data, function (key, value) {
                                typeaheadSource.push({ id: value.FranchiseeId, name: value.FranchiseeNo + ' ' + value.Name })
                            });

                            $('#txtLF_ToFranchiseeNo').typeahead({
                                source: typeaheadSource,
                                updater: function (item) {
                                   
                                    $('#hdfLTToFranchiseeId').val(item.id);
                                    var _number = item.name.toString().split(' ')[0];
                                    $('#txtLF_ToFranchiseeNo').val(_number);
                                    $('#txtLF_ToFranchiseeName').val(item.name.toString().replace(_number, '').trim());

                                    item.name = _number;
                                    return item;
                                }
                            }).focus();
                        }
                    });



                    $("#modal_LeaseTransferDetail").modal({ backdrop: 'static' });
                    }
                });

            
        }
        function FranchiseEditLeasePopup(lId,fid)
        {
             
            $.blockUI();
            var sURL = '@Url.Action("FranchiseEditLeasePopup", "Franchise", new { area = "Portal" })?lId=' + lId + '&fid=' + fid;
            
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    $('#renderFranchiseEditLeasePopup').html(data);
                    $.unblockUI();
                    $("#modelFranchiseEditLeasePopup").modal({ backdrop: 'static' });                    
                    $(".date-picker").datepicker();
                    $("#SignDate").datepicker();
                    $("#StartDate").datepicker();

                },
                error: function () {
                    $.unblockUI();
                    alert("Content load failed.");
                }
            });
             
        }
        var handleCurrencyInputMask = function (parentSelector) {
            $(parentSelector).inputmask("numeric", {
                decimal: ".",
                negative: false,
                scale: 2,
                groupSeparator: ",",
                digits: 2,
                autoGroup: true,
                prefix: "$",
                rightAlign: true,
                autoUnmask: true,
                removeMaskOnSubmit: true,
            });
        }

    </script>
}


