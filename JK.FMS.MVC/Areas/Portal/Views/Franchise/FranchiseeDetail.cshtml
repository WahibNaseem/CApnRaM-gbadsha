@model JKViewModels.Franchisee.FranchiseeDetailViewModel
@{
    ViewBag.Title = "Franchisee Detail";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@section styles{
    <link href="@Url.Content("~/Content/admin/assets/global/plugins/bootstrap-multiselect/css/bootstrap-multiselect.css")" rel="stylesheet" />

    <link href="~/Content/admin/assets/global/plugins/jquery-ui/jquery-ui.min.css" rel="stylesheet" />

    <style type="text/css">
        tr > td {
            font-size: 11px !important;
            padding: 4px !important;
        }

        /*tr > th {
            font-size: 11px !important;
        }*/

        .custom-form .btn {
            margin-bottom: 5px;
        }

        .pnd5 {
            padding: 5px;
        }

        .control-label.text-left {
            text-align: left;
        }

        .editvaluetext {
            background-color: white;
            border-style: inherit;
        }

        .editmode {
            background-color: initial;
            border-style: hidden;
        }

        #ui-datepicker-div {
            z-index: 99999 !important;
        }

        .ui-autocomplete {
            z-index: 9999 !important;
        }

        .btn-custom {
            font-size: 11px;
            padding: 10px 0px;
        }

        .close {
            background-image: url(/Content/admin/assets/global/img/stick_close.png) !important;
            height: 12px !important;
            width: 12px !important;
            margin-top: 0px !important;
        }

        .btn.multiselect {
            text-align: left;
            padding-top: 4px;
            padding-bottom: 4px;
            font-size: 11px;
            color: #555;
        }

        .btn {
            padding: 3px 12px;
            font-size: 12px;
        }

        .multiselect .caret {
            right: 0;
            position: absolute;
            margin-top: 8px;
            margin-right: 8px;
        }

        .multiselect-container.dropdown-menu {
            text-transform: none;
            font-size: 14px;
            padding-right: 10px;
            padding-left: 40px;
        }

        .no-padding {
            padding: 0;
        }

        .row {
            margin: 0;
        }
    </style>
}
<input type="hidden" id="hdnFranchiseeId" value="@Model.FranchiseeId" />
<div class="headerbox">
    <div class="row" style="background-color: #4b85cc;color: #fff;padding-top:8px;padding-bottom:8px;margin-left: 0px;margin-right: 0px;">
        <div class="col-md-12">
            <div class="row">
                <div class="col-md-4">
                    <div class="input-icon">
                        <i class="icon-magnifier icon-align-right" style="margin-top: 8px;"></i>
                        <input id="input_Search" type="text" required name="customernumber" autocomplete="off" placeholder="Search Franchisee Name or Number" value="" class="form-control input-sm typeahead" />
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@if (ViewBag.callFrom != null)
{
    if (Convert.ToInt32(ViewBag.callFrom) == 1)
    {
        <div class="row" style="padding-top: 3px;">
            <input type="hidden" id="hdnRecordId" value="@ViewBag.RecordId " />
            <input type="hidden" id="hdncolidx" value="@ViewBag.colidx" />
            <input type="hidden" id="hdncolsort" value="@ViewBag.sort" />
            <input type="hidden" id="hdnFranchiseId" value="@ViewBag.FranchiseID" />
            <div class="col-md-12">
                <div class="col-md-1"><input type="button" class="btn green btn-custom btn btn-primary" onclick="ClickOnPrev()" value="PREV" @(Convert.ToBoolean(ViewBag.PrevBtn) == false ? "disabled=disabled" : string.Empty) style="margin-right:-13px;" /></div>
                <div class="col-md-1" style="margin-left:-6px;">
                    @*<input type="button" class="btn btn-custom btn btn-primary" href="javascript:void(0);" onclick="showServiceCallLogOpenPopup(@ViewBag.CustomerID)" value="Log Call" />*@
                </div>
                <div class="col-md-3"></div>
                <div class="col-md-4">
                    <div class="col-md-12 pull-right no-padding">
                    </div>
                </div>
                <div class="col-md-2" style="text-align:right;">
                    <a class="btn btn-primary" id="btnnewsearch" href="@Url.Action("FranchiseeSearch", "Franchise", new { area = "Portal" })"> New Search </a>
                    <a class="btn btn-custom btn btn-primary" href="@Url.Action("BacktoSearchResult", "Franchise", new { area = "Portal" })" style="margin-right:14px;">Back to List</a>
                </div>
                <div class="col-md-1" style="text-align:right;"><input type="button" class="btn  green btn-custom btn btn-primary" onclick="ClickOnNext()" @(Convert.ToBoolean(ViewBag.NextBtn) == false ? "disabled=disabled" : string.Empty) value="NEXT" /></div>
            </div>
        </div>
    }
}
<div class="custom-listbox custom-form" id="divfranchiseList">
    <div class="headerbox" style="font-weight: normal;">
        <div class="col-md-4">
            Franchisee Name :<b> @Html.DisplayFor(one => one.Name) </b>
            @*<a href="@Url.Action("MaintenanceStepOne", "Customer", new { area = "Portal", id=ViewBag.CustomerID })" style="color:red">Edit</a>*@
        </div>
        <div class="col-md-2 text-center">Franchisee #: <b>@Html.DisplayFor(one => one.FranchiseeNo) </b></div>
        <div class="col-md-2 text-center" style="margin-top: -4px;">
            @if (ViewBag.Prefixlist != null)
            {
                <div class="col-md-12 pull-right no-padding">
                    <div class="col-md-6 no-padding" style="padding-left: 6px;">
                        <select id="ddlperfix" class="form-control input-sm">
                            @foreach (var item in (MultiSelectList)ViewBag.Prefixlist)
                            {
                                var text = item.Text;
                                if (item.Text.Length == 1)
                                {
                                    text = "F00" + text;
                                }
                                else if (item.Text.Length == 2)
                                {
                                    text = "F0" + text;
                                }
                                <option @(item.Selected ? "selected" : "") value="@item.Value">@text</option>
                            }
                        </select>
                    </div>
                </div>
            }
        </div>
        <div class="col-md-4 pull-right text-right"> Total Distributions Amount:<label id="lblamount" style="font-weight: bold;"><b>@Html.DisplayFor(one => one.Amount) </b></label></div> <div class="clearfix"> </div>
    </div>
    <div class="portlet-body" style="padding:10px">
        <div class="row">
            <div class="col-md-12">
                <div class="col-md-6" style="padding-right:0px;padding-left:0px;" id="detailinfo">
                    @Html.Partial("~/Areas/Portal/Views/Franchise/_PartialFranchiseeDetailInfo.cshtml", Model)

                </div>
                <div class="col-md-6" style="padding-right:0px;padding-left:0px;">
                    <div class="table-responsive">
                        <table class="table-striped table-bordered order-column">
                            <tr>
                                <td class="col-md-3" style="padding-right: 6px;padding-left: 7px;padding-bottom: 16px;">
                                    <div class="form-group mr0" style="margin-top: 10px;">
                                        <input type="button" @(Model.FranchiseeId > 0 ? "" : "disabled") value="Edit Franchisee Info" class="btn-custom btn btn-primary col-md-12" style="font-size: 11px;" onclick="OpenEditFranchisePopup(@Html.DisplayFor(one => one.FranchiseeId))" />
                                    </div>
                                    <div class="form-group mr0">
                                        <input type="button" @(Model.FranchiseeId > 0 ? "" : "disabled") value="Plan Information" class="btn-custom btn btn-primary col-md-12" style="font-size: 11px;" onclick="OpenEditFranchisePlanInfoPopup(@Html.DisplayFor(one => one.FranchiseeId))" />
                                    </div>
                                    <div class="form-group mr0">
                                        <input type="button" @(Model.FranchiseeId > 0 ? "" : "disabled") value="Customers" class="btn-custom btn btn-primary col-md-12" style="font-size: 11px;" onclick="OpenFranchiseDistributionPopup(@Html.DisplayFor(one => one.FranchiseeId))" />
                                    </div>
                                    <div class="form-group mr0">
                                        <div class="btn-group dropdown" style="display:inherit;">
                                            <a target="_blank" dropdown-toggle'="" data-toggle="dropdown" @(Model.FranchiseeId > 0 ? "" : "disabled") class="btn-custom btn btn-primary col-md-12" style="font-size: 11px;">Account Offering</a>
                                            <ul class="dropdown-menu ">
                                                <li><a href="#" onclick="ShowCustomerSuggetionBox()"><i class="fa fa-plus"></i>New Offer</a></li>
                                                <li><a href="#" onclick="ShowOfferedList(@Html.DisplayFor(one => one.FranchiseeId))"><i class="fa fa-plus"></i>Offered List</a></li>
                                            </ul>
                                        </div>
                                        @*<input type="button" @(Model.FranchiseeId > 0 ? "" : "disabled") value="Account Offering" class="btn-custom btn btn-primary col-md-12" style="font-size: 11px;" onclick="ShowCustomerSuggetionBox()" />*@
                                    </div>
                                </td>
                                <td class="col-md-3" style="padding-left: 3px;padding-right: 4.2px;padding-bottom: 16px;">
                                    <div class="form-group mr0" style="margin-top: 10px;">
                                        <input type="button" @(Model.FranchiseeId > 0 ? "" : "disabled") value="Documents" class="btn-custom btn btn-primary col-md-12" style="font-size: 11px;" onclick="CustomerIsViewDocumnetPOPUp(@Html.DisplayFor(one => one.FranchiseeId))" />
                                    </div>
                                    <div class="form-group mr0">
                                        <input type="button" @(Model.FranchiseeId > 0 ? "" : "disabled") value="Franchisee Activity" class="btn-custom btn btn-primary col-md-12" style="font-size: 11px;" onclick="OpenFranchiseeActivityPopup()" />
                                    </div>
                                    <div class="form-group mr0">
                                        <input type="button" @(Model.FranchiseeId > 0 ? "" : "disabled") value="Obligations" class="btn-custom btn btn-primary col-md-12" style="font-size: 11px;" onclick="showFranchiseeObligationDetail(@Html.DisplayFor(one => one.FranchiseeId))" />
                                    </div>
                                    <div class="form-group mr0">
                                        <input type="button" @(Model.FranchiseeId > 0 ? "" : "disabled") value="Maintenance" class="btn-custom btn btn-primary col-md-12" style="font-size: 11px;" onclick="showFranchiseeMaintenance(@Html.DisplayFor(one => one.FranchiseeId))" />
                                    </div>
                                </td>
                                <td class="col-md-3" style="padding-left: 3px;padding-right: 4.2px;padding-bottom: 16px;">
                                    <div class="form-group mr0" style="margin-top: 10px;">
                                        <input type="button" @(Model.FranchiseeId > 0 ? "" : "disabled") value="Account History" class="btn-custom btn btn-primary col-md-12" style="font-size: 11px;" onclick="showFranchiseeAccountHistoryDetail(@Html.DisplayFor(one => one.FranchiseeId))" />
                                    </div>
                                    <div class="form-group mr0">
                                        <input type="button" @(Model.FranchiseeId > 0 ? "" : "disabled") value="QC Report" class="btn-custom btn btn-primary col-md-12" style="font-size: 11px;" href="javascript:void(0);" />
                                    </div>
                                    <div class="form-group mr0">
                                        <input type="button" @(Model.FranchiseeId > 0 ? "" : "disabled") value="Leases" class="btn-custom btn btn-primary col-md-12" style="font-size: 11px;" onclick="LeaseDetail(@Model.FranchiseeId,@ViewBag.Leasestaus)" />
                                    </div>
                                    <div class="form-group mr0">
                                        <input type="button" @(Model.FranchiseeId > 0 ? "" : "disabled") value="Finder's Fee" class="btn-custom btn btn-primary col-md-12" style="font-size: 11px;" onclick="btnFeeDetailOpen(@Html.DisplayFor(one => one.FranchiseeId));" />
                                    </div>@*OpenFranchiseFinderFeeDetailPopup*@
                                </td>
                                <td class="col-md-3" style="padding-left: 3px;padding-right: 4.2px;padding-bottom: 16px;">
                                    <div class="form-group mr0" style="margin-top: 10px;">
                                        <input type="button" @(Model.FranchiseeId > 0 ? "" : "disabled") value="Customer Service Log" class="btn-custom btn btn-primary col-md-12" style="font-size: 11px;" onclick="showServiceLog(@Html.DisplayFor(one => one.FranchiseeId))" />
                                    </div>
                                    <div class="form-group mr0">
                                        <input type="button" @(Model.FranchiseeId > 0 ? "" : "disabled") value="Credit/Payment" class="btn-custom btn btn-primary col-md-12" style="font-size: 11px;" onclick="showCreditTransaction(@Html.DisplayFor(one => one.FranchiseeId))" />
                                    </div>
                                    <div class="form-group mr0">
                                        <input type="button" @(Model.FranchiseeId > 0 ? "" : "disabled") value="Manual Transaction" class="btn-custom btn btn-primary col-md-12" style="font-size: 11px;" onclick="ShowAddNewTransaction()" />
                                    </div>
                                    <div class="form-group mr0">
                                        <input type="button" @(Model.FranchiseeId > 0 ? "" : "disabled") value="Franchisee Report" class="btn-custom btn btn-primary col-md-12" style="font-size: 11px;" onclick="FranchiseeReport(@Html.DisplayFor(one => one.FranchiseeId))" />
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="col-md-12" style="background-color: #67809F;color: #fff;">
                    <div class="col-md-1 pnd5" style="text-align:left;padding-top:8px;">
                        Show
                    </div>
                    <div class="col-md-2 pnd5" style="text-align:left;">
                        @Html.DropDownList("TransactionsTypeList", null, new { @class = "form-control input-sm", @id = "select_transactionstype" })
                    </div>
                    <div class="col-md-1 pnd5"></div>
                    <div class="col-md-4 pnd5" style="text-align:right;padding-top:8px;">
                        Date
                    </div>
                    <div class="col-md-2 pnd5 " style=" text-align:right">
                        @*All; This Week; This Week-to-date; This Month; This Month-to-date; This Fiscal Quarter; This Fisco Quarter-to-date; This Fisco Year;
                            This Fisco Year-to-date; Yesterday; Last Week; Last Month; Last Quarter; Last Year; Custom Date*@
                        <select id="select_timeduration" class="form-control input-sm">
                            <option value="1">This Week</option>
                            <option value="2">This Week-to-date</option>
                            <option value="3" selected="selected">This Month</option>
                            <option value="4">This Month-to-date</option>
                            <option value="5">This Quarter</option>
                            <option value="6">This Quarter-to-date</option>
                            <option value="7">This Fiscal Year</option>
                            <option value="8">This Fiscal Year-to-date</option>
                            <option value="9">Today</option>
                            <option value="10">Yesterday</option>
                            <option value="11">Last Week</option>
                            <option value="12">Last Month</option>
                            <option value="13">Last Quarter</option>
                            <option value="14">Last Year</option>
                            <option value="15">Custom Date</option>
                            <option value="16">Period</option>
                        </select>
                    </div>
                    <div class="col-md-2 pnd5" style="padding-top: 10px; text-align:right" id="divspandate">
                        <span id="spnStartDate">08/01/2017</span> - <span id="spnEndtDate">08/31/2017</span>
                    </div>

                    <div class="col-md-1 pnd5" style="padding-top: 7px;display:none;" id="divSD">
                        <input type="text" name="txtStartDate" id="txtStartDate" value="" class="form-control input-sm date-picker RemovePeriodvalidation" style="padding: 3px;" />
                    </div>
                    <div class="col-md-1 pnd5" style="padding-top: 7px;display:none;" id="divED">
                        <input type="text" name="txtEndtDate" id="txtEndtDate" value="" class="form-control input-sm date-picker RemovePeriodvalidation" style="padding: 3px;" />
                    </div>
                    <div class="col-md-1 pnd5" style="display: none;" id="divmonth">
                        <select id="monthlist" class="form-control input-sm">
                            <option value=""></option>
                            <option value="1">Jan</option>
                            <option value="2">Feb</option>
                            <option value="3">Mar</option>
                            <option value="4">Apr</option>
                            <option value="5">May</option>
                            <option value="6">June</option>
                            <option value="7">July</option>
                            <option value="8">Aug</option>
                            <option value="9">Sep</option>
                            <option value="10">Oct</option>
                            <option value="11">Nov</option>
                            <option value="12">Dec</option>
                        </select>
                    </div>
                    <div class="col-md-1 pnd5" style="display: none;" id="divyear">
                        <select class="form-control input-sm" id="yearlist" style="padding-left: 2px;">
                            <option value=""></option>
                            <option value="2018">2018</option>
                            <option value="2017">2017</option>
                            <option value="2016">2016</option>
                            <option value="2015">2015</option>
                            <option value="2014">2014</option>
                            <option value="2013">2013</option>
                            <option value="2012">2012</option>
                            <option value="2011">2011</option>
                            <option value="2010">2010</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <table class="table table-striped table-bordered table-hover order-column" id="franchiseeTransList">
                    <thead>
                        <tr>
                            <th colspan="10" style="border-right: 2px solid blue;"></th>
                            <th colspan="2" style="text-align:center;border-right: 2px solid blue;border-top: 2px solid blue;">Total Transaction Amount</th>
                            <th></th>
                        </tr>
                        <tr>
                            <th style="width:120px;text-align:center;">
                                Transaction Type
                            </th>
                            <th style="width:90px;text-align:center;">
                                Invoice No
                            </th>
                            <th style="width:90px;text-align:center;">
                                Date
                            </th>
                            <th style="text-align:center;width:30px;">
                                Number
                            </th>
                            <th style="text-align:center;width:90px;">
                                Customer No
                            </th>
                            <th style="text-align:center;width:235px;">
                                Customer Name
                            </th>
                            <th style="width:245px;text-align:center;">
                                Description
                            </th>
                            <th style="text-align:center;width:50px;">
                                Amount
                            </th>
                            <th style="text-align:center;width:45px;">
                                Tax
                            </th>
                            <th style="text-align:center;width:40px;border-right: 2px solid blue;">
                                Fees (-)
                            </th>
                            <th style="text-align:center;width:45px;">
                                Debit
                            </th>
                            <th style="text-align:center;width:45px;border-right: 2px solid blue;">
                                Credit
                            </th>
                            @*<th style="text-align:center;width:45px;">
                                    Balance
                                </th>*@
                            <th style="text-align:center;width:80px;">
                                Status
                            </th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                    <tfoot>
                        <tr style="background:#95a5a6;color:white;">
                            <td colspan="7" style="width:530px;text-align:center;"><strong>Total:</strong> </td>
                            <td style="text-align:center;width:50px;"><strong><span id="totalAmount" style="float: right"></span> </strong> </td>
                            <td style="text-align:center;width:45px;"><strong><span id="totalTax" style="float: right"></span> </strong> </td>
                            <td style="text-align:center;width:40px; border-right: 2px solid blue;"><strong><span id="totalFees" style="float: right"></span> </strong> </td>
                            <td style="text-align:center;width:45px; border-left: 2px solid blue; border-bottom: 2px solid blue;"><strong><span id="totalDebit" style="float: right"></span> </strong> </td>
                            <td style="text-align:center;width:45px; border-right: 2px solid blue; border-bottom: 2px solid blue;"><strong><span id="totalCredit" style="float: right"></span> </strong> </td>
                            @*<td style="text-align:center;width:45px; border-left: 2px solid blue;"><strong><span id="totalBalance" style="float: right"></span> </strong> </td>*@
                            <td style="text-align:center;width:85px;"><strong><span></span> </strong> </td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
        <div class="clearfix"> </div>
    </div>
</div>

<form class="form-horizontal" id="form_invoicedetail"></form>
<div class="form-horizontal" action="" id="form_FranchiseeDistribution"></div>

<form class="form-horizontal" action="" id="form_service" method="POST">
    <div class="modal fade custom-model custom-form-design" id="modal_service" tabindex="-1" role="basic" aria-hidden="true" style="display: none;margin-top: 100px;">
        <div class="modal-dialog modal-sm">
            <div class="modal-content" style="border-radius: 8px;">
                <div class="modal-header headerbox list" style="padding:0px!important;border-bottom: none;">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="margin-top: 12px !important;margin-right: 12px !important;"></button>
                    <h4 class="modal-title" style="margin-top: 0px; margin-bottom: 4px;  padding: 7px!important;font-size: 12px;font-weight: bold;background: #3598DC !important;color: #FFF !important;border: 1px solid #3598DC !important;padding: 0px;border-radius: 8px 8px 0 0;text-transform: uppercase;">
                        Contract Detail Service
                    </h4>
                </div>
                <div class="modal-body" style="padding: 0px 30px 15px 30px;">
                    <section>
                        <div class="row">
                            <div style="max-width: 98%;margin: 0px auto;">
                                <div class="custom-form portlet light " id="form_wizard_1">
                                    <div class="portlet-body form">
                                        <form class="form-horizontal" action="#" id="submit_form" method="POST">
                                            <div class="form-body-outer" style="padding: 0px;">
                                                <div style="overflow:auto;width: 100%; margin: 0em auto;">
                                                    <div class="form-group">
                                                        <label class="control-label col-md-4">
                                                        </label>
                                                        <div class="col-md-3">
                                                            <label class="mt-checkbox" style="margin-bottom: 8px;">
                                                                <input type="checkbox" id="chkScheduleMonday" class="i-checks editcheck">Monday
                                                                <span></span>
                                                            </label>
                                                        </div>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="control-label col-md-4">
                                                        </label>
                                                        <div class="col-md-3">
                                                            <label class="mt-checkbox" style="margin-bottom: 8px;">
                                                                <input type="checkbox" id="chkScheduleTuesday" class="i-checks editcheck">Tuesday
                                                                <span></span>
                                                            </label>
                                                        </div>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="control-label col-md-4">
                                                        </label>
                                                        <div class="col-md-3">
                                                            <label class="mt-checkbox" style="margin-bottom: 8px;">
                                                                <input type="checkbox" id="chkScheduleWednesday" class="i-checks editcheck">Wednesday
                                                                <span></span>
                                                            </label>
                                                        </div>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="control-label col-md-4">
                                                        </label>
                                                        <div class="col-md-3">
                                                            <label class="mt-checkbox" style="margin-bottom: 8px;">
                                                                <input type="checkbox" id="chkScheduleThursday" class="i-checks editcheck">Thursday
                                                                <span></span>
                                                            </label>
                                                        </div>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="control-label col-md-4">
                                                        </label>
                                                        <div class="col-md-3">
                                                            <label class="mt-checkbox" style="margin-bottom: 8px;">
                                                                <input type="checkbox" id="chkScheduleFriday" class="i-checks editcheck">Friday
                                                                <span></span>
                                                            </label>
                                                        </div>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="control-label col-md-4">
                                                        </label>
                                                        <div class="col-md-3">
                                                            <label class="mt-checkbox" style="margin-bottom: 8px;">
                                                                <input type="checkbox" id="chkScheduleSaturday" class="i-checks editcheck">Saturday
                                                                <span></span>
                                                            </label>
                                                        </div>
                                                    </div>
                                                    <div class="form-group">
                                                        <label class="control-label col-md-4">
                                                        </label>
                                                        <div class="col-md-3">
                                                            <label class="mt-checkbox" style="margin-bottom: 8px;">
                                                                <input type="checkbox" id="chkScheduleSunday" class="i-checks editcheck">Sunday
                                                                <span></span>
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
                <!-- /.modal-content -->
            </div>
        </div>
    </div>
</form>

<div class="modal fade custom-model custom-form-design" id="ModalEditFranchisePopup" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
    <div class="modal-dialog" style="width:645px">
        <div class="modal-content" style="border-radius: 8px;" id="RenderEditFranchiseDetails">
        </div>
    </div>
</div>

<div class="modal fade custom-model custom-form-design" id="ModalEditFranchiseFourStepPopup" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
    <div class="modal-dialog" style="width:520px">
        <div class="modal-content" style="border-radius: 8px;" id="RenderEditFranchiseFourStepDetails">
        </div>
    </div>
</div>
<div class="form-horizontal" id="form_finderfeedetail"></div>
<div class="form-horizontal" id="form_FranchiseDistributionPopup"></div>

<div class="modal fade in" id="modal_ServiceCallLog" tabindex="-1" role="basic" aria-hidden="true" style="display: none; padding-right: 17px;">
    <div class="modal-dialog modal-lg" id="Render_ServiceCallLogDetails">
    </div>
</div>

<div class="modal fade in" id="modal_CollectionsCallLog" tabindex="-1" role="basic" aria-hidden="true" style="display: none; padding-right: 17px;">
    <div class="modal-dialog modal-lg" id="Render_CollectionsCallLogDetails">
    </div>
</div>

<div class="modal fade in" id="modal_AddNewTransaction" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
    <div class="modal-dialog modal-lg" id="Render_AddNewTransaction" style="width: 1200px;">
    </div>
</div>

<div class="modal fade in" id="modal_FranchiseeCredit" tabindex="-1" role="basic" aria-hidden="true" style="display: none; padding-right: 17px;">
    <div class="modal-dialog modal-lg" id="Render_FranchiseeCredit" style="width: 1200px;">

    </div>
</div>

<div class="modal fade custom-model custom-form-design" id="modal_FranchiseeActivityPopup" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content" style="border-radius: 8px;">
            <div class="modal-header headerbox list" style="padding:0px!important;border-bottom: none;">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="margin-top: 12px !important;margin-right: 12px !important;"></button>
                <h4 class="modal-title text-center" style="margin-top: 0px; margin-bottom: 4px;  padding: 7px!important;font-size: 12px;font-weight: bold;background: #3598DC !important;color: #FFF !important;border: 1px solid #3598DC !important;padding: 0px;border-radius: 8px 8px 0 0;text-transform: uppercase;">
                    FRANCHISEE ACTIVITY
                </h4>
            </div>
            <div class="modal-body" style="padding: 0px 30px 15px 30px;">
                <div class="form-group">
                    <div class="row">
                        <div class="col-md-12 text-center">
                            <span style="font-size: 15px;color: #8e44ad;"><b>701011 - KIMBURNS, LLC</b></span>
                        </div>
                        <div class="col-md-12">
                            <div class="table-responsive">
                                <table class="table table-striped table-bordered order-column">
                                    <thead>
                                        <tr style="background-color: #e8e8e8;">
                                            <th style="width:100px;text-align:center;font-size: 12px;">
                                                Bill Month
                                            </th>
                                            <th style="text-align:center;font-size: 12px;">
                                                Bill Year
                                            </th>
                                            <td style="text-align:center;">
                                                Fran. Name
                                            </td>
                                            <td style="text-align:center;">
                                                Due From Fran
                                            </td>
                                            <td style="text-align:center;">
                                                Due To Fran
                                            </td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td style="text-align:center;">12</td>
                                            <td style="text-align:center;">2017</td>
                                            <td style="text-align:center;">KMBURNS, LLC</td>
                                            <td style="text-align:right;">$0.00</td>
                                            <td style="text-align:right;">$142,757.63</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:center;">11</td>
                                            <td style="text-align:center;">2017</td>
                                            <td style="text-align:center;">KMBURNS, LLC</td>
                                            <td style="text-align:right;">$0.00</td>
                                            <td style="text-align:right;">$118,545.26</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:center;">10</td>
                                            <td style="text-align:center;">2017</td>
                                            <td style="text-align:center;">KMBURNS, LLC</td>
                                            <td style="text-align:right;">($69,603.72)</td>
                                            <td style="text-align:right;">$0.00</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:center;">9</td>
                                            <td style="text-align:center;">2017</td>
                                            <td style="text-align:center;">KMBURNS, LLC</td>
                                            <td style="text-align:right;">$0.00</td>
                                            <td style="text-align:right;">$0.00</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:center;">8</td>
                                            <td style="text-align:center;">2017</td>
                                            <td style="text-align:center;">KMBURNS, LLC</td>
                                            <td style="text-align:right;">$0.00</td>
                                            <td style="text-align:right;">$142,757.63</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:center;">7</td>
                                            <td style="text-align:center;">2017</td>
                                            <td style="text-align:center;">KEVIN M. BURNS</td>
                                            <td style="text-align:right;">$0.00</td>
                                            <td style="text-align:right;">$142,757.63</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:center;">6</td>
                                            <td style="text-align:center;">2017</td>
                                            <td style="text-align:center;">KEVIN M. BURNS</td>
                                            <td style="text-align:right;">$0.00</td>
                                            <td style="text-align:right;">$142,757.63</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:center;">5</td>
                                            <td style="text-align:center;">2017</td>
                                            <td style="text-align:center;">KEVIN M. BURNS</td>
                                            <td style="text-align:right;">$0.00</td>
                                            <td style="text-align:right;">$142,757.63</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:center;">4</td>
                                            <td style="text-align:center;">2017</td>
                                            <td style="text-align:center;">KEVIN M. BURNS</td>
                                            <td style="text-align:right;">$0.00</td>
                                            <td style="text-align:right;">$142,757.63</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:center;">3</td>
                                            <td style="text-align:center;">2017</td>
                                            <td style="text-align:center;">KEVIN M. BURNS</td>
                                            <td style="text-align:right;">$0.00</td>
                                            <td style="text-align:right;">$142,757.63</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:center;">2</td>
                                            <td style="text-align:center;">2017</td>
                                            <td style="text-align:center;">KEVIN M. BURNS</td>
                                            <td style="text-align:right;">$0.00</td>
                                            <td style="text-align:right;">$142,757.63</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:center;">1</td>
                                            <td style="text-align:center;">2017</td>
                                            <td style="text-align:center;">KEVIN M. BURNS</td>
                                            <td style="text-align:right;">$0.00</td>
                                            <td style="text-align:right;">$142,757.63</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:center;">12</td>
                                            <td style="text-align:center;">2016</td>
                                            <td style="text-align:center;">KEVIN M. BURNS</td>
                                            <td style="text-align:right;">$0.00</td>
                                            <td style="text-align:right;">$142,757.63</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:center;">11</td>
                                            <td style="text-align:center;">2016</td>
                                            <td style="text-align:center;">KEVIN M. BURNS</td>
                                            <td style="text-align:right;">$0.00</td>
                                            <td style="text-align:right;">$142,757.63</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:center;">10</td>
                                            <td style="text-align:center;">2016</td>
                                            <td style="text-align:center;">KEVIN M. BURNS</td>
                                            <td style="text-align:right;">$0.00</td>
                                            <td style="text-align:right;">$142,757.63</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:center;">9</td>
                                            <td style="text-align:center;">2016</td>
                                            <td style="text-align:center;">KEVIN M. BURNS</td>
                                            <td style="text-align:right;">$0.00</td>
                                            <td style="text-align:right;">$142,757.63</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:center;">8</td>
                                            <td style="text-align:center;">2016</td>
                                            <td style="text-align:center;">KEVIN M. BURNS</td>
                                            <td style="text-align:right;">$0.00</td>
                                            <td style="text-align:right;">$142,757.63</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:center;">7</td>
                                            <td style="text-align:center;">2016</td>
                                            <td style="text-align:center;">KEVIN M. BURNS</td>
                                            <td style="text-align:right;">$0.00</td>
                                            <td style="text-align:right;">$142,757.63</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:center;">6</td>
                                            <td style="text-align:center;">2016</td>
                                            <td style="text-align:center;">KEVIN M. BURNS</td>
                                            <td style="text-align:right;">$0.00</td>
                                            <td style="text-align:right;">$142,757.63</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:center;">5</td>
                                            <td style="text-align:center;">2016</td>
                                            <td style="text-align:center;">KEVIN M. BURNS</td>
                                            <td style="text-align:right;">$0.00</td>
                                            <td style="text-align:right;">$142,757.63</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:center;">4</td>
                                            <td style="text-align:center;">2016</td>
                                            <td style="text-align:center;">KEVIN M. BURNS</td>
                                            <td style="text-align:right;">$0.00</td>
                                            <td style="text-align:right;">$142,757.63</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:center;">3</td>
                                            <td style="text-align:center;">2016</td>
                                            <td style="text-align:center;">KEVIN M. BURNS</td>
                                            <td style="text-align:right;">$0.00</td>
                                            <td style="text-align:right;">$142,757.63</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:center;">2</td>
                                            <td style="text-align:center;">2016</td>
                                            <td style="text-align:center;">KEVIN M. BURNS</td>
                                            <td style="text-align:right;">$0.00</td>
                                            <td style="text-align:right;">$142,757.63</td>
                                        </tr>
                                        <tr>
                                            <td style="text-align:center;">1</td>
                                            <td style="text-align:center;">2016</td>
                                            <td style="text-align:center;">KEVIN M. BURNS</td>
                                            <td style="text-align:right;">$0.00</td>
                                            <td style="text-align:right;">$142,757.63</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div style="clear:both"></div>
            </div>
        </div>
    </div>
</div>
<div class="form-horizontal" id="form_FranchiseeBillingDetail"></div>


@*<div class="modal fade bs-modal-sm in" id="ModelPeriod" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-sm" style="padding-top: 100px;">
            <div class="modal-content">
                <div class="modal-header headerbox list" style="padding:0px!important;border-bottom: none;">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="margin-top: 12px !important;margin-right: 12px !important;"></button>
                    <h4 class="modal-title text-center" style="margin-top: 0px; margin-bottom: 4px;  padding: 7px!important;font-size: 12px;font-weight: bold;background: #3598DC !important;color: #FFF !important;border: 1px solid #3598DC !important;padding: 0px;border-radius: 8px 8px 0 0;text-transform: uppercase;">
                        Select Period
                    </h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="col-md-4" style="padding-left: 0px;padding-right: 0px;padding-top: 4px;text-align: right;">
                                    Period:
                                </div>
                                <div class="col-md-8">
                                    @Html.DropDownList("BillMonthYearList", (SelectList)ViewBag.BillMonthYears, new { @class = "form-control input-sm", @id = "select_BillMonthYearList", style = "" })
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>*@

<div class="modal fade custom-model custom-form-design" id="ModalFranchiseePayReportPopup" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
    <div class="modal-dialog" style="width:740px">
        <div class="modal-content" style="border-radius: 8px;min-height:90px;">
            <div class="custom-form portlet light" id="" style="margin-top:0px;">
                <div class="headerbox" style="font-weight: normal;border-radius:0px;background: #097fd0 !important;">
                    <div class="col-md-12 text-center" style="font-size:15px;">
                        <b> Franchisee Report</b>
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="margin-top: 5px !important;margin-right: 12px !important;"></button>
                    </div>
                    <div class="clearfix"> </div>
                </div>
                <div class="modal-header headerbox list" style="padding:0px!important;border-bottom: none;background: #097fd0 !important;">
                    <div class="col-md-8">

                    </div>
                    <div class="col-md-2 text-right" style="padding-top: 4px;">Report Period:</div>
                    <div class="col-md-2">
                        @Html.DropDownList("BillMonthYearList", (SelectList)ViewBag.BillMonthYears, "Select", new { @class = "form-control input-sm", @id = "select_BillMonthYearList", style = "" })
                    </div>

                </div>
                <div id="ModalFranchiseePayReportPopupInnerDiv" style="display:none;">
                    @*<div class="headerbox" style="font-weight: normal;border-radius:0px;background: #097fd0 !important;">
                            <div class="col-md-12 text-center" style="font-size:15px;">
                                <b> Franchisee Report</b>
                                <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="margin-top: 5px !important;margin-right: 12px !important;"></button>
                            </div>
                            <div class="clearfix"> </div>
                        </div>*@
                    <div class="form-actions">
                        <div class="col-md-8">
                        </div>
                        <div class="col-md-4">
                            <button type="button" class="btn btn-primary button-next" style="margin-left:10px;" onclick="ExportPDFFranchiseePayReport()">Export <i class="fa fa-download"></i></button>
                            <button type="button" class="btn btn-primary button-next" style="margin-left:10px;" onclick="PrintFranchiseePayReport()">Print <i class="fa fa-print"></i></button>
                        </div>
                    </div>
                    <div class="portlet-body" style="padding:14px;" id="RenderFranchiseePayReportDetails"></div>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="modal fade custom-model custom-form-design" id="modal_FranchiseeMaintenance" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
    <div class="modal-dialog modal-sm" style="width: 950px;">
        <div class="modal-content" style="border-radius: 8px;">
            <div class="modal-header headerbox list" style="padding:0px!important;border-bottom: none;">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="margin-top: 12px !important;margin-right: 12px !important;"></button>
                <h4 class="modal-title text-center" style="margin-top: 0px; margin-bottom: 4px;  padding: 7px!important;font-size: 12px;font-weight: bold;background: #3598DC !important;color: #FFF !important;border: 1px solid #3598DC !important;padding: 0px;text-transform: uppercase;">
                    Franchisee Maintenance
                </h4>
            </div>
            <div id="form_Maintenancemaintenance">

            </div>
        </div>

    </div>
</div>

<div class="modal fade in" id="modal_FranchiseeAccountHistoryReport" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
    <div class="modal-dialog" style="width:1200px;">
        <div class="modal-content" style="border-radius: 8px;">
            <div class="modal-header headerbox list" style="padding:0px!important;border-bottom: none;">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="margin-top: 12px !important;margin-right: 12px !important;"></button>
                <h4 class="modal-title text-center" style="margin-top: 0px; margin-bottom: 4px;  padding: 7px!important;font-size: 12px;font-weight: bold;background: #3598DC !important;color: #FFF !important;border: 1px solid #3598DC !important;padding: 0px;border-radius: 8px 8px 0 0;text-transform: uppercase;">
                    Franchisee Account History Report
                </h4>
            </div>
            <div class="modal-body" id="modelbody_FranchiseeAccountHistoryReport">

            </div>
        </div>
    </div>
</div>
<div class="form-horizontal" id="form_FinderFeeBillDetail"></div>
<div class="form-horizontal" id="form_ChargeBackDetail"></div>
<div class="form-horizontal" id="form_FMTDetail"></div>
<div class="modal fade custom-model custom-form-design" id="modal_FeeReport" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
    <div class="modal-dialog" style="width: 1300px;">
        <div class="modal-content" style="border-radius: 8px;">
            <div class="modal-header headerbox list" style="padding:0px!important;border-bottom: none;">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="margin-top: 12px !important;margin-right: 12px !important;"></button>
                <h4 class="modal-title text-center" style="margin-top: 0px; margin-bottom: 4px;  padding: 7px!important;font-size: 12px;font-weight: bold;background: #3598DC !important;color: #FFF !important;border: 1px solid #3598DC !important;padding: 0px;border-radius: 8px 8px 0 0;text-transform: uppercase;">
                    Finder Fee Detail
                </h4>
            </div>
            <div class="custom-listbox" style="margin-top: 0px;">
                <div class="headerbox" style="border-radius: 0;">
                    <div class="row no-padding">
                        <div class="col-md-4">
                            <div class="input-icon" style="width:280px;">
                                <i class="icon-magnifier icon-align-right" style="margin-top: 8px;"></i>
                                <input id="txtdetailinput_Search" type="text" required name="finderfeesearch" autocomplete="off" placeholder="Search..." value="" class="form-control input-sm typeahead" />
                            </div>
                        </div>
                        <div class="col-md-4"></div>
                        <div class="col-md-4 pull-right" style="padding-right:5px;">
                            @if (ViewBag.StatusList != null)
                            {
                                <div class="col-md-12 pull-right no-padding">
                                    <div class="col-md-6 no-padding" style="text-transform:none;font-weight:normal;text-align: right;margin-top: 3px;">
                                        Finder's Fee Status
                                    </div>
                                    <div class="col-md-6 no-padding" style="padding-left: 6px;">
                                        <select id="ddlStatusDetail" multiple="multiple" style="display:none;">
                                            @foreach (var item in (MultiSelectList)ViewBag.StatusList)
                                            {
                                                <option @(item.Selected ? "selected" : "") value="@item.Value">@item.Text</option>
                                            }
                                        </select>
                                    </div>
                                </div>
                            }
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-body" style="padding: 0px 30px 15px 30px;">

                <div class="form-group">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="table-responsive">
                                <input type="hidden" name="hddFF_FranchiseeId" id="hddFF_FranchiseeId" value="0" />
                                <table class="table table-striped table-bordered order-column" id="tblFFDetailListheader">
                                    <thead>
                                        <tr style="background-color: #e8e8e8;">
                                            <th style="width:100px;text-align:center;font-size: 12px;">
                                                Franchisee No.
                                            </th>
                                            <th colspan="8" style="text-align:center;font-size: 12px;">
                                                Franchisee Name
                                            </th>
                                            <td style="text-align:center;width:140px;">
                                                Total Finder Fee
                                            </td>
                                            <td style="text-align:center;width:140px;">
                                                Total Down Payment
                                            </td>
                                            <td style="text-align:center;width:140px;">
                                                Total Monthly Payment
                                            </td>
                                            <td style="text-align:center;width:80px;">
                                                Total Paid
                                            </td>
                                            <td style="text-align:center;width:80px;">
                                                Balance
                                            </td>
                                        </tr>

                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td style="text-align:center;"><span id="spnFF_FranchiseeNo"></span> </td>
                                            <td colspan="8" style="text-align:center;"><span id="spnFF_FranchiseeName"></span></td>
                                            <td style="text-align:center;">$<span id="spnFF_TotalFinderFee"></span></td>
                                            <td style="text-align:center;">$<span id="spnFF_TotalDownPayment"></span></td>
                                            <td style="text-align:center;">$<span id="spnFF_TotalMonthlyPayment"></span></td>
                                            <td style="text-align:center;">$<span id="spnFF_TotalPaid"></span></td>
                                            <td style="text-align:center;">$<span id="spnFF_Balance"></span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="table-responsive">
                                <table class="table table-striped table-bordered order-column" id="tblFFDetailList">
                                    <thead>
                                        <tr style="background-color: #e8e8e8;">
                                            <th style="width:100px;text-align:center;font-size: 12px;">
                                                Customer No
                                            </th>
                                            <th style="text-align:center;font-size: 12px;">
                                                Customer Name
                                            </th>
                                            <td style="text-align:center;">
                                                FF Type
                                            </td>
                                            <td style="text-align:center;">
                                                Contract Billing
                                            </td>
                                            <td style="text-align:center;">
                                                FF Started
                                            </td>
                                            <td style="text-align:center;">
                                                No of Payment
                                            </td>
                                            <td style="text-align:center;">
                                                Payment #
                                            </td>
                                            <td style="text-align:center;width:110px;">
                                                Total Finder Fee
                                            </td>
                                            <td style="text-align:center;width:110px;">
                                                Total Down Payment
                                            </td>
                                            <td style="text-align:center;width:110px;">
                                                Total Monthly Payment
                                            </td>
                                            <td style="text-align:center;width:70px;">
                                                Total Paid
                                            </td>
                                            <td style="text-align:center;width:70px;">
                                                Balance
                                            </td>
                                            <td style="text-align:center;width:70px;">
                                                Status
                                            </td>
                                            <td style="text-align:center;width:70px;">
                                                Status Date
                                            </td>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <br />
                <div class="col-md-12">
                    &nbsp;<button type="button" class="btn btn-primary button-next pull-right" style="margin-left:10px;" onclick="DetailListPrint()">Print</button>
                    &nbsp;<button type="submit" class="btn btn-primary button-next pull-right" onclick="DetailListExportPDF()">Export</button>
                </div>
                <div style="clear:both"></div>
            </div>

        </div>

    </div>
</div>
<div class="form-horizontal" id="form_invoicedetail"></div>
<form class="form-horizontal" action="" id="form_service" method="POST">
    <div class="modal fade custom-model custom-form-design" id="modal_LeaseDetail" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
        <div class="modal-dialog modal-lg">
            <div class="modal-content" style="border-radius: 8px;">
                <div class="modal-header headerbox list" style="padding:0px!important;border-bottom: none;">
                    <div class="row">
                        <div class="col-lg-8 modal-title" style="margin-top: 0px; margin-bottom: 4px; height:40px;  padding: 7px!important;font-size: 12px;font-weight: bold;background: #3598DC !important;color: #FFF !important;border: 1px solid #3598DC !important;padding: 0px;border-radius: 8px 0px 0 0;text-transform: uppercase;">
                            Franchisee Lease Info
                        </div>
                        <div class="modal-title col-lg-3" style="margin-top: 0px; margin-bottom: 4px;  padding: 7px!important;background: #3598DC !important;color: #FFF !important;border: 1px solid #3598DC !important;padding: 0px;border-radius: 0px 0px 0 0;">
                            <div class="col-md-4 control-label">
                                Status<span style="color:#000000;">&nbsp;</span>
                            </div>
                            <div class="col-md-8">
                                <select class="form-control input-sm" id="ddlStatusList" name="ddlStatusList">
                                    @foreach (var item in (MultiSelectList)ViewBag.LeaseStatusList)
                                    {
                                        <option value="@item.Value">@item.Text</option>
                                    }
                                </select>

                            </div>

                        </div>
                        <div class="col-lg-1" style="margin-top: 0px; margin-bottom: 4px; height:40px; padding: 7px!important;background: #3598DC !important;color: #FFF !important;border: 1px solid #3598DC !important;padding: 0px;border-radius: 0px 8px 0 0;text-transform: uppercase;">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="margin-top: 12px !important;margin-right: 12px !important;"></button>
                        </div>
                    </div>
                </div>
                <div class="modal-body" style="padding: 0px 30px 15px 30px;">
                    <section>
                        <div style="max-width: 100%;margin: 0px auto;padding-left: 0px;padding-right: 0px;border-radius: 8px;">

                            <div class="form-group">
                                <div class="col-md-5" style="border: 1px solid #999;border-radius: 7px;padding: 7px;">
                                    <div class="row">
                                        <div class="col-md-4 control-label" style="padding-top: 0px;">
                                            <b>Franchise No.</b>
                                        </div>
                                        <div class="col-md-8">
                                            <span id="spnFranchiseeNumber"></span>
                                        </div>

                                    </div>
                                    <div class="row">
                                        <div class="col-md-4 control-label" style="padding-top: 0px;">
                                            <b>Franchise Name</b>
                                        </div>
                                        <div class="col-md-8">
                                            <span id="spnFranchiseeName"></span>
                                        </div>

                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="col-md-4 control-label">
                                    </div>
                                    <div class="col-md-8">
                                    </div>
                                </div>
                                <div class="col-md-4" style="border: 1px solid #999;border-radius: 7px;padding: 7px;">
                                    <div class="row">
                                        <div class="col-md-4 control-label" style="padding-top: 0px;">
                                            <b>Address</b>
                                        </div>
                                        <div class="col-md-8">
                                            <span id="spnFranchiseeAddress"></span>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-4 control-label" style="padding-top: 0px;">

                                        </div>
                                        <div class="col-md-8">
                                            <span id="spnCityStatePincode"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>


                            <div class="headerbox row" style="margin-bottom: 10px;">
                                <div class="row" style="background-color: #999;color: #fff;padding: 5px 8px;font-weight: bold;">
                                    Lease Information
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-2 control-label">
                                    Lease No<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm" id="txtLeaseNumber" value="70-2121" readonly />
                                </div>


                                <div class="col-md-2 control-label">
                                    Date Signed<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <div class="input-group date" data-date-format="mm/dd/yyyy">
                                        <input type="text" class="form-control input-sm date-picker" id="txtSignDate" value="4/27/2015" disabled />
                                        <span class="input-group-btn">
                                            <button class="btn default" type="button" style="margin-top: 2px;">
                                                <i class="fa fa-calendar"></i>
                                            </button>
                                        </span>
                                    </div>
                                </div>
                                <div class="col-md-2 control-label">
                                    Payment Starts<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <div class="input-group date" data-date-format="mm/dd/yyyy">
                                        <input type="text" class="form-control input-sm date-picker" id="txtStartDate" value="4/27/2015" disabled />
                                        <span class="input-group-btn">
                                            <button class="btn default" type="button" style="margin-top: 2px;">
                                                <i class="fa fa-calendar"></i>
                                            </button>
                                        </span>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">


                                <div class="col-md-2 control-label">
                                    Make<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm" id="txtMake" value="" readonly />
                                </div>
                                <div class="col-md-2 control-label">
                                    Model<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm" id="txtModel" value="" readonly />
                                </div>
                                <div class="col-md-2 control-label">
                                    Serial No<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm" id="txtSerialNo" value="" readonly />
                                </div>
                            </div>


                            <div class="form-group">
                                <div class="col-md-2 control-label">
                                    Description<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-10">
                                    <input type="text" class="form-control input-sm" id="txtDescription" value="" readonly />
                                </div>
                            </div>
                            <div class="headerbox row" style="margin-bottom: 10px;">
                                <div class="row" style="background-color: #999;color: #fff;padding: 5px 8px;font-weight: bold;">
                                    Lease Payment Information
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-offset-1 col-md-3">
                                    <label class="mt-checkbox input-sm" style="margin-bottom: 0px;">
                                        <input type="checkbox" class="i-check" checked="checked" id="chkChargeTaxUpFront" />Charge Tax Upfront
                                        <span style="margin-top: 4px;"></span>
                                    </label>
                                </div>
                                <div class="col-md-4">
                                    <label class="mt-checkbox input-sm" style="margin-bottom: 0px;">
                                        <input type="checkbox" class="i-check" checked="checked" id="IncludeFirstPaymentInDownPayment" />Include First Payment in Down Payment
                                        <span style="margin-top: 4px;"></span>
                                    </label>
                                </div>
                                <div class="col-md-2 control-label">
                                    # of Down Payment<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm text-right" id="txtInstallmentDownPaymentNum" value="" disabled />
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-2 control-label">
                                    Lease Amount<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm text-right" id="txtLeaseAmount" value="" readonly />
                                </div>

                                <div class="col-md-2 control-label">
                                    Monthly Payment Amount<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm text-right" id="txtMonthlyPaymentAmount" value="" readonly />
                                </div>
                                <div class="col-md-2 control-label">
                                    # of Monthly Payments<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm text-right" id="txtInstallmentMonthlyPaymentNum" value="13" readonly />
                                </div>

                            </div>

                            <div class="form-group">
                                <div class="col-md-2 control-label">
                                    Total Tax<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm text-right" id="txtLeaseTotalTax" value="" readonly />
                                </div>
                                <div class="col-md-2 control-label">
                                    Tax Rate<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm text-right" id="txtMonthlyTaxRate" value="0%" readonly />
                                </div>
                                <div class="col-md-2 control-label">
                                    # of Last Payment<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm text-right" id="txtInstallmentLastPaymentNum" value="0" disabled />
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-2 control-label">
                                    Total Lease<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm text-right" id="txtLeaseTotal" value="" readonly />
                                </div>

                                <div class="col-md-2 control-label">
                                    Monthly payment<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm text-right" id="txtMonthlyPaymentTotal" value="" readonly />
                                </div>


                                <div class="col-md-2 control-label">
                                    Total # of payment<span style="color:#000000;">&nbsp;:</span>
                                </div>
                                <div class="col-md-2">
                                    <input type="text" class="form-control input-sm text-right" id="txtInstallmentTotalPaymentNum" value="" disabled />
                                </div>
                            </div>
                        </div>
                        <input type="hidden" id="hdnFranchiseeID" name="hdnFranchiseeID" />
                        <div class="form-group">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="table-responsive">
                                        <table class="table table-striped table-bordered table-hover order-column" id="tbllistdetail">
                                            <thead>
                                                <tr>
                                                    <th style="width:100px;text-align:center;">
                                                        Lease No.
                                                    </th>
                                                    <th style="width:100px;text-align:center;">
                                                        Total
                                                    </th>
                                                    <th style="width:80px;text-align:center;">
                                                        Payment Total
                                                    </th>
                                                    <th style="text-align:center;width:80px;">
                                                        Payments
                                                    </th>
                                                    <th style="text-align:center;width:80px;">
                                                        Balance
                                                    </th>
                                                    <th style="text-align:center;width:50px;">
                                                        Status
                                                    </th>
                                                    <th style="text-align:center;width:20px;">
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td class="text-center">70-2129</td>
                                                    <td class="text-center">0.00</td>
                                                    <td class="text-center">98.20</td>
                                                    <td class="text-center">18 of 28</td>
                                                    <td class="text-center">$1,767.60</td>
                                                    <td class="text-center"><i class="fa fa-check" style="color: green;font-size: 15px;"></i></td>
                                                    <td class="text-center"><i class="fa fa-edit" style="color: cornflowerblue;font-size: 15px;"></i></td>
                                                    <td class="text-center"><i class="fa fa-trash" style="color: red;font-size: 15px;"></i></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <input type="button" @(Model.FranchiseeId > 0 ? "" : "disabled") value="Add New Lease" class="btn-custom btn btn-primary col-md-12" style="font-size: 11px; width:150px;" onclick="location.href='@Url.Action("FranchiseeLease", "Franchise", new { area = "Portal", id = Model.FranchiseeId })'" />
                        </div>
                    </section>
                </div>
                <!-- /.modal-content -->
            </div>
        </div>
    </div>
</form>
@*<div class="modal fade in" id="modal_FranchiseeObligationDetailReport" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
        <div class="modal-dialog" style="width:1200px;">
            <div class="modal-content" style="border-radius: 8px;">
                <div class="modal-header headerbox list" style="padding:0px!important;border-bottom: none;">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="margin-top: 12px !important;margin-right: 12px !important;"></button>
                    <h4 class="modal-title text-center" style="margin-top: 0px; margin-bottom: 4px;  padding: 7px!important;font-size: 12px;font-weight: bold;background: #3598DC !important;color: #FFF !important;border: 1px solid #3598DC !important;padding: 0px;border-radius: 8px 8px 0 0;text-transform: uppercase;">
                        Obligation Report
                    </h4>
                </div>
                <div class="modal-body" id="modelbody_FranchiseeObligationDetailReport">

                </div>
            </div>
        </div>
    </div>*@
<div class="modal fade in" id="modal_FranchiseeObligationDetailReport" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
    <div class="modal-dialog" id="modelbody_FranchiseeObligationDetailReport" style="width: 1200px;">
    </div>
</div>

<div class="modal fade custom-model custom-form-design" id="ModalCustomerSerarchPopup" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
    <div class="modal-dialog" style="width:350px">
        <div class="modal-content" style="border-radius: 0px;" id="RenderFranchiseDistributionCustomer">
            <div class="modal-content" style="border-radius: 8px;" id="RenderFranchiseDistribution">
                <div class="custom-form portlet light" id="" style="margin-top:0px;box-shadow: none;">
                    <div class="headerbox" style="font-weight: normal;border-radius: 0;">
                        <div class="col-md-12 text-center" style="font-size:15px;">
                            <b> SEARCH CUSTOMER</b>
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="margin-top: 5px !important;margin-right: 12px !important;"></button>
                        </div>
                        <div class="clearfix"> </div>
                    </div>
                    <div class="row" style="padding-top:8px;padding-bottom:8px;margin-left: 0px;margin-right: 0px;min-height: 100px;">
                        <div class="col-md-12">
                            <div class="col-md-12">
                                <input type="hidden" id="hdfsearch_customerid" name="hdfsearch_customerid" value="0" />
                                <input type="hidden" id="hdnFranId" name="hdnFranId" value="@Model.FranchiseeId " />

                                <div class="input-icon" style="margin-top: 30px;">
                                    <i class="icon-magnifier icon-align-right" style="margin-top: 8px;"></i>
                                    <input id="fcsearch-box" type="text" required name="franchiseenumber" autocomplete="off" placeholder="Search Customer Name or Number" value="" class="form-control input-sm typeahead" />
                                </div>
                            </div>
                        </div>
                    </div>
                    @*<div class="row">
                            <div class="col-md-12">
                                <div class="col-md-12">
                                    <button type="button" class="btn btn-primary button-next pull-right" onclick="ShowCustomerSave()">Submit</button>
                                </div>
                            </div>
                        </div>*@
                </div>
            </div>

        </div>
    </div>
</div>

<div class="form-horizontal" id="RenderAccountOfferingDetail"></div>

<div class="modal fade in" id="modal_EditManualTransaction" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
    <div class="modal-dialog modal-lg" id="Render_EditManualTransaction" style="width: 1168px;">
    </div>
</div>

<div class="modal fade custom-model custom-form-design" id="ModalEditFranchiseMaintenancePopup" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
    <div class="modal-dialog" style="width:645px">
        <div class="modal-content" style="border-radius: 8px;" id="RenderEditFranchiseMaintenance">
        </div>
    </div>
</div>

<div class="modal fade custom-model custom-form-design" id="ModalEditFranchisePlanInfoMaintenancePopup" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
    <div class="modal-dialog" style="width:520px">
        <div class="modal-content" style="border-radius: 8px;" id="RenderEditFranchisePlanInfoMaintenanceDetails">
        </div>
    </div>
</div>
<div class="form-horizontal" id="RenderAccountOfferingListingDetail"></div>

@section pageplugins{
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/jquery-ui/jquery-ui.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/jquery-validation/js/jquery.validate.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/jquery-inputmask/jquery.inputmask.bundle.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/scripts/datatable.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/datatables/datatables.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/scripts/app.min.js")" type="text/javascript" )"></script>
    <script src="@Url.Content("~/Content/admin/assets/pages/scripts/table-datatables-managed.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/moment.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/bootstrap-typeahead/bootstrap3-typeahead.min.js")" type="text/javascript"></script>
}
@section scripts{
    <script src="@Url.Content("~/Content/admin/assets/pages/scripts/components-date-time-pickers.min.js")" type="text/javascript"></script>
    <script type="text/javascript">
        function showCInvoiceDetail(id) {
            $.blockUI()
            var sURL = '@Url.Action("InvoiceDetail", "AccountReceivable", new { area = "Portal" })?Id=' + id;
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    $('#form_invoicedetail').html(data);
                    $("#modal_invoicedetail").modal({ backdrop: 'static' });
                    $.unblockUI()
                },
                error: function (err) {
                    console.log(err);
                    $.unblockUI()
                }

            });
        }
        function btnInvoicePopupClose() {
            $("#modal_invoicedetail").modal('hide');
        }
        $(document).ready(function () {
            //$('#franchiseeTransList').dataTable({
            //    "bProcessing": true,
            //    "aLengthMenu": [[5, 10, 25, 50, -1], [5, 10, 25, 50, "All"]],
            //    "pageLength": 200,
            //    "dom": "<'table-responsive't>"
            //});
            $("#ddlStatusDetail").multiselect({
                includeSelectAllOption: true,
                selectAllText: 'Select all',
                buttonWidth: '100%',
                nonSelectedText: 'Select Status..',
                dropRight: true,
                numberDisplayed: 2
            });

            $("#ddlStatusDetail").change(function () {
                _FFDetail = [];
                btnOpenDeatilBind();
            });

            $("#ddlperfix").change(function () {
                var url = '@Url.Action("Franchiseedetail", "Franchise", new { area = "Portal", id =  -1})';
                var path = url.replace("-1", $("#ddlperfix").val());
                location.href = path;
            })

            $("#rdoSingleCredit").prop("checked", true);
            $("#divRecc").hide();
            $("#divRecNP").hide();
            //divRecNP
            $("#rdoSingleCredit").change(function () {
                if (this.value == 1) {
                    $("#rdoSingleCredit").prop("checked", true);
                    $("#rdoRecurringCredit").prop("checked", false);
                    $("#divRec").hide();
                    $("#divRecNP").hide();
                }
            });

            $("#rdoRecurringCredit").change(function () {
                if (this.value == 0) {
                    $("#rdoSingleCredit").prop("checked", false);
                    $("#rdoRecurringCredit").prop("checked", true);
                    $("#divRec").show();
                    $("#divRecNP").show();
                }
            });




            function applyAutoSeacrh() {
                $.blockUI()
                $.ajax({
                    type: "GET",
                    url: '@Url.Action("GetAllFranchisees", "Franchise", new { area = "Portal" })',
                    data: {},
                    success: function (data) {
                        var typeaheadSource = [];
                        $.each(data, function (key, value) {
                            typeaheadSource.push({ id: value.FranchiseeId, name: value.FranchiseeNo + ' ' + value.Name })
                        });

                        $('#input_Search').typeahead({
                            source: typeaheadSource,
                            updater: function (item) {
                                console.log(item);
                                //$("#hdfCustomerId").val(item.id);
                                redirect(item.id);
                                return item;
                            }
                        }).focus();
                    }
                });
                $.unblockUI();
            }
            applyAutoSeacrh();
            $("#lblamount").inputmask("numeric", {
                decimal: ".",
                negative: false,
                scale: 2,
                groupSeparator: ",",
                digits: 2,
                autoGroup: true,
                prefix: "$",
                rightAlign: false,
                autoUnmask: true,
                removeMaskOnSubmit: true,
            });
            $('.modal-dialog').draggable();


            settimeduration_select(3)
            if(@Model.FranchiseeId > 0)
                _bindTrasaction($('#select_transactionstype').val(), $('#spnStartDate').text(), $('#spnEndtDate').text());

        });
        function settimeduration_select(id) {
            $('#select_timeduration').val(id)
            $('#spnStartDate').html('');
            $('#spnEndtDate').html('');
            $('#divspandate').show();
            $('#divSD').hide();
            $('#divED').hide();
            $('#divmonth').hide();
            $('#divyear').hide();
            $('#monthlist').val('');
            $('#yearlist').val('');
            switch (parseInt(id)) {
                case 1:
                    firstDay = moment().startOf('isoWeek').toString();
                    lastDay = moment().endOf('isoWeek').toString();
                    break;
                case 2:
                    //code block
                    firstDay = moment().startOf('isoWeek').toString();
                    lastDay = new Date().toString();
                    break;
                case 3:
                    firstDay = moment().subtract(0, 'month').startOf('month').toString();
                    lastDay = moment().subtract(0, 'month').endOf('month').toString();
                    break;
                case 4:
                    //code block
                    firstDay = moment().subtract(0, 'month').startOf('month').toString();
                    lastDay = new Date().toString();
                    break;
                case 5:
                    //code block
                    firstDay = moment().startOf('quarter').toString();
                    lastDay = moment().endOf('quarter').toString();
                    break;
                case 6:
                    //code block
                    firstDay = moment().startOf('quarter').toString();
                    lastDay = new Date().toString();
                    break;
                case 7:
                    //code block
                    firstDay = moment().startOf('year').toString();;
                    lastDay = moment().endOf('year').toString();
                    break;
                case 8:
                    //code block
                    firstDay = moment().startOf('year').toString();
                    lastDay = new Date().toString();
                    break;
                case 9:
                    //code block
                    firstDay = moment().toString();
                    lastDay = moment().toString();
                    break;
                case 10:
                    //code block
                    firstDay = moment().add(-1, 'days').toString();
                    lastDay = moment().add(-1, 'days').toString();
                    break;
                case 11:
                    //code block
                    firstDay = moment().subtract(1, 'week').startOf('week').toString();
                    lastDay = moment().subtract(1, 'week').endOf('week').toString();
                    break;
                case 12:
                    //code block
                    firstDay = moment().subtract(1, 'month').startOf('month').toString();
                    lastDay = moment().subtract(1, 'month').endOf('month').toString();
                    break;
                case 13:
                    //code block
                    firstDay = moment().subtract(1, 'quarter').startOf('quarter').toString();
                    lastDay = moment().subtract(1, 'quarter').endOf('quarter').toString();
                    break;
                case 14:
                    //code block
                    firstDay = moment().subtract(1, 'year').startOf('year').toString();
                    lastDay = moment().subtract(1, 'year').endOf('year').toString();
                    break;
                case 15:
                    //code block
                    $('#divspandate').hide();
                    $('#divSD').show();
                    $('#divED').show();
                    $('#txtStartDate').val('');
                    $('#txtEndtDate').val('')
                    break;
                case 16:
                    //code block
                    $('#divspandate').hide();
                    $('#divSD').hide();
                    $('#divED').hide();
                    $('#divmonth').show();
                    $('#divyear').show();
                    break;
                default:
                    //code block
            }
            $('#spnStartDate').html(moment(firstDay).format('L'));
            $('#spnEndtDate').html(moment(lastDay).format('L'));
        }
        function showInvoiceDetail(id) {
            $.blockUI()
            var sURL = '@Url.Action("FranchiseeBillingDetailPopup", "AccountsPayable", new { area = "Portal" })?Id=' + id;
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    $('#form_FranchiseeBillingDetail').html(data);
                    $("#modal_FranchiseeBillingDetail").modal({ backdrop: 'static' });
                    $("#modal_FranchiseeBillingDetail").draggable();
                    $.unblockUI();
                },
                error: function (err) {
                    console.log(err);
                    $.unblockUI();
                }
            });
        }
        typeaheadSource = [];
        $.ajax({
            type: "GET",
            url: '@Url.Action("Frenchiseedata", "AccountReceivable", new { area = "Portal" })',
            success: function (data) {
                custlist = data;

                $.each(custlist, function (key, value) {
                    typeaheadSource.push({ value: value.FranchiseeId, label: value.FranchiseeNo + ' ' + $.trim(value.Name) })
                });

            }
        });

        $('#select_transactionstype').change(function () {
            _bindTrasaction($('#select_transactionstype').val(), $('#spnStartDate').text(), $('#spnEndtDate').text());
        });

        function formatJSONDateUtc(jsonDate) {
            if (jsonDate != null) {
                var dtstr = jsonDate.substr(6);
                var dateString = dtstr.substring(0, dtstr.length - 2);
                var currentTime = new Date(parseInt(dateString)).toUTCString();
                var date = moment.utc(currentTime).format("MM/DD/YYYY");
                return date;
            }
            return null;
        }

        function _bindTrasaction(typeid, sdate, edate) {
            $('#totalAmount').text('');
            $('#totalTax').text('');
            $('#totalDebit').text('');
            $('#totalFees').text('');
            $('#totalCredit').text('');
            $('#totalBalance').text('');
            $('#franchiseeTransList tbody').html('');
            var elem= $('#franchiseeTransList tbody');
            var _monthVal = $('#monthlist').val();
            var _yearVal = $('#yearlist').val();
            $.blockUI()
            $.ajax({
                url: '@Url.Action("GetAllFranchiseTransactionsWithStatus", "Franchise", "Portal")&franchiseId=@Html.DisplayFor(one => one.FranchiseeId)&masterTrxTypeId=' + typeid + '&spnStartDate=' + sdate + '&spnEndDate=' + edate + '&month=' + _monthVal + '&year=' + _yearVal,
                success: function (res) {

                    var tempRow = "";
                    $(elem).html('');
                    var vBalamt = 0;//parseFloat(res.StartingBalance);

                    //tempRow += '<tr>';
                    //tempRow += '<td style="text-align: center;font-size: 12px;">&nbsp;</td>';
                    //tempRow += '<td style="text-align: center;font-size: 12px;">' + sdate + '</td>'
                    //tempRow += '<td style="text-align: center;font-size: 12px;">&nbsp;</td>';
                    //tempRow += '<td style="text-align: center;font-size: 12px;">&nbsp;</td>';
                    //tempRow += '<td style="text-align: center;font-size: 12px;">&nbsp;</td>';
                    //tempRow += '<td style="text-align: center;font-size: 12px;">Previous Balance (as of ' + sdate + ')</td>';
                    //tempRow += '<td style="text-align: center;font-size: 12px;">&nbsp;</td>';
                    //tempRow += '<td style="text-align: center;font-size: 12px;">&nbsp;</td>';
                    //tempRow += '<td style="text-align: center;font-size: 12px;border-right: 2px solid blue;">&nbsp;</td>';
                    //tempRow += '<td style="text-align: center;font-size: 12px;">&nbsp;</td>';
                    //tempRow += '<td style="text-align: center;font-size: 12px;border-right: 2px solid blue;">&nbsp;</td>';
                    //tempRow += '<td style="text-align: right;font-size: 12px;">' + formatCurrency(vBalamt, true) + '</td>';
                    //tempRow += '<td style="text-align: center;font-size: 12px;">&nbsp;</td>';
                    //tempRow += '</tr>';

                    //$(elem).append(tempRow);
                    var totalAmount=0.0;
                    var totalTax=0.0;
                    var totalFees=0.0;
                    var totaldebit=0.0;
                    var totalCredit=0.0;
                    $.each(res.Transactions, function (index, value) {

                        tempRow = "";

                        vBalamt=vBalamt+parseFloat(value.CreditAmount)-parseFloat(value.DebitAmount);
                        totalAmount=totalAmount+parseFloat(value.Total);
                        totalTax=totalTax+parseFloat(value.TotalTax);
                        totalFees=totalFees+parseFloat(value.TotalFee);
                        totaldebit=totaldebit+parseFloat(value.DebitAmount);
                        totalCredit=totalCredit+parseFloat(value.CreditAmount);

                        tempRow += '<tr>';
                        tempRow += '<td style="text-align: center;font-size: 12px;">' + value.TransactionType + '</td>';
                        tempRow += '<td style="text-align: center;font-size: 12px;"><a onclick="showCInvoiceDetail(' + value.InvoiceId + ')">' + value.InvoiceNo + '</a></td>'
                        tempRow += '<td style="text-align: center;font-size: 12px;">' + formatJSONDateUtc(value.TrxDate) + '</td>'
                        tempRow += '<td style="text-align: center;font-size: 12px;">';

                        if(value.MasterTrxTypeListId=='@Convert.ToInt32(JKApi.Business.Enumeration.MasterTrxTypeList.Chargeback)')
                        {
                            tempRow += '<a onclick="showChargeBackDetail(\'' + value.TransactionNumber + '\')">' + value.TransactionNumber + '</a>';
                        }
                        else if(value.MasterTrxTypeListId=='@Convert.ToInt32(JKApi.Business.Enumeration.MasterTrxTypeList.FranchiseeManualTransaction)')
                        {
                            tempRow += '<a onclick="showFMTDetail(\'' + value.TransactionNumber + '\')">' + value.TransactionNumber + '</a>';
                        }
                        else if(value.MasterTrxTypeListId=='@Convert.ToInt32(JKApi.Business.Enumeration.MasterTrxTypeList.FindersFeeBill)')
                        {
                            tempRow += '<a onclick="showBillDetail(\'' + value.TransactionNumber + '\')">' + value.TransactionNumber + '</a>';
                        }
                        else if (value.MasterTrxTypeListId == 1 || value.MasterTrxTypeListId == 5)
                        {
                            tempRow += '<a onclick="showInvoiceDetail(\'' + value.TransactionNumber + '\')">' + value.TransactionNumber + '</a>';
                        } else {
                            tempRow += value.TransactionNumber;
                        }
                        tempRow +='</td>';

                        tempRow += '<td style="text-align: center;font-size: 12px;">' + value.CustomerNo + '</td>';
                        tempRow += '<td style="text-align: left;font-size: 12px;">' + value.CustomerName + '</td>';
                        tempRow += '<td style="text-align: left;font-size: 12px;">' + value.PayDescription + '</td>';

                        tempRow += '<td style="text-align: right;font-size: 12px;">' + formatCurrency(value.Total, true) + '</td>';
                        tempRow += '<td style="text-align: right;font-size: 12px;">' + formatCurrency(value.TotalTax, true) + '</td>';
                        tempRow += '<td style="text-align: right;font-size: 12px; border-right: 2px solid blue;">' + formatCurrency(value.TotalFee, true) + '</td>';

                        tempRow += '<td style="text-align: right;font-size: 12px; border-left: 2px solid blue;">' + formatCurrency(value.DebitAmount, true)+ '</td>';
                        tempRow += '<td style="text-align: right;font-size: 12px; border-right: 2px solid blue;">' + formatCurrency(value.CreditAmount, true) + '</td>';
                        //tempRow += '<td style="text-align: right;font-size: 12px; border-left: 2px solid blue;">' + formatCurrency(vBalamt, true) + '</td>';
                        tempRow += '<td style="text-align: center;font-size: 12px;">' + value.StatusName + '</td>';
                        tempRow += '</tr>';

                        $(elem).append(tempRow);
                    });


                    $('#totalAmount').text(formatCurrency(totalAmount,true));
                    $('#totalTax').text(formatCurrency(totalTax,true));
                    $('#totalDebit').text(formatCurrency(totaldebit,true));
                    $('#totalCredit').text(formatCurrency(totalCredit,true));
                    $('#totalFees').text(formatCurrency(totalFees,true));
                    $('#totalBalance').text(formatCurrency(vBalamt, true));
                    $.unblockUI();
                },
                error: function () { $.unblockUI(); }

            });
        }

        function btnFranchiseeManualPopupClose() {
            $("#modal_FMTDetail").modal('hide');
        }

        function btnFranchiseeManualEditPopup(transactionNumber, Dateformat) {
            var _Date = new Date(Dateformat);
            var _month = _Date.getMonth() + 1;

            var periodcloseid = $("#ddlPeriodId").val();
            var sURL = '@Url.Action("CheckPeriod", "Franchise", new { area = "Portal" })?PeriodClsId=' + periodcloseid;
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    if (data == _month) {
                        var sURL = '@Url.Action("EditManualTrasaction", "Franchise", new { area = "Portal" })?TrxNo=' + transactionNumber;
                        $.ajax({
                            type: "GET",
                            url: sURL,
                            contentType: "application/json; charset=utf-8",
                            datatype: "json",
                            success: function (data) {
                                $('#Render_EditManualTransaction').html(data);
                                $("#modal_EditManualTransaction").modal({ backdrop: 'static' });
                            },
                            error: function (err) {
                                console.log(err);
                            }
                        });
                    }
                    else {
                        swal(
                            'Transaction Record edit allow only selected Period Month!',
                            '',
                            'error'
                        )
                    }
                },
                error: function (err) {
                    console.log(err);
                }
            });
        }
        function btnFranchiseeManualEditPopupSucess() {
            $("#modal_FMTDetail").modal('hide');
            _bindTrasaction($('#select_transactionstype').val(), $('#spnStartDate').text(), $('#spnEndtDate').text());
        }

        function showInvoiceDetail(Billno) {
            $.blockUI()
            //$("#modal_invoicedetail").modal({ backdrop: 'static' });
            var sURL = '@Url.Action("FranchiseeBillingDetailPopupWithbillno", "AccountsPayable", new { area = "Portal" })?billno=' + Billno;
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    $('#form_FranchiseeBillingDetail').html(data);
                    $("#modal_FranchiseeBillingDetail").modal({ backdrop: 'static' });
                    $("#modal_FranchiseeBillingDetail").draggable();
                    $.unblockUI();
                },
                error: function (err) {
                    $.unblockUI();
                    console.log(err);
                }
            });
        }

        function btnInvoiceWinClose() {
            $("#modal_FranchiseeBillingDetail").modal('hide');
        }

        @*function DetailInvoiceListExportPDF() {
            window.location.href = '@Url.Action("InvoiceListExportPDF")' + "?InvoiceIds=" + @Html.DisplayFor(one => one.);
        }

        function DetailInvoiceListSendEmail() {
            var sURL = '@Url.Action("GetEmailsforSendEmail", "AccountReceivable", new { area = "Portal" })?CustomerId=' + @Html.DisplayFor(one => one.FranchiseeId);
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    var obj = $.parseJSON(data);
                    console.log(obj);
                    $("#invdetail_txtfromemail").val(obj.FromEmail);
                    $("#invdetail_txtccemail").val(obj.CCEmail);
                    $("#modal_invoicedetailEmail").modal('show');
                },
                error: function (err) {
                    console.log(err);
                }
            });
        }


        function DetailInvoiceListPrint(invoiceId) {
            var sURL = '@Url.Action("InvoiceListPrint", "AccountReceivable", new { area = "Portal" })?InvoiceIds=' + @Model.InvoiceDetail.InvoiceId;
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    var tUrl = data;
                    printJS({ printable: document.location.origin + tUrl, type: 'pdf', showModal: false });

                },
                error: function (err) {
                    console.log(err);
                }
            });
        }*@

        var date = new Date(), y = date.getFullYear(), m = date.getMonth();
        var firstDay;
        var lastDay;
        Date.prototype.getWeek = function (start) {
            //Calcing the starting point
            start = start || 0;
            var today = new Date(this.setHours(0, 0, 0, 0));
            var day = today.getDay() - start;
            var date = today.getDate() - day;

            // Grabbing Start/End Dates
            var StartDate = new Date(today.setDate(date));
            var EndDate = new Date(today.setDate(date + 6));
            return [StartDate, EndDate];
        }

        $('#txtStartDate').change(function () {
            $('#spnStartDate').html($(this).val());

            if(@Model.FranchiseeId > 0 &&  $('#txtStartDate').val()!='' &&  $('#txtEndtDate').val()!='')
                _bindTrasaction($('#select_transactionstype').val(), $('#spnStartDate').text(), $('#spnEndtDate').text());
        });
        $('#txtEndtDate').change(function () {
            $('#spnEndtDate').html($(this).val());

            if(@Model.FranchiseeId > 0 &&  $('#txtStartDate').val()!='' &&  $('#txtEndtDate').val()!='')
                _bindTrasaction($('#select_transactionstype').val(), $('#spnStartDate').text(), $('#spnEndtDate').text());
        });

        $('#monthlist').change(function () {
            $('#spnStartDate').html('');
            if ($('#monthlist').val() != '' && $('#yearlist').val() != '')
                _bindTrasaction($('#select_transactionstype').val(), $('#spnStartDate').text(), $('#spnEndtDate').text());
        });

        $('#yearlist').change(function () {
            $('#spnEndtDate').html('');
            if ($('#monthlist').val() != '' && $('#yearlist').val() != '')
                _bindTrasaction($('#select_transactionstype').val(), $('#spnStartDate').text(), $('#spnEndtDate').text());
        });

        $('#select_timeduration').change(function () {
            //alert($(this).val());
            $('#spnStartDate').html('');
            $('#spnEndtDate').html('');
            $('#divspandate').show();
            $('#divSD').hide();
            $('#divED').hide();
            $('#divmonth').hide();
            $('#divyear').hide();
            $('#monthlist').val('');
            $('#yearlist').val('');
            switch (parseInt($(this).val())) {
                case 1:
                    firstDay = moment().startOf('isoWeek').toString();
                    lastDay = moment().endOf('isoWeek').toString();
                    break;
                case 2:
                    //code block
                    firstDay = moment().startOf('isoWeek').toString();
                    lastDay = new Date().toString();
                    break;
                case 3:
                    firstDay = moment().subtract(0, 'month').startOf('month').toString();
                    lastDay = moment().subtract(0, 'month').endOf('month').toString();
                    break;
                case 4:
                    //code block
                    firstDay = moment().subtract(0, 'month').startOf('month').toString();
                    lastDay = new Date().toString();
                    break;
                case 5:
                    //code block
                    firstDay = moment().startOf('quarter').toString();
                    lastDay = moment().endOf('quarter').toString();
                    break;
                case 6:
                    //code block
                    firstDay = moment().startOf('quarter').toString();
                    lastDay = new Date().toString();
                    break;
                case 7:
                    //code block
                    firstDay = moment().startOf('year').toString();;
                    lastDay = moment().endOf('year').toString();
                    break;
                case 8:
                    //code block
                    firstDay = moment().startOf('year').toString();
                    lastDay = new Date().toString();
                    break;
                case 9:
                    //code block
                    firstDay = moment().toString();
                    lastDay = moment().toString();
                    break;
                case 10:
                    //code block
                    firstDay = moment().add(-1, 'days').toString();
                    lastDay = moment().add(-1, 'days').toString();
                    break;
                case 11:
                    //code block
                    firstDay = moment().subtract(1, 'week').startOf('week').toString();
                    lastDay = moment().subtract(1, 'week').endOf('week').toString();
                    break;
                case 12:
                    //code block
                    firstDay = moment().subtract(1, 'month').startOf('month').toString();
                    lastDay = moment().subtract(1, 'month').endOf('month').toString();
                    break;
                case 13:
                    //code block
                    firstDay = moment().subtract(1, 'quarter').startOf('quarter').toString();
                    lastDay = moment().subtract(1, 'quarter').endOf('quarter').toString();
                    break;
                case 14:
                    //code block
                    firstDay = moment().subtract(1, 'year').startOf('year').toString();
                    lastDay = moment().subtract(1, 'year').endOf('year').toString();
                    break;
                case 15:
                    //code block
                    $('#divspandate').hide();
                    $('#divSD').show();
                    $('#divED').show();
                    $('#txtStartDate').val('');
                    $('#txtEndtDate').val('')
                    break;
                case 16:
                    //code block
                    $('#divspandate').hide();
                    $('#divSD').hide();
                    $('#divED').hide();
                    $('#divmonth').show();
                    $('#divyear').show();
                    break;
                default:
                    //code block
            }
            $('#spnStartDate').html(moment(firstDay).format('L'));
            $('#spnEndtDate').html(moment(lastDay).format('L'));

            if(parseInt($(this).val())!=15 && parseInt($(this).val())!=16)
                _bindTrasaction($('#select_transactionstype').val(), moment(firstDay).format('L'), moment(lastDay).format('L'));
        });

        function formatCurrency(total, dollar) {
            dollar = (dollar == true ? true : false);
            var neg = false;
            if (total < 0) {
                neg = true;
                total = Math.abs(total);
            }
            return (neg ? "-" : '') + (dollar ? "$" : "") + parseFloat(total, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString();
        }
        function OnclickPlanInfo(Id)
        {
            var sURL = '@Url.Action("MaintenanceStepFour", "Franchise", new { area = "Portal" })?Id=' + Id;
            window.location.href = sURL;
        }

        function redirect(id) {
            var url = '@Url.Action("Franchiseedetail", "Franchise", new { area = "Portal", id =  -1})';
            var path = url.replace("-1", id);
            location.href = path;
        }

        var editFranchiseeDistribution = function () {

            $(".editvalue").addClass("editvaluetext");
            $(".editvalue").removeClass("editmode");
            $("#btnSaveDistribution").show();
            $("#btnEditDistribution").hide();
            $(".editvalue").removeAttr("disabled").removeAttr("readonly");
            $(".editcheck").removeAttr("disabled").removeAttr("readonly");
        };

        var saveFranchiseeDistribution = function () {
            //if (!ValidatefrenchiseeData()) {
            //    return false;
            //}
            //else { //$("#modal_FranchiseeDistribution").modal({ backdrop: 'static' });


            $(".editvalue").removeClass("editvaluetext");
            $(".editvalue").addClass("editmode");
            $("#btnSaveDistribution").hide();
            $("#btnEditDistribution").show();
            $(".editvalue").attr("readonly", "readonly");
            $(".editcheck").attr("disabled", "disabled");
            $(".editcheck").attr("readonly", "readonly");
            $.blockUI()
            $.ajax({
                url: '@Url.Action("SaveFrenchiseeDistribution", "Customer","Portal")',
                type: "POST",
                data: $('#submit_form_distributioncustomer').serialize(),
                success: function (res) {
                    $('#modal_FranchiseeDistribution').modal('hide');
                    $.unblockUI();
                },
                error: function () { $.unblockUI() }
            });
            //}

        };

        function FranchiseeReport(id) {
            var _billMonthYear = $("#select_BillMonthYearList :selected").val();
            var _billMonth = _billMonthYear.split('/')[0];
            var _billYear = _billMonthYear.split('/')[1];
            @*var sURL = '@Url.Action("FinalizedFranchiseeReport", "Franchise", new { area = "Portal" })?frId=' + @Html.DisplayFor(one => one.FranchiseeId) + '&month=' + _billMonth + '&year=' + _billYear;
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    OpenPopup(data);
                },
                error: function (err) {
                    console.log(err);
                }
            });*@


            $("#select_BillMonthYearList").val($("#select_BillMonthYearList option:first").val());
            $('#ModalFranchiseePayReportPopupInnerDiv').hide()
            $("#ModalFranchiseePayReportPopup").modal({ backdrop: 'static' });
        }


        $("#select_BillMonthYearList").change(function () {
            var _billMonthYear = $("#select_BillMonthYearList :selected").val();
            var _billMonth = _billMonthYear.split('/')[0];
            var _billYear = _billMonthYear.split('/')[1];
            var sURL = '@Url.Action("FinalizedFranchiseeReport", "Franchise", new { area = "Portal" })?frId=' + @Html.DisplayFor(one => one.FranchiseeId) + '&month=' + _billMonth + '&year=' + _billYear;
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    OpenPopup(data);
                },
                error: function (err) {
                    console.log(err);
                }
            });

        });

        function OpenPopup(data) {
            if (data.Data != null) {
                $("#ModelPeriod").modal('hide');
                OpenPayReportPopup(data.Data.FranchiseeReportFinalizedId);

            } else {
                $('#ModalFranchiseePayReportPopupInnerDiv').hide();
                $("#ModalFranchiseePayReportPopup").modal({ backdrop: 'static' });
            }
        }

        function OpenPayReportPopup(Id) {
            var sURL = '@Url.Action("FranchiseePayReportPopupDetailFinalized", "AccountsPayable", new { area = "Portal" })?ids=' + Id

            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {

                    $('#RenderFranchiseePayReportDetails').html(data);
                    $('#ModalFranchiseePayReportPopupInnerDiv').show();
                    $("#ModalFranchiseePayReportPopup").modal({ backdrop: 'static' });
                },
                error: function (err) {
                    console.log(err);
                }
            });

        }

        function FranchiseeDistribution(id) {
            $.blockUI()
            var sURL = '@Url.Action("DetailFranchiseeDistribution", "Franchise", new { area = "Portal" })?Id=' + id;
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    $('#form_FranchiseeDistribution').html(data);

                    $(".editvalue").removeClass("editvaluetext");
                    $(".editvalue").addClass("editmode");
                    $(".editvalue").attr("readonly", "readonly");
                    $("#btnSaveDistribution").hide();
                    $("#btnEditDistribution").show();
                    $(".editcheck").attr("disabled", "disabled");
                    $(".editcheck").attr("readonly", "readonly");

                    FranchiseeDistributionData(id);
                    bindcustomerDetailDisLoad(id);
                    $('.modal-dialog').draggable();
                    $.unblockUI();
                },
                error: function (err) {
                    console.log(err);
                    $.unblockUI();
                }
            });


        }

        function DetailListPrint() {
            $.blockUI()
            var sURL = '@Url.Action("FFDetailListPrint", "Franchise", new { area = "Portal" })?id=@Html.DisplayFor(one => one.FranchiseeId)';
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    var tUrl = data;
                    printJS({ printable: document.location.origin + tUrl, type: 'pdf', showModal: false });
                    $.unblockUI();
                },
                error: function (err) {
                    console.log(err);
                    $.unblockUI();
                }
            });
        }

        function DetailListExportPDF() {
            $.blockUI();
            window.location.href = '@Url.Action("FFDetailListExportPDF", "Franchise", new { area = "Portal" })?id=@Html.DisplayFor(one => one.FranchiseeId)';
            $.unblockUI();
        }
        var tempRowDistribution = "";
        var tempRowLineNo = 0;
        var tempFRowLineNo = 0;
        function FranchiseeDistributionData(id) {
            $.blockUI()
            $('#hdffrenchiseedetail_customerid').val(id);
            var sURL = '@Url.Action("FranchiseeDistributionData", "Customer", new { area = "Portal" })?Id=' + id;
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {

                    $('#hdfdistributioncustomerid').val(data.CustomerId);
                    $('#spnCustomerName').html(data.CustomerName);
                    $('#spnCustomerNo').html(data.CustomerNo);



                    $('#tblFranchiseeDistributionList>tbody').html('');
                    $.each(data.lstContractDetail, function (index, value) {
                        tempRowLineNo = value.LineNumber;
                        tempRow = "";
                        tempRow += '<tr><td style="width:20px;text-align:center;">'
                        tempRow += '<input type="hidden" id="ContractDetailLineNo_' + tempRowLineNo + '" name="ContractDetailLineNo_' + tempRowLineNo + '" value="' + tempRowLineNo + '" />'
                        tempRow += '<input type="hidden" id="ContractDetailId_' + tempRowLineNo + '" name="ContractDetailId_' + tempRowLineNo + '" value="' + value.ContractDetailId + '" />'
                        tempRow += '<input type="hidden" id="ContractDetailServiceId_' + tempRowLineNo + '" name="ContractDetailServiceId_' + tempRowLineNo + '" value="' + value.ServiceTypeListId + '" />'
                        tempRow += '<input type="hidden" id="ContractDetailAmount_' + tempRowLineNo + '" name="ContractDetailAmount_' + tempRowLineNo + '" value="' + value.Amount + '" />'
                        tempRow += tempRowLineNo + '</td>';
                        tempRow += '<td style="text-align:left;width:140px;">' + value.ServiceTypeName + '</td>';
                        tempRow += '<td style="text-align:center;width:30px;">$<span id="cd_amount_' + tempRowLineNo + '">' + value.Amount + '</span></td>';
                        tempRow += '<td style="text-align:center;width:50px;">' + value.FrequencyName + '</td>';
                        tempRow += '<td style="text-align:center;width:30px;"><a href="javascript:void(0);" onclick="Franchiseeservice(' + value.Mon + ',' + value.Tues + ',' + value.Wed + ',' + value.Thur + ',' + value.Fri + ',' + value.Sat + ',' + value.Sun + ')">View</a></td></tr>';

                        tempRow += '<tr><td colspan="5" style="padding:5px;"><div class="table-responsive">';
                        tempRow += '<table class="table table-striped table-bordered table-hover order-column" id="FranchiseeDistributionDetailList_' + tempRowLineNo + '">';
                        tempRow += '<thead><tr><td colspan="3" style="padding:0;"><div class="input-icon left"><i class="icon-magnifier" style="margin: 6px 2px 4px 10px;"></i>';
                        tempRow += '<input autocomplete="off" type="text" id="fsearch-box_' + tempRowLineNo + '" name="fsearch-box_' + tempRowLineNo + '" value="" placeholder="Search Franchisee Number or Name" class="form-control input-sm" style="border-radius:0px;z-index:10000;" /></div></td></tr>';
                        tempRow += '<tr><th style="width:20px;text-align:center;">Number</th>';
                        tempRow += '<th style="width:242px;text-align:center;">Franchisee Name</th>';
                        tempRow += '<th style="width:30px;text-align:center;">Amount</th></tr></thead><tbody>';
                        tempRow += '</tbody></table></div></td></tr>';


                        $('#tblFranchiseeDistributionList>tbody').append(tempRow);
                        if (data.lstDistribution.length > 0) {

                            $.each(data.lstDistribution, function (indexd, valueD) {
                                if (value.ContractDetailId == valueD.ContractDetailId) {
                                    tempFRowLineNo++;
                                    tempRowDistribution = "";
                                    tempRowDistribution += '<tr><td style="width:20px;text-align:center;">'
                                    tempRowDistribution += '<input type="hidden" id="FranchiseeDistributionFranchiseeId_' + tempRowLineNo + '_' + tempFRowLineNo + '" name="FranchiseeDistributionFranchiseeId_' + tempRowLineNo + '_' + tempFRowLineNo + '" value="' + valueD.FranchiseeId + '" />';
                                    tempRowDistribution += '<input type="hidden" id="FranchiseeDistributionContractDetailId_' + tempRowLineNo + '_' + tempFRowLineNo + '" name="FranchiseeDistributionContractDetailId_' + tempRowLineNo + '_' + tempFRowLineNo + '" value="' + valueD.ContractDetailId + '" />';
                                    tempRowDistribution += '<input type="hidden" id="FranchiseeDistributionDetailId_' + tempRowLineNo + '_' + tempFRowLineNo + '" name="FranchiseeDistributionDetailId_' + tempRowLineNo + '_' + tempFRowLineNo + '" value="' + valueD.FranchiseeId + '" /><span>' + valueD.FranchiseeNo + '</span></td>';
                                    tempRowDistribution += '<td style="text-align:center;width:242px;">' + valueD.FranchiseeName + '</td>';
                                    tempRowDistribution += '<td style="text-align:center;width:30px;"><input type="text" rel="ContractDetailAmount_' + tempRowLineNo + '" value="' + valueD.Amount + '" class="form-control input-sm editvalue" id="FranchiseeDistributionAmountId_' + tempRowLineNo + '_' + tempFRowLineNo + '" name="FranchiseeDistributionAmountId_' + tempRowLineNo + '_' + tempFRowLineNo + '" style="margin-top:-6px;margin-bottom: -6px;" /></td>';
                                    tempRowDistribution += '</tr>'
                                    $('#FranchiseeDistributionDetailList_' + tempRowLineNo + '>tbody').append(tempRowDistribution);

                                    applyMaskCurrency('#FranchiseeDistributionAmountId_' + tempRowLineNo + '_' + tempFRowLineNo);
                                }
                            });
                        }
                        bindfrenchiseelistbox(tempRowLineNo);
                    });

                    $("#hdfcontractdetail_linecount").val(tempRowLineNo);
                    $("#hdffrenchiseedetail_linecount").val(tempFRowLineNo);

                    $("#modal_FranchiseeDistribution").modal({ backdrop: 'static' });

                    $(".editvalue").removeClass("editvaluetext");
                    $(".editvalue").addClass("editmode");
                    $("#btnSaveDistribution").hide();
                    $("#btnEditDistribution").show();
                    $(".editvalue").attr("readonly", "readonly");
                    $(".editcheck").attr("disabled", "disabled");
                    $(".editcheck").attr("readonly", "readonly");
                    $.unblockUI();
                },
                error: function (err) {
                    console.log(err);
                    $.unblockUI();
                }
            });

        }
        var typeaheadSource = [];



        function bindfrenchiseelistbox(lineno) {
            $("#fsearch-box_" + lineno).autocomplete({
                source: typeaheadSource,
                appendTo: $("#tblFranchiseeDistributionList"),
                select: function (event, ui) {
                    event.preventDefault();
                    tempFRowLineNo++;
                    tempRowDistribution = "";
                    tempRowDistribution += '<tr><td style="width:20px;text-align:center;">'
                    tempRowDistribution += '<input type="hidden" id="FranchiseeDistributionFranchiseeId_' + lineno + '_' + tempFRowLineNo + '" name="FranchiseeDistributionFranchiseeId_' + lineno + '_' + tempFRowLineNo + '" value="' + ui.item.value + '" />';
                    tempRowDistribution += '<input type="hidden" id="FranchiseeDistributionContractDetailId_' + lineno + '_' + tempFRowLineNo + '" name="FranchiseeDistributionContractDetailId_' + lineno + '_' + tempFRowLineNo + '" value="' + $("#ContractDetailId_" + lineno).val() + '" />';
                    tempRowDistribution += '<input type="hidden" id="FranchiseeDistributionDetailId_' + lineno + '_' + tempFRowLineNo + '" name="FranchiseeDistributionDetailId_' + lineno + '_' + tempFRowLineNo + '" value="' + ui.item.value + '" /><span>' + ui.item.label.split(' ')[0] + '</span></td>';
                    tempRowDistribution += '<td style="text-align:center;width:242px;">' + ui.item.label.replace(ui.item.label.split(' ')[0], "").trim() + '</td>';
                    tempRowDistribution += '<td style="text-align:center;width:30px;"><input type="text" rel="ContractDetailAmount_' + lineno + '" value="' + $("#ContractDetailAmount_" + lineno).val() + '" class="form-control input-sm editvalue" id="FranchiseeDistributionAmountId_' + lineno + '_' + tempFRowLineNo + '" name="FranchiseeDistributionAmountId_' + lineno + '_' + tempFRowLineNo + '" style="margin-top:-6px;margin-bottom: -6px;" /></td>';
                    tempRowDistribution += '</tr>'
                    $('#FranchiseeDistributionDetailList_' + lineno + '>tbody').append(tempRowDistribution);
                    applyMaskCurrency('#FranchiseeDistributionAmountId_' + tempRowLineNo + '_' + tempFRowLineNo);
                    $("#fsearch-box_" + lineno).val("");
                    console.log(ui.item.label);
                    console.log(ui.item.value);

                    $("#hdffrenchiseedetail_linecount").val(tempFRowLineNo);
                }
            });


        }
        function ValidatefrenchiseeData() {

            var isNotValidForm = true;
            if (tempRowLineNo > 0) {
                for (var i = 1; i <= tempRowLineNo; i++) {
                    var cdAmount = parseFloat($('#cd_amount_' + i).html());
                    var cdFAmount = 0;
                    $('input[rel="ContractDetailAmount_' + i + '"]').each(function (i) {
                        cdFAmount += parseFloat(this.value);

                        if (parseFloat(this.value) == 0) {
                            this.style.border = "1px solid red";
                            isNotValidForm = false;
                        }
                        else
                            this.style.border = "1px solid #c2cad8";
                    });
                    var isNotValid = true;
                    if (cdAmount != cdFAmount) {
                        isNotValid = false;
                    }

                    $('input[rel="ContractDetailAmount_' + i + '"]').each(function (i) {
                        if (!isNotValid || parseFloat(this.value) == 0) {
                            this.style.border = "1px solid red";
                            isNotValidForm = false;
                            isNotValid = false;
                        }
                        else
                            this.style.border = "1px solid #c2cad8";
                    });
                }

                return isNotValidForm;
            }
            return false;
        }
        function bindcustomerDetailDisLoad(customerid) {

        }
        function Franchiseeservice(mo, tu, we, th, fr, sa, su) {

            $("#chkScheduleMonday").prop('checked', false);
            $("#chkScheduleTuesday").prop('checked', false);
            $("#chkScheduleWednesday").prop('checked', false);
            $("#chkScheduleThursday").prop('checked', false);
            $("#chkScheduleFriday").prop('checked', false);
            $("#chkScheduleSaturday").prop('checked', false);
            $("#chkScheduleSunday").prop('checked', false);


            if (mo == 1)
                $("#chkScheduleMonday").prop('checked', true);
            if (tu == 1)
                $("#chkScheduleTuesday").prop('checked', true);
            if (we == 1)
                $("#chkScheduleWednesday").prop('checked', true);
            if (th == 1)
                $("#chkScheduleThursday").prop('checked', true);
            if (fr == 1)
                $("#chkScheduleFriday").prop('checked', true);
            if (sa == 1)
                $("#chkScheduleSaturday").prop('checked', true);
            if (su == 1)
                $("#chkScheduleSunday").prop('checked', true);




            $("#modal_service").modal({ backdrop: 'static' });
        }
        //function onlyDecimal(id) {
        //    $(id).keydown(function (event) {
        //        if (event.shiftKey == true) { event.preventDefault(); }
        //        if ((event.keyCode >= 48 && event.keyCode <= 57) || (event.keyCode >= 96 && event.keyCode <= 105) || event.keyCode == 8 || event.keyCode == 9 || event.keyCode == 37 || event.keyCode == 39 || event.keyCode == 46 || event.keyCode == 190 || event.keyCode == 110) { }
        //        else { event.preventDefault(); }
        //        if ($(this).val().indexOf('.') !== -1 && (event.keyCode == 190 || event.keyCode == 110)) event.preventDefault();
        //    });
        //}
        function OnlyNumber(id) {
            $(id).keydown(function (event) {
                if (event.shiftKey == true) { event.preventDefault(); }
                if ((event.keyCode >= 48 && event.keyCode <= 57) || (event.keyCode >= 96 && event.keyCode <= 105) || event.keyCode == 8 || event.keyCode == 9 || event.keyCode == 37 || event.keyCode == 39 || event.keyCode == 46) { }
                else { event.preventDefault(); }
            });
        }
        function applyMaskCurrency(id) {
            $(id).inputmask("currency", {
                alias: 'currency',
                prefix: '$ ',
                digits: 2,
                autoUnmask: true,
                removeMaskOnSubmit: true,
                unmaskAsNumber: true,
                allowPlus: false,
                allowMinus: false,
                autoGroup: true,
                groupSeparator: ",",
            });
        }

        function OpenEditFranchisePopup(Id) {
            $.blockUI()
            var sURL = '@Url.Action("RenderEditFranchiseDetailsPopup", "Franchise", new { area = "Portal" })?id=' + Id;

            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    $('#RenderEditFranchiseDetails').html(data);
                    $("#ModalEditFranchisePopup").modal({ backdrop: 'static' });
                    $.unblockUI();
                },
                error: function (err) {
                    console.log(err);
                    $.unblockUI();
                }
            });

            //$("#modal_CustomerContractPopup").modal({ backdrop: 'static' });
        }

        function OpenEditFranchisePlanInfoPopup(Id) {
            $.blockUI()
            var sURL = '@Url.Action("RenderEditFranchiseFourStepPopup", "Franchise", new { area = "Portal" })?id=' + Id;

            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    $('#RenderEditFranchiseFourStepDetails').html(data);
                    $(".date-picker").datepicker();
                    $("#ContractInfo_DateSign").datepicker();
                    $("#ContractInfo_LastRenewedContractDate").datepicker();
                    //$("#ContractInfo_ExpireDate").datepicker();
                    $("#ContractInfo_StartDate").datepicker();
                    $("#ContractInfo_LegalObligationStartDate").datepicker();
                    $("#ContractInfo_LegalObligationEndDate").datepicker();
                    $(".input-group-btn").click(function () {
                        $(this).prev().trigger("focus");
                        $(this).prev().trigger("focus");
                    });
                    $("#ModalEditFranchiseFourStepPopup").modal({ backdrop: 'static' });
                    $.unblockUI();
                },
                error: function (err) {
                    console.log(err);
                    $.unblockUI();
                }
            });

            //$("#modal_CustomerContractPopup").modal({ backdrop: 'static' });
        }

        function OpenFranchiseeActivityPopup() {
            $("#modal_FranchiseeActivityPopup").modal('show');
        }

        function btnFeeDetailOpen(id) {
            $("#txtdetailinput_Search").val("");
            _franchiseeId = id;
            $("#ddlStatusDetail").val(31);
            $("#ddlStatusDetail").multiselect("refresh");
            btnOpenDeatilBind();
        }

        $("#txtdetailinput_Search").keyup(function () {
            var strSearch = $("#txtdetailinput_Search").val()
            $.blockUI();
            $('#tblFFDetailList tbody').html('');

            var spnFF_TotalFinderFee = 0.00;
            var spnFF_TotalDownPayment = 0.00;
            var spnFF_TotalMonthlyPayment = 0.00;
            var spnFF_TotalPaid = 0.00;
            var spnFF_Balance = 0.00;

            var resultFFDetail = $.grep(_FFDetail, function (e) {

                return (e.CustomerNo.toUpperCase().indexOf(strSearch.toUpperCase()) > -1
                    || e.CustomerName.toUpperCase().indexOf(strSearch.toUpperCase()) > -1
                    || e.TotalNumOfpayments.toString().toUpperCase().indexOf(strSearch.toUpperCase()) > -1
                    || e.TotalFinderFee.toString().toUpperCase().indexOf(strSearch) > -1
                    || e.TotalDownPayment.toString().toUpperCase().indexOf(strSearch.toUpperCase()) > -1
                    || e.MonthlyPaymentAmount.toString().toUpperCase().indexOf(strSearch.toUpperCase()) > -1
                    || e.PaidAmount.toString().toUpperCase().indexOf(strSearch.toUpperCase()) > -1
                    || e.TotalBalance.toString().toUpperCase().indexOf(strSearch.toUpperCase()) > -1
                    || e.FindersFeeTypeListName.toUpperCase().indexOf(strSearch.toUpperCase()) > -1);
            });

            resultFFDetail.forEach(function (item) {

                $('#spnFF_FranchiseeNo').html(item.FranchiseeNo);
                $('#spnFF_FranchiseeName').html(item.FranchiseeName);

                $('#hddFF_FranchiseeId').val(item.FranchiseeId);


                spnFF_TotalFinderFee += parseFloat(item.TotalFinderFee);
                spnFF_TotalDownPayment += parseFloat(item.TotalDownPayment);
                spnFF_TotalMonthlyPayment += parseFloat(item.MonthlyPaymentAmount);
                spnFF_TotalPaid += parseFloat(item.PaidAmount);
                spnFF_Balance += parseFloat(item.TotalBalance);
                trInvoicelist = "";
                trInvoicelist += '<tr><td style="text-align:center;">' + item.CustomerNo + '</td>';
                trInvoicelist += '<td style="text-align:left;">' + item.CustomerName + '</td>';
                trInvoicelist += '<td style="text-align:left;">' + item.FindersFeeTypeListName + '</td>';
                trInvoicelist += '<td style="text-align:center;"></td>';//moment(new Date(parseInt(item.StartTime.substr(6)))).format("MM/DD/YYYY")
                trInvoicelist += '<td style="text-align:center;">' + moment(new Date(parseInt(item.StartDate.substr(6)))).format("MM/DD/YYYY") + '</td>';
                trInvoicelist += '<td style="text-align:center;">' + item.NumOfPaymentsPaid + '</td>';
                trInvoicelist += '<td style="text-align:center;">' + item.TotalNumOfpayments + '</td>';
                trInvoicelist += '<td style="text-align:right;">$' + parseFloat(item.TotalFinderFee, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';
                trInvoicelist += '<td style="text-align:right;">$' + parseFloat(item.TotalDownPayment, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';
                trInvoicelist += '<td style="text-align:right;">$' + parseFloat(item.MonthlyPaymentAmount, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';
                trInvoicelist += '<td style="text-align:right;">$' + parseFloat(item.PaidAmount, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';
                trInvoicelist += '<td style="text-align:right;">$' + parseFloat(item.TotalBalance, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td></tr>';

                $('#tblFFDetailList tbody').append(trInvoicelist);
            });


            $('#spnFF_TotalFinderFee').html(spnFF_TotalFinderFee.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString())
            $('#spnFF_TotalDownPayment').html(spnFF_TotalDownPayment.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString())
            $('#spnFF_TotalMonthlyPayment').html(spnFF_TotalMonthlyPayment.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString())
            $('#spnFF_TotalPaid').html(spnFF_TotalPaid.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString())
            $('#spnFF_Balance').html(spnFF_Balance.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString())

            $.unblockUI();

        });


        var _FFDetail = [];
        function btnOpenDeatilBind() {

            $.blockUI()
            $('#tblFFDetailList tbody').html('');

            $.ajax({
                type: "GET",
                url: '@Url.Action("FinderFeeDetailListData", "Franchise", new { area = "Portal" })?frenchiseid=' + _franchiseeId + '&?regionIds=' + $("#regionlist").val() + '&statusIds=' + ($("#ddlStatusDetail").val()!=null?$("#ddlStatusDetail").val():''),
                success: function (data) {
                    _FFDetail = data;

                    var spnFF_TotalFinderFee = 0.00;
                    var spnFF_TotalDownPayment = 0.00;
                    var spnFF_TotalMonthlyPayment = 0.00;
                    var spnFF_TotalPaid = 0.00;
                    var spnFF_Balance = 0.00;


                    data.forEach(function (item) {

                        $('#spnFF_FranchiseeNo').html(item.FranchiseeNo);
                        $('#spnFF_FranchiseeName').html(item.FranchiseeName);

                        $('#hddFF_FranchiseeId').val(item.FranchiseeId);


                        spnFF_TotalFinderFee += parseFloat(item.TotalFinderFee);
                        spnFF_TotalDownPayment += parseFloat(item.TotalDownPayment);
                        spnFF_TotalMonthlyPayment += parseFloat(item.MonthlyPaymentAmount);
                        spnFF_TotalPaid += parseFloat(item.PaidAmount);
                        spnFF_Balance += parseFloat(item.TotalBalance);
                        trInvoicelist = "";
                        //trInvoicelist += '<td style="text-align:left;">' + item.FranchiseeId + '</td>';
                        //trInvoicelist += '<td style="text-align:left;">' + item.FranchiseeNo + '</td>';
                        //trInvoicelist += '<td style="text-align:left;">' + item.FranchiseeName + '</td>';
                        //trInvoicelist += '<td style="text-align:left;">' + item.CustomerId + '</td>';
                        //trInvoicelist += '<td style="text-align:left;">' + item.FindersFeeTypeListId + '</td>';
                        //trInvoicelist += '<td style="text-align:left;">' + item.RegionId + '</td>';
                        trInvoicelist += '<tr><td style="text-align:center;">' + item.CustomerNo + '</td>';
                        trInvoicelist += '<td style="text-align:left;">' + item.CustomerName + '</td>';
                        trInvoicelist += '<td style="text-align:left;">' + item.FindersFeeTypeListName + '</td>';
                        trInvoicelist += '<td style="text-align:right;">$' + parseFloat(item.ContractBillingAmount, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';//moment(new Date(parseInt(item.StartTime.substr(6)))).format("MM/DD/YYYY")
                        trInvoicelist += '<td style="text-align:center;">' + moment(new Date(parseInt(item.StartDate.substr(6)))).format("MM/DD/YYYY") + '</td>';
                        trInvoicelist += '<td style="text-align:center;">' + item.NumOfPaymentsPaid + '</td>';
                        trInvoicelist += '<td style="text-align:center;">' + item.TotalNumOfpayments + '</td>';
                        trInvoicelist += '<td style="text-align:right;">$' + parseFloat(item.TotalFinderFee, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';
                        trInvoicelist += '<td style="text-align:right;">$' + parseFloat(item.TotalDownPayment, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';
                        trInvoicelist += '<td style="text-align:right;">$' + parseFloat(item.MonthlyPaymentAmount, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';
                        trInvoicelist += '<td style="text-align:right;">$' + parseFloat(item.PaidAmount, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';
                        trInvoicelist += '<td style="text-align:right;">$' + parseFloat(item.TotalBalance, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';
                        trInvoicelist += '<td style="text-align:center;">' + item.Status + '</td>';
                        trInvoicelist += '<td style="text-align:center;">' + (item.StatusDate!=null?moment(new Date(parseInt(item.StatusDate.substr(6)))).format("MM/DD/YYYY"):'') + '</td></tr>';

                        $('#tblFFDetailList tbody').append(trInvoicelist);
                    });


                    $('#spnFF_TotalFinderFee').html(spnFF_TotalFinderFee.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString())
                    $('#spnFF_TotalDownPayment').html(spnFF_TotalDownPayment.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString())
                    $('#spnFF_TotalMonthlyPayment').html(spnFF_TotalMonthlyPayment.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString())
                    $('#spnFF_TotalPaid').html(spnFF_TotalPaid.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString())
                    $('#spnFF_Balance').html(spnFF_Balance.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString())



                    $("#modal_FeeReport").modal('show');
                    $.unblockUI();
                }
            });

        }

        //Finderfee Detail Popup
        function OpenFranchiseFinderFeeDetailPopup(Id) {
            $('#form_finderfeedetail').html('');
            $.blockUI()
            var sURL = '@Url.Action("FinderFeeDetailDataPopup", "Franchise", new { area = "Portal" })?id=' + Id;
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    $('#form_finderfeedetail').html(data);
                    $.unblockUI();
                    $("#modal_FranchiseeFinderFeeDetailPopup").modal({ backdrop: 'static' });
                },
                error: function (err) {
                    console.log(err);
                    $.unblockUI();
                }
            });
        }
        var c_typeaheadSource = [];
        function OpenFranchiseDistributionPopup(Id) {
            $.blockUI()
            var sURL = '@Url.Action("RenderFranchiseDistributionDetailPopup", "Franchise", new { area = "Portal" })?id=' + Id;
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    $('#form_FranchiseDistributionPopup').html(data);
                    $("#ModalFranchiseDistributionPopup").modal({ backdrop: 'static' });

                    $.ajax({
                        type: "GET",
                        url: '@Url.Action("GetAllCustomerdata", "AccountReceivable", new { area = "Portal" })',
                        data: {},
                        success: function (data) {

                            $.each(data, function (key, value) {
                                c_typeaheadSource.push({ id: value.CustomerId, name: value.CustomerNo + ' ' + $.trim(value.Name) })
                            });


                        }
                    });
                    $.unblockUI();
                },
                error: function (err) {
                    console.log(err);
                    $.unblockUI();
                }
            });
            //$("#modal_CustomerContractPopup").modal({ backdrop: 'static' });
        }
        function showServiceLog(Id) {

            var sURL = '@Url.Action("FranchiseServiceCallLogPopup", "Franchise", new { area = "Portal" })?id=' + Id;
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    $('#Render_ServiceCallLogDetails').html(data);
                    $("#modal_ServiceCallLog").modal({ backdrop: 'static' });
                },
                error: function (err) {
                    console.log(err);
                }
            });

        }
        function showCollectionsCallLog(Id)
        {
            var sURL = '@Url.Action("FranchiseCollectionsCallLogPopup", "Franchise", new { area = "Portal" })?id=' + Id;
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    $('#Render_CollectionsCallLogDetails').html(data);
                    $("#modal_CollectionsCallLog").modal({ backdrop: 'static' });
                },
                error: function (err) {
                    console.log(err);
                }
            });
        }

        function showCreditTransaction(Id) {
            if (Id != 0)
            {
                var sURL = '@Url.Action("PartialFranchiseeCredit", "Franchise", new { area = "Portal" })';
                $.ajax({
                    type: "GET",
                    url: sURL,
                    contentType: "application/json; charset=utf-8",
                    datatype: "json",
                    success: function (data) {
                        $('#Render_FranchiseeCredit').html(data);
                        $(".input-group-btn").click(function () {
                            $(this).prev().trigger("focus");
                            $(this).prev().trigger("focus");
                        });
                        $("#modal_FranchiseeCredit").modal({ backdrop: 'static' });



                        $.ajax({
                            type: "GET",
                            url: '@Url.Action("FranchiseDetailAutoComplete", "Franchise", new { area = "Portal" })?franchiseid=' + Id,
                            success: function (res) {
                                console.log(res);

                                $('#hdfTaxRate').val(res.ContractTaxRate);
                                $('#hdfFranchiseeId').val(res.FranchiseeId);
                                $('#spnFranchiseeNumber').html(res.FranchiseeNo);
                                $('#spnFranchiseeName').html(res.Name);
                                $('#spnFranchiseeAddress').html(res.Address1);
                                $('#spnFranchiseeCityStatePincode').html(res.City + ', ' + res.StateName + ' ' + res.PostalCode);
                            }
                        });

                        //$(".date-picker").datepicker({ autoclose: true });
                        //$("#rdoCreditSingle").prop("checked", true);
                        //$("#divRecc").hide();
                        //$("#divReccNP").hide();
                        //$("#divReccVL").hide();
                        //$("#rdoCreditSingle").change(function () {
                        //    if (this.value == 1) {
                        //        $("#rdoCreditSingle").prop("checked", true);
                        //        $("#rdoCreditRecurring").prop("checked", false);
                        //        $("#divRecc").hide();
                        //        $("#divRecNP").hide();
                        //        $("#StartDate").prop("required", false);
                        //        $("#divReccNumOfPayments").hide();
                        //    }
                        //});
                        //applyMaskCurrency($("#ItemAmount"));
                        //applyMaskCurrency($("#Subtotal"));
                        //applyMaskCurrency($("#Total"));
                        //applyMaskCurrency($("#GrossTotal"));
                        //$("#rdoCreditRecurring").change(function () {
                        //    if (this.value == 0) {
                        //        $("#rdoCreditSingle").prop("checked", false);
                        //        $("#rdoCreditRecurring").prop("checked", true);
                        //        $("#divRecc").show();
                        //        $("#divReccNP").show();
                        //        $("#StartDate").prop("required", true);
                        //        $("#divReccNumOfPayments").show();
                        //    }
                        //});

                        //$("#rdoCreditSingle").change(function () {
                        //    if (this.value == 1) {
                        //        $("#rdoCreditSingle").prop("checked", true);
                        //        $("#rdoCreditRecurring").prop("checked", false);
                        //        $("#divRecc").hide();
                        //        $("#divReccNP").hide();
                        //    }
                        //});

                        //$("#rdoCreditRecurring").change(function () {
                        //    if (this.value == 0) {
                        //        $("#rdoCreditSingle").prop("checked", false);
                        //        $("#rdoCreditRecurring").prop("checked", true);
                        //        $("#divRecc").show();
                        //        $("#divReccNP").show();
                        //    }
                        //});
                        //$('#CreditFranchiseeTransactionTypeListId').change(function () {
                        //    if (this.value == 16) {
                        //        $("#divReccVL").show();
                        //    }
                        //});
                        //$('#chkCreditResale').change(function () {
                        //    if ($(this).is(":checked") || $('#CreditFranchiseeTransactionTypeListId').val() != 16) {
                        //        CalculateAmount();
                        //    }
                        //});

                        //applyMaskCurrency('#ItemAmount');
                        //OnlyNumber('#Quantity');
                        //OnlyNumber('#NumOfPayments');
                    },
                    error: function (err) {
                        console.log(err);
                    }
                });
            }
        }

        function showFranchiseeMaintenance(Id) {
            if (Id != 0)
            {
                var sURL = '@Url.Action("FranchiseeMaintenance", "Franchise", new { area = "Portal" })?id=' + Id
                $.ajax({
                    type: "GET",
                    url: sURL,
                    contentType: "application/json; charset=utf-8",
                    datatype: "json",
                    success: function (data) {
                        $('#form_Maintenancemaintenance').html(data);
                        $("#modal_FranchiseeMaintenance").modal('show');
                        $.ajax({
                            type: "GET",
                            url: '@Url.Action("FranchiseDetailAutoComplete", "Franchise", new { area = "Portal" })?franchiseid=' + Id,
                            success: function (res) {
                                //$('#hdfCreditFranchiseeId').val(res.FranchiseeId);
                                $('#spnMaintenanceFranchiseeNumber').html(res.FranchiseeNo);
                                $('#spnMaintenanceFranchiseeName').html(res.Name);
                                $('#spnMaintenanceFranchiseeAddress').html(res.Address1);
                                $('#spnMaintenanceFranchiseeCityStatePincode').html(res.City + ', ' + res.StateName + ' ' + res.PostalCode);
                            }
                        });
                    },
                    error: function (err) {
                        console.log(err);
                    }
                });
            }
        }

        function ShowAddNewTransaction() {
            var sURL = '@Url.Action("PartialAddNewTransaction", "Franchise", new { area = "Portal" })';
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    $('#Render_AddNewTransaction').html(data);
                    $(".input-group-btn").click(function () {
                        $(this).prev().trigger("focus");
                        $(this).prev().trigger("focus");
                    });
                    $("#modal_AddNewTransaction").modal({ backdrop: 'static' });
                    var franchiseid = 0;
                    if (@ViewBag.FranchiseID != null)
                        franchiseid = @ViewBag.FranchiseID;

                    $.ajax({
                        type: "GET",
                        url: '@Url.Action("FranchiseDetailAutoComplete", "Franchise", new { area = "Portal" })?franchiseid=' + franchiseid,
                        success: function (res) {
                            console.log(res);

                            $('#hdfTaxRateTrans').val(res.ContractTaxRate);
                            $('#hdfFranchiseeIdTrans').val(res.FranchiseeId);
                            $('#spnFranchiseeNumberTrans').html(res.FranchiseeNo);
                            $('#spnFranchiseeNameTrans').html(res.Name);
                            $('#spnFranchiseeAddressTrans').html(res.Address1);
                            $('#spnFranchiseeCityStatePincodeTrans').html(res.City + ', ' + res.StateName + ' ' + res.PostalCode);
                        }
                    });

                    //$(".date-picker").datepicker({ autoclose: true});
                    //$("#rdoSingle").prop("checked", true);
                    //$("#divRec").hide();
                    //$("#divRecNP").hide();

                    //$("#rdoSingle").change(function () {
                    //    if (this.value == 1) {
                    //        $("#rdoSingle").prop("checked", true);
                    //        $("#rdoRecurring").prop("checked", false);
                    //        $("#divRec").hide();
                    //        $("#divRecNP").hide();
                    //    }
                    //});

                    //$("#rdoRecurring").change(function () {
                    //    if (this.value == 0) {
                    //        $("#rdoSingle").prop("checked", false);
                    //        $("#rdoRecurring").prop("checked", true);
                    //        $("#divRec").show();
                    //        $("#divRecNP").show();
                    //    }
                    //});

                    //$('#ServiceTypeListId').change(function () {
                    //    if (this.value == 16) {
                    //        $("#divRecVL").show();
                    //    }
                    //});
                    //$('#chkResale').change(function () {
                    //    if ($(this).is(":checked") || $('#ServiceTypeListId').val() != 16) {
                    //        CalculateAmount();
                    //    }
                    //});

                    //applyMaskCurrency('#ItemAmount');
                    //OnlyNumber('#Quantity');
                    //OnlyNumber('#NumOfPayments');
                },
                error: function (err) {
                    console.log(err);
                }
            });
        }

        //function CalculateAmount() {
        //    var temptaxRate = $("#hdfTaxRate").val() == '' ? 0 : parseFloat($("#hdfTaxRate").val());
        //    var tempItemQuantity = $("#Quantity").val() == '' ? 0 : parseFloat($("#Quantity").val());
        //    var tempItemAmount = $("#ItemAmount").val() == '' ? 0 : parseFloat($("#ItemAmount").val());
        //    var tempSubtotal = $("#Subtotal");
        //    var tempTax = $("#Tax");
        //    var tempTotal = $("#Total");

        //    tempSubtotal.val(tempItemQuantity * tempItemAmount);
        //    tempTax.val(parseFloat(tempSubtotal.val()) * temptaxRate / 100)
        //    if ($('#chkResale').is(":checked") || $('#ServiceTypeListId').val() != 16) {
        //        tempTax.val(0);
        //    }

        //    tempTotal.val(parseFloat(tempSubtotal.val()) + parseFloat(tempTax.val()));

        //    if ($('#rdoRecurring').is(":checked")) {
        //        $("#PaymentsBilled").val(tempTotal.val());
        //        $("#GrossTotal").val(parseFloat(tempTotal.val()) * parseInt($("#NumOfPayments").val()));
        //    }

        //    //applyMaskCurrency('#txtsubtotal');
        //    //applyMaskCurrency('#txttaxamount');
        //    //applyMaskCurrency('#txttotalamount');
        //};

        //function onlyDecimal(id) {
        //    $(id).keydown(function (event) {
        //        if (event.shiftKey == true) { event.preventDefault(); }
        //        if ((event.keyCode >= 48 && event.keyCode <= 57) || (event.keyCode >= 96 && event.keyCode <= 105) || event.keyCode == 8 || event.keyCode == 9 || event.keyCode == 37 || event.keyCode == 39 || event.keyCode == 46 || event.keyCode == 190 || event.keyCode == 110) { }
        //        else { event.preventDefault(); }
        //        if ($(this).val().indexOf('.') !== -1 && (event.keyCode == 190 || event.keyCode == 110)) event.preventDefault();
        //    });
        //}

        function OnlyNumber(id) {
            $(id).keydown(function (event) {
                if (event.shiftKey == true) { event.preventDefault(); }
                if ((event.keyCode >= 48 && event.keyCode <= 57) || (event.keyCode >= 96 && event.keyCode <= 105) || event.keyCode == 8 || event.keyCode == 9 || event.keyCode == 37 || event.keyCode == 39 || event.keyCode == 46) { }
                else { event.preventDefault(); }
            });
        }

        function applyMaskCurrency(id) {
            $(id).inputmask("currency", {
                alias: 'currency',
                prefix: '$ ',
                digits: 2,
                autoUnmask: true,
                removeMaskOnSubmit: true,
                unmaskAsNumber: true,
                allowPlus: false,
                allowMinus: false,
                autoGroup: true,
                groupSeparator: ",",
            });
        }
        function btnInvoiceWinClose() {
            $("#modal_FranchiseeBillingDetail").modal('hide');
        }



        //Franchisee Account History Detail
        function showFranchiseeAccountHistoryDetail(Id)
        {
            var sURL = '@Url.Action("FranchiseeAccountHistoryDetail", "Franchise", new { area = "Portal" })?FranchiseeId=' + Id;
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    $('#modelbody_FranchiseeAccountHistoryReport').html(data);
                    $("#modal_FranchiseeAccountHistoryReport").modal({ backdrop: 'static' });
                },
                error: function (err) {
                    console.log(err);
                }
            });
        }

        //Franchisee Account Obligation Detail
        function showFranchiseeObligationDetail(Id)
        {
            var sURL = '@Url.Action("FranchiseeObligationDetail", "Franchise", new { area = "Portal" })?FranchiseeId=' + Id;
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    $('#modelbody_FranchiseeObligationDetailReport').html(data);
                    $("#modal_FranchiseeObligationDetailReport").modal({ backdrop: 'static' });
                    $.ajax({
                            type: "GET",
                            url: '@Url.Action("FranchiseDetailAutoComplete", "Franchise", new { area = "Portal" })?franchiseid=' + Id,
                            success: function (res) {
                                console.log(res);
                                $('#spnFranchiseeNumberObl').html(res.FranchiseeNo);
                                $('#spnFranchiseeNameObl').html(res.Name);
                                $('#spnFranchiseeAddressObl').html(res.Address1);
                                $('#spnFranchiseeCityStatePincodeObl').html(res.City + ', ' + res.StateName + ' ' + res.PostalCode);
                            }
                        });
                },
                error: function (err) {
                    console.log(err);
                }
            });
        }

        function DetailFranchiseeAccountHistoryReportPrint() {
            // window.print();
            $('#_FAHR__btnPrint').hide();
            $('#_FAHR__btnExport').hide();
            var contents = $("#modelbody_FranchiseeAccountHistoryReport").html();
            var frame1 = $('<iframe />');
            frame1[0].name = "_FranchiseeAccountHistoryReportPrintframe1";
            frame1.css({ "position": "absolute", "top": "-1000000px" });
            $("body").append(frame1);
            var frameDoc = frame1[0].contentWindow ? frame1[0].contentWindow : frame1[0].contentDocument.document ? frame1[0].contentDocument.document : frame1[0].contentDocument;
            frameDoc.document.open();
            //Create a new HTML document.
            frameDoc.document.write('<html><head><title></title>');
            frameDoc.document.write('</head><body>');
            //Append the external CSS file.
            frameDoc.document.write('<link href="/fonts/FaceFontcss.css" rel="stylesheet" />');
            frameDoc.document.write('<link href="/Content/admin/assets/global/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css" />');
            frameDoc.document.write('<link href="/Content/admin/assets/global/plugins/simple-line-icons/simple-line-icons.min.css" rel="stylesheet" type="text/css" />');
            frameDoc.document.write('<link href="/Content/admin/assets/global/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />');
            frameDoc.document.write('<link href="/Content/admin/assets/global/plugins/bootstrap-switch/css/bootstrap-switch.min.css" rel="stylesheet" type="text/css" />');
            frameDoc.document.write('<link href="/Content/admin/assets/global/plugins/datatables/datatables.min.css" rel="stylesheet" type="text/css" />');
            frameDoc.document.write('<link href="/Content/admin/assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.css" rel="stylesheet" type="text/css" />');
            //Append the DIV contents.
            frameDoc.document.write(contents);
            frameDoc.document.write('</body></html>');
            frameDoc.document.close();
            console.log(window.frames["_FranchiseeAccountHistoryReportPrintframe1"])
            setTimeout(function () {

                window.frames["_FranchiseeAccountHistoryReportPrintframe1"].focus();
                window.frames["_FranchiseeAccountHistoryReportPrintframe1"].print();
                frame1.remove();
                $('#_FAHR__btnPrint').show();
                $('#_FAHR__btnExport').show();
            }, 500);
        }
        function FranchiseeAccountHistoryReportExport(Id)
        {
            window.location.href = '@Url.Action("FranchiseeAccountHistoryReportExport", "Franchise", new { area = "Portal" })?FranchiseeId=' + Id;
        }

        function showFMTDetail(TxNo) {
            //$('#modal_BillDetail').modal('show');
            $.blockUI();
            var FranchiseeId = $("#hdnFranchiseeId").val();
            var sURL = '@Url.Action("FMTDetail", "Franchise", new { area = "Portal" })?TrNo=' + TxNo.toString();
            console.log(sURL);
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    $('#form_FMTDetail').html(data);
                    $.unblockUI();
                    $("#modal_FMTDetail").modal({ backdrop: 'static' });
                },
                error: function (err) {
                    $.unblockUI();
                    console.log(err);
                }
            });
        }

        function showBillDetail(TxNo) {
            //$('#modal_BillDetail').modal('show');
            $.blockUI();
            var FranchiseeId = $("#hdnFranchiseeId").val();
            var sURL = '@Url.Action("FinderFeeBillDetail", "Franchise", new { area = "Portal" })?TrNo=' + TxNo.toString();
            console.log(sURL);
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    $('#form_FinderFeeBillDetail').html(data);
                    $.unblockUI();
                    $("#modal_FinderfeeBillDetail").modal({ backdrop: 'static' });
                },
                error: function (err) {
                    $.unblockUI();
                    console.log(err);
                }
            });

        }
        function btnBillDetailPopupClose() {
            $("#modal_FinderfeeBillDetail").modal('hide');
        }
        function showChargeBackDetail(TxNo) {
            $.blockUI();
            var sURL = '@Url.Action("ChargeBackDetailPopUp", "Franchise", new { area = "Portal" })?TrNo=' + TxNo.toString();
            console.log(sURL);
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    $('#form_ChargeBackDetail').html(data);
                    $.unblockUI();
                    $("#modal_ChargeBackDetail").modal({ backdrop: 'static' });
                },
                error: function (err) {
                    $.unblockUI();
                    console.log(err);
                }
            });

        }

        function btnChargeBackDetailPopupClose() {
            $("#modal_ChargeBackDetail").modal('hide');
        }

        function bindFranchiseeLeaseDetail(leaseid) {
            var sURL = '@Url.Action("FranchiseeLeaseDetailData", "Franchise", new { area = "Portal" })?leaseId=' + leaseid
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    $('#ddlStatusList').val(data.LeaseDetail.StatusListId);

                    $('#spnFranchiseeNumber').html(data.LeaseDetail.FranchiseeNo);
                    $('#spnFranchiseeAddress').html(data.LeaseDetail.Address);
                    $('#spnFranchiseeName').html(data.LeaseDetail.Name);
                    $('#spnCityStatePincode').html(data.LeaseDetail.City + ',' + data.LeaseDetail.StateName + ' ' + data.LeaseDetail.PostalCode);
                    $('#spnLeaseStatus').val(data.LeaseDetail.LeaseStatus);
                    $('#txtSignDate').val(moment(new Date(parseInt(data.LeaseDetail.SignDate.substr(6)))).format("MM/DD/YYYY"));
                    if (data.LeaseDetail.StartDate != 'null' && data.LeaseDetail.StartDate != null)
                        $('#txtStartDate').val(moment(new Date(parseInt(data.LeaseDetail.StartDate.substr(6)))).format("MM/DD/YYYY"));
                    else
                        $('#txtStartDate').val('');
                    $('#txtLeaseNumber').val(data.LeaseDetail.LeaseNumber);
                    $('#txtMake').val(data.LeaseDetail.Make);
                    $('#txtModel').val(data.LeaseDetail.Model);
                    $('#txtSerialNo').val(data.LeaseDetail.SerialNo);
                    $('#txtDescription').val(data.LeaseDetail.LeaseDescription);
                    $('#chkChargeTaxUpFront').prop("checked", data.LeaseDetail.ChargeTaxUpFront);
                    console.log(data.LeaseDetail.IncludeFirstPaymentInDownPayment);
                    $('#IncludeFirstPaymentInDownPayment').prop("checked", data.LeaseDetail.IncludeFirstPaymentInDownPayment);
                    $('#txtLeaseAmount').val('$ ' + parseFloat(data.LeaseDetail.LeaseAmount, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString());
                    $('#txtLeaseTotalTax').val('$ ' + parseFloat(data.LeaseDetail.LeaseTotalTax, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString());
                    $('#txtLeaseTotal').val('$ ' + parseFloat(data.LeaseDetail.LeaseTotal, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString());
                    $('#txtMonthlyPaymentAmount').val('$ ' + parseFloat(data.LeaseDetail.MonthlyPaymentAmount, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString());
                    $('#txtMonthlyTaxRate').val(data.LeaseDetail.MonthlyTaxRate);
                    $('#txtMonthlyPaymentTotal').val('$ ' + parseFloat(data.LeaseDetail.MonthlyPaymentTotal, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString());
                    $('#txtInstallmentDownPaymentNum').val(data.LeaseDetail.InstallmentDownPaymentNum);
                    $('#txtInstallmentMonthlyPaymentNum').val(data.LeaseDetail.InstallmentMonthlyPaymentNum);
                    $('#txtInstallmentLastPaymentNum').val(data.LeaseDetail.InstallmentLastPaymentNum);
                    $('#txtInstallmentTotalPaymentNum').val(data.LeaseDetail.InstallmentTotalPaymentNum);
                },
                error: function (err) {
                    console.log(err);
                }
            });
        }

        $("#ddlStatusList").change(function () {
            var fid =  $("#hdnFranchiseeID").val();
            var _isactive = null;
            var sURL = '@Url.Action("FLeaseListData", "Franchise", new { area = "Portal" })?franchiseeid=' + fid + '&IsActive=' + _isactive + '&StatusListId=' + $(this).val()
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    var isFirst = true;
                    $('#tbllistdetail > tbody').html('');
                    $.each(data.FLeaseList, function (index, value) {
                        tempRowLineNo = value.LineNumber;
                        tempRowDistribution = "";
                        if (isFirst) {
                            bindFranchiseeLeaseDetail(value.LeaseId);
                            isFirst = false;
                        }

                        tempRowDistribution += '<tr>';
                        tempRowDistribution += '<td class="text-center"><a onclick="bindFranchiseeLeaseDetail(' + value.LeaseId + ')">' + value.LeaseNumber + '</a></td>';
                        tempRowDistribution += '<td class="text-center">$ ' + parseFloat(value.MonthlyPaymentTotal, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';
                        tempRowDistribution += '<td class="text-center">$ ' + parseFloat(value.LeaseTotal, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';
                        tempRowDistribution += '<td class="text-center">' + value.NumOfPaymentsPaid + ' of ' + value.InstallmentMonthlyPaymentNum + '</td>';
                        tempRowDistribution += '<td class="text-center">$ ' + parseFloat((value.LeaseTotal - value.TotalAmountPaid), 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';
                        tempRowDistribution += '<td class="text-center">' + value.StatusListName + '</td>';
                        tempRowDistribution += '<td class="text-center"><i class="fa fa-edit" style="color: cornflowerblue;font-size: 15px;"></i></td>';
                        tempRowDistribution += '</tr>';

                        $('#tbllistdetail>tbody').append(tempRowDistribution);
                    });
                },
                error: function (err) {
                    console.log(err);
                }
            });
        });

        function bindFranchiseeLeaseList(fid) {
            $("#hdnFranchiseeID").val(fid);
            var _isactive = false;
            if ($("#chkActivePopUp").prop("checked") == true && $("#chkInActivePopUp").prop("checked") == true) {
                _isactive = null;
            }
            else if ($("#chkActivePopUp").prop("checked") == true && $("#chkInActivePopUp").prop("checked") == false) {
                _isactive = true;
            }
            else if ($("#chkInActivePopUp").prop("checked") == true && $("#chkActivePopUp").prop("checked") == false) {
                _isactive = false;
            }
            else {
                _isactive = null;
            }
            var sURL = '@Url.Action("FLeaseListData", "Franchise", new { area = "Portal" })?franchiseeid=' + fid + '&IsActive=' + _isactive + '&StatusListId=' + $("#ddlStatusList").val()
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    var isFirst = true;
                    $('#tbllistdetail > tbody').html('');
                    $.each(data.FLeaseList, function (index, value) {
                        tempRowLineNo = value.LineNumber;
                        tempRowDistribution = "";
                        if (isFirst) {
                            bindFranchiseeLeaseDetail(value.LeaseId);
                            isFirst = false;
                        }

                        tempRowDistribution += '<tr>';
                        tempRowDistribution += '<td class="text-center"><a onclick="bindFranchiseeLeaseDetail(' + value.LeaseId + ')">' + value.LeaseNumber + '</a></td>';
                        tempRowDistribution += '<td class="text-center">$ ' + parseFloat(value.MonthlyPaymentTotal, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';
                        tempRowDistribution += '<td class="text-center">$ ' + parseFloat(value.LeaseTotal, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';
                        tempRowDistribution += '<td class="text-center">' + value.NumOfPaymentsPaid + ' of ' + value.InstallmentMonthlyPaymentNum + '</td>';
                        tempRowDistribution += '<td class="text-center">$ ' + parseFloat((value.LeaseTotal - value.TotalAmountPaid), 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString() + '</td>';
                        tempRowDistribution += '<td class="text-center">' + value.StatusListName + '</td>';
                        tempRowDistribution += '<td class="text-center"><i class="fa fa-edit" style="color: cornflowerblue;font-size: 15px;"></i></td>';
                        tempRowDistribution += '</tr>';

                        $('#tbllistdetail>tbody').append(tempRowDistribution);
                    });
                    $("#modal_LeaseDetail").modal("show");
                },
                error: function (err) {
                    console.log(err);
                }
            });
        }

        function LeaseDetail(id,stuaslistid) {
            $("#ddlStatusList").val(stuaslistid);
            bindFranchiseeLeaseList(id)
        }

        typeaheadSourceF = [];

        function ShowCustomerSuggetionBox() {
            applyCustomerAutoSeacrh();
            $('#fcsearch-box').val('');
            $('#hdfsearch_customerid').val('');
            var box = $('#fcsearch-box').data('typeahead');
            if (box != null) {
                box.source = c_typeaheadSource;
            }
            else {
                $('#fcsearch-box').typeahead({
                    source: c_typeaheadSource,
                    updater: function (item) {
                        $('#hdfsearch_customerid').val(item.id);
                        AccountOfferingPopup();
                        return item;
                    },
                    minLength: 1
                }).focus();
            }

            $("#ModalCustomerSerarchPopup").modal({ backdrop: 'static' });
        }

        function applyCustomerAutoSeacrh() {
            $.ajax({
                type: "GET",
                url: '@Url.Action("GetAllCustomer", "Customer", new { area = "Portal" })',
                data: {},
                success: function (data) {

                    var typeaheadSource = [];
                    $.each(data, function (key, value) {
                        typeaheadSource.push({ id: value.CustomerId, name: value.CustomerNo + ' ' + $.trim(value.Name) })
                    });
                    var box = $('#fcsearch-box').data('typeahead');
                    if (box != null) {

                        console.log('csearch source change');
                        box.source = typeaheadSource;
                    }
                    else {
                        console.log('csearch initiated');
                        $('#fcsearch-box').typeahead({
                            source: typeaheadSource,
                            updater: function (item) {
                                console.log(item);
                                redirect(item.id);
                                return item;
                            },
                            minLength: 1
                        }).focus();
                    }
                }
            });
        }

        function AccountOfferingPopup()
        {

            $("#ModalCustomerSerarchPopup").modal("hide");
            $.blockUI();
            var sURL = '@Url.Action("AccountOfferingPopup", "Franchise", new { area = "Portal" })?CustomerId=' + $('#hdfsearch_customerid').val();
            console.log(sURL);
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    $('#RenderAccountOfferingDetail').html(data);
                    $.unblockUI();
                    $("#modal_AccountOfferingDetail").modal({ backdrop: 'static' });

                    $("#txtDateOffered").datepicker();
                    $("#txtDate").datepicker();
                },
                error: function (err) {
                    $.unblockUI();
                    console.log(err);
                }
            });

        }

        function ShowOfferedList(FrId) {
        $.blockUI();
        var sURL = '@Url.Action("AccountOfferingListPopup", "Franchise", new { area = "Portal" })?Id=' + FrId;
        console.log(sURL);
        $.ajax({
            type: "GET",
            url: sURL,
            contentType: "application/json; charset=utf-8",
            datatype: "json",
            success: function (data) {
                $('#RenderAccountOfferingListingDetail').html(data);
                $.unblockUI();
                $("#modal_AccountOfferingListingDetail").modal({ backdrop: 'static' });
                _bindOfferingList();

            },
            error: function (err) {
                $.unblockUI();
                console.log(err);
            }
        });
        }

        function _bindOfferingList() {
            var ps = $('#pageSizeOfferingList').val();
            dtable = $('#tblOfferingList').dataTable({
                "bAutoWidth": false,
                cache: false,
                "dom": "<'table-responsive't><'bottom'ip><'clear'>",
                "aaSorting": [[0, "desc"]],
                "sAjaxSource": getCurrentUrl(),
                "sAjaxDataProp": "aadata",  // Internationalisation. For more info refer to http://datatables.net/manual/i18n
                "rowCallback": function (nRow, data) {
                },
                "aoColumns": [
                    {
                        "sName": "region",
                        "bSortable": true,
                        "sClass": "cls-center",
                        "mRender": function (data, type, full) {
                            return '<span>' + full.Region + '</span>';
                        }
                    },
                    {
                        "sName": "CustomerNo",
                        "bSortable": true,
                        "sClass": "cls-center",
                        "mRender": function (data, type, full) {
                            return '<span>' + full.CustomerNo + '</span>';
                        }
                    },
                    {
                        "sName": "Customer Name",
                        "bSortable": true,
                        "sClass": "cls-left",
                        "mRender": function (data, type, full) {
                            return full.CustomerName;
                        }
                    },
                    {
                        "sName": "AccountType",
                        "bSortable": true,
                        "sClass": "cls-center",
                        "mRender": function (data, type, full) {
                            return full.AccountType;
                        }
                    },
                    {
                        "sName": "ContractBillingAmount",
                        "bSortable": true,
                        "sClass": "cls-right",
                        "mRender": function (data, type, full) {
                            return '$' + parseFloat(full.ContractBillingAmount, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString();

                        }
                    },
                    {
                        "sName": "Distance",
                        "bSortable": true,
                        "sClass": "cls-right",
                        "mRender": function (data, type, full) {
                            return (parseFloat(full.Distance, 10).toFixed(2) != 'NaN' ? parseFloat(full.Distance, 10).toFixed(2) : "");
                        }
                    }
                    ,
                    {
                        "sName": "OfferedDate",
                        "bSortable": true,
                        "sClass": "cls-center",
                        "mRender": function (data, type, full) {
                            return (full.OfferedDate != null ? moment(new Date(parseInt(full.OfferedDate.substr(6)))).format("MM/DD/YYYY") : "");
                        }
                    },
                    {
                        "sName": "OfferedStatus",
                        "bSortable": true,
                        "sClass": "cls-center",
                        "mRender": function (data, type, full) {
                            var result="";
                            if (full.OfferAcceptedNote != null)
                            {
                                result = "ACCEPTED";
                            }
                            else if (full.OfferDeclinedNote != null)
                            {
                                result = "DECLINE";
                            }
                            return result;
                        }
                    },
                    {
                        "sName": "StatusDate",
                        "bSortable": true,
                        "sClass": "cls-center",
                        "mRender": function (data, type, full) {
                            return (full.StatusDate != null ? moment(new Date(parseInt(full.StatusDate.substr(6)))).format("MM/DD/YYYY") : "");
                        }
                    },
                    {
                        "sName": "DeclineReason",
                        "bSortable": true,
                        "mRender": function (data, type, full) {
                            return full.DeclineReason;
                        }
                    },
                    {
                        "sName": "Status",
                        "bSortable": true,
                        "sClass": "cls-center",
                        "mRender": function (data, type, full) {
                            return full.Status;
                        }
                    },

                ]
            });
        }

         function getCurrentUrl() {
             return '@Url.Action("OfferingListData", "Franchise", new { area = "Portal" })?Id=' + $("#hdnFranchiseeId").val();
        }

        function ClickOnPrev() {
            var RId = parseInt($("#hdnRecordId").val());
            if (RId > 0) {
                var PId = RId - 1;
                window.location.href = '@Url.Action("SearchFranchiseeDetails", "Franchise", new { area = "Portal" })?FranId=' + $("#hdnFranchiseId").val() + '&step=-1&RId=' + PId + "&colidx=" + $("#hdncolidx").val() + "&sort=" + $("#hdncolsort").val();
            }
        }
        function ClickOnNext() {
            var RId = parseInt($("#hdnRecordId").val());
            if (RId > 0) {
                var NId = RId + 1;
                window.location.href = '@Url.Action("SearchFranchiseeDetails", "Franchise", new { area = "Portal" })?FranId=' + $("#hdnFranchiseId").val() + '&step=1&RId=' + NId + "&colidx=" + $("#hdncolidx").val() + "&sort=" + $("#hdncolsort").val();
            }
        }
    </script>
}
