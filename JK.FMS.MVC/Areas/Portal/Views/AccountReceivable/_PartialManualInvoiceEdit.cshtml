@model JKApi.Service.AccountReceivable.ManualInvoiceDetailViewModel
@section styles{

    <link href="@Url.Content("~/Content/admin/assets/global/plugins/datatables/datatables.min.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/admin/assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.css")" rel="stylesheet" type="text/css" />
    <style type="text/css">
        .close {
            background-image: url(/Content/admin/assets/global/img/stick_close.png) !important;
            height: 12px !important;
            width: 12px !important;
            margin-top: 0px !important;
        }

        #tblcontractdetailrows {
        }

        .theadRow tr {
            font-size: 12px;
        }

        .theadRow td {
            border: 1px solid #e8e8e8 !important;
            padding: 0px 5px !important;
            font-size: 12px;
        }

        .theadRowH td {
            border-left: 1px solid #e8e8e8 !important;
            border-right: 1px solid #e8e8e8 !important;
            border-bottom: 1px solid #e8e8e8 !important;
            padding: 5px 5px !important;
            font-size: 12px;
        }

        .theadRowH.remove-padding td {
            padding: 0px !important;
            font-size: 12px;
        }

        .theadRow td > label, .theadRowH td > label {
            float: left;
            margin-top: 3px;
            font-size: 12px;
        }

        .theadRow td input[type=checkbox], .theadRowH td input[type=checkbox] {
            float: left;
            margin-right: 5px;
            margin-top: 6px;
            font-size: 12px;
        }

        .theadRow td input[type=text], .theadRowH td input[type=text] {
            margin-top: 0px !important;
            border: 0;
            border-radius: 0;
            font-size: 12px;
        }

        .theadRow td .input-sm, .theadRowH td .input-sm {
            margin-top: 0px !important;
            border: 0;
            border-radius: 0;
            font-size: 12px;
        }
    </style>
}
<script>
    //BindTaxDetails($("#hdnCustomerId").val());
</script>
<div class="modal fade custom-model custom-form-design" id="modal_invoiceedit" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
    <div class="modal-dialog" style="width:1200px">
        <div class="modal-content" style="border-radius: 8px;">
            <div class="modal-header headerbox list" style="padding:0px!important;border-bottom: none;">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="margin-top: 12px !important;margin-right: 12px !important;"></button>
                <h4 class="modal-title" style="margin-top: 0px; margin-bottom: 4px;  padding: 7px!important;font-size: 12px;font-weight: bold;background: #3598DC !important;color: #FFF !important;border: 1px solid #3598DC !important;padding: 0px;border-radius: 8px 8px 0 0;text-transform: uppercase;">
                    Invoice
                </h4>
            </div>
            <div class="modal-body" style="padding: 10px;">
                <form class="form-horizontal" id="form_manualinvoice_submitForm" role="form" action="@Url.Action("ManualInvoiceEdit","AccountReceivable","Portal")" method="post">

                    @Html.HiddenFor(m => m.CustomerTransactionItems.FirstOrDefault().CustomerId, new { id = "hdfCustomerId", required = "required" })
                    @Html.HiddenFor(m => m.CustomerTransactionItems.FirstOrDefault().MasterTmpTrxId, new { id = "hdfMasterTmpTrxId", required = "required" })

                    <input type="hidden" id="hdftotallineno" name="hdftotallineno" value="@(Model.CustomerTransactionItems.Count())" />
                    <input type="hidden" id="hdfftotallineno" name="hdfftotallineno" value="@(Model.FrenchiseeTransactionItems.Count())" />
                    <input type="hidden" id="hdfTaxRateId" name="hdfTaxRateId" value="@Model.CustomerTransactionItems.FirstOrDefault().TaxRateId" />
                    <input type="hidden" id="hdfContractTaxRate" name="hdfContractTaxRate" value="@Model.CustomerTransactionItems.FirstOrDefault().ContractTaxRate" />
                    <input type="hidden" id="hdfLeaseTaxRate" name="hdfLeaseTaxRate" value="@Model.CustomerTransactionItems.FirstOrDefault().LeaseTaxRate" />
                    <input type="hidden" id="hdfSupplyTaxRate" name="hdfSupplyTaxRate" value="@Model.CustomerTransactionItems.FirstOrDefault().SupplyTaxRate" />

                    <div class="form-body">
                        <div class="row">
                            <div class="col-md-3">
                                <label class="control-label col-md-12" style="text-align: center;padding: 5px;background-color: #e8e8e8;margin-bottom:5px;font-weight:bold;">Customer</label>
                                <label class="col-md-12"><b><span id="spncustomerno">@Model.CustomerTransactionItems.FirstOrDefault().CustomerNo</span></b></label>
                                <label class="col-md-12"><span id="spncustomername">@Model.CustomerTransactionItems.FirstOrDefault().Name</span></label>
                                <label class="col-md-12"><span id="spncustomeraddress">@Model.CustomerTransactionItems.FirstOrDefault().Address1</span></label>
                                <label class="col-md-12"><span id="spncustomeraddress">@Model.CustomerTransactionItems.FirstOrDefault().Address2</span></label>
                                <label class="col-md-12"><span id="spncustomercity">@Model.CustomerTransactionItems.FirstOrDefault().City</span>, <span id="spncustomerstate">@Model.CustomerTransactionItems.FirstOrDefault().StateName</span>&nbsp;<span id="spncustomerpincode">@Model.CustomerTransactionItems.FirstOrDefault().PostalCode</span></label>
                            </div>
                            <div class="col-md-6"></div>
                            <div class="col-md-3">
                                <label class="control-label col-md-12" style="text-align: center;padding: 5px;background-color: #e8e8e8;margin-bottom:5px;font-weight:bold;">Billing</label>
                                <label class="col-md-12"><b><span id="spncustomerbname">@Model.CustomerTransactionItems.FirstOrDefault().BName</span></b></label>
                                <label class="col-md-12">Att:&nbsp;<span id="spncustomerbattname">@Model.CustomerTransactionItems.FirstOrDefault().Attention</span></label>
                                <label class="col-md-12"><span id="spncustomeraddress1">@Model.CustomerTransactionItems.FirstOrDefault().BAddress1</span></label>
                                <label class="col-md-12"><span id="spncustomeraddress1">@Model.CustomerTransactionItems.FirstOrDefault().BAddress2</span></label>
                                <label class="col-md-12"><span id="spncustomercity1">@Model.CustomerTransactionItems.FirstOrDefault().BCity</span>, <span id="spncustomerstate1">@Model.CustomerTransactionItems.FirstOrDefault().BStateName</span>&nbsp;<span id="spncustomerpincode1">@Model.CustomerTransactionItems.FirstOrDefault().BPostalCode</span></label>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">

                                <div class="table-responsive">

                                    <table class="col-md-12 table" id="tblcontractdetailrows">
                                        <thead>

                                            <tr class="theadRow" style="background-color:#e8e8e8;">
                                                <td style="padding: 3px!important;">Description</td>
                                                <td colspan="5" style="padding: 0px!important;">
                                                    @*<input type="text" id="txtInvoiceDescription" name="txtInvoiceDescription" value="@Model.CustomerTransactionItems.FirstOrDefault().InvoiceDescription" style="width:100%;width: 100%;padding: 4px;border-radius: 0px;" maxlength="150" />*@
                                                    <textarea required="" id="txtInvoiceDescription" name="txtInvoiceDescription" class="form-control input-sm requiredValidation" row="1" style="width:100%;padding: 5px;border-radius: 0px;resize:vertical;max-height:100px;min-height:30px;">@Model.CustomerTransactionItems.FirstOrDefault().InvoiceDescription</textarea>
                                                </td>
                                                <td colspan="2" style="padding: 3px!important;text-align: right;padding-right: 10px!important;">Inv Date</td>
                                                <td style="padding: 0px!important;"><input type="text"  id="txtInvoicedate" name="txtInvoicedate" placeholder="" value="@(((DateTime)Model.CustomerTransactionItems.FirstOrDefault().InvoiceDate).ToString("MM/dd/yyyy"))" class="form-control input-sm date-picker" /></td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (JKApi.Data.DAL.vw_AR_CustomerTransaction oC in Model.CustomerTransactionItems.ToList())
                                            {
                                                <tr relline="S' + @oC.LineNo + '" style="background-color:#eef1f5;border-right: 1px solid #eef1f5;">
                                                    <td colspan="9" style="padding:0!important;">
                                                        <table class="col-md-12" style="margin: 0px!important;">
                                                            @*<tr class="theadRow">
                                                                    <td style="width:72px;padding: 0px !important;text-align:center;">Line No</td>
                                                                    <td style="padding: 0px !important;text-align:right;"><label for="@("id=chkPrintInvoice" + oC.LineNo)" style="padding-left: 0px;float: right;">Print Invoice</label><input style="float: right;" type="checkbox" @("id=chkPrintInvoice" + oC.LineNo) @("name=chkPrintInvoice" + oC.LineNo) @(oC.PrintInvoice == true ? "checked='checked'" : "")></td>
                                                                    <td style="width: 110px;"><input type="checkbox" @("id=chkCommission" + oC.LineNo) @("name=chkCommission" + oC.LineNo) @(oC.Commission == true ? "checked='checked'" : "")><label>Commission</label></td>
                                                                    <td style="width: 110px;padding: 0 0px !important;"><input type="text" @("id=txtCommissionAmount" + oC.LineNo) @("name=txtCommissionAmount" + oC.LineNo) value="@oC.CommissionTotal" maxlength="10" class="form-control input-sm" /></td>
                                                                    <td style="width: 105px;"><input type="checkbox" @("id=chkExtraWork" + oC.LineNo) @("name=chkExtraWork" + oC.LineNo) @(oC.ExtraWork == true ? "checked='checked'" : "")><label>Extra Work</label></td>
                                                                    <td style="width: 115px;"><input type="checkbox" @("id=chkTaxExcempt" + oC.LineNo) @("name=chkTaxExcempt" + oC.LineNo) @(oC.TaxExcempt == true ? "checked='checked'" : "")><label>Tax Exempt</label></td>
                                                                    <td style="width: 105px;"><input type="checkbox" @("id=chkBPPAdmin" + oC.LineNo) @("name=chkBPPAdmin" + oC.LineNo) @(oC.BPPAdmin == true ? "checked='checked'" : "")><label>BPP Admin</label></td>
                                                                    <td style="width: 115px;"><input type="checkbox" @("id=chkAcctRebate" + oC.LineNo) @("name=chkAcctRebate" + oC.LineNo) @(oC.AccountRebate == true ? "checked='checked'" : "") /><label>Acct Rebate</label></td>
                                                                </tr>*@
                                                            <tr class="theadRow">
                                                                <td style="width:72px;padding: 0px !important;text-align:center;">Line No</td>
                                                                <td style="padding: 0px !important;text-align:right;"><label for="@("chkPrintInvoice" + oC.LineNo)" style="padding-left: 0px;float: right;"></label></td>
                                                                <td style="width: 110px;"></td>
                                                                <td style="width: 110px;padding: 0 0px !important;"></td>
                                                                <td style="width: 159px;"><label class="check-inline" style="margin-right: 5px;"><input onchange="changeSelectedType(@oC.LineNo)" type="radio" @("name=tablerdo" + oC.LineNo) value="1" class="i-checks" @("id=rdoAdditional" + oC.LineNo) @(oC.Commission == true ? "checked='checked'" : "") /><span>Additional Billing Office</span></label></td>
                                                                <td style="width: 100px;padding: 0 0px !important;">
                                                                    <input type="text" @("id=txtCommissionAmount" + oC.LineNo) @("name=txtCommissionAmount" + oC.LineNo) value="@oC.CommissionTotal" maxlength="10" class="form-control input-sm cnumeric" /></td>
                                                                <td>
                                                                    <div class="icheck-inline" style="margin-top: 0px;">
                                                                        <label class="check-inline" style="margin-right: 5px;">
                                                                            <input type="radio" @("name=tablerdo" + oC.LineNo) onchange="changeSelectedType(@oC.LineNo)" value="2" class="i-checks" @("id=rdoExtraWork" + oC.LineNo) @(oC.Commission == false && oC.ExtraWork == true ? "checked='checked'" : "") /><span>ExtraWork</span>
                                                                        </label><label class="check-inline">
                                                                            <input type="radio" @("name=tablerdo" + oC.LineNo) onchange="changeSelectedType(@oC.LineNo)" value="3" class="i-checks" @("id=rdoRegularBilling" + oC.LineNo) @(oC.Commission == false && oC.ExtraWork == false ? "checked='checked'" : "") /><span>Regular Billing</span>
                                                                        </label>
                                                                        <label class="check-inline">
                                                                            <input type="radio" @("name=tablerdo" + oC.LineNo) onchange="changeSelectedType(@oC.LineNo)" value="4" class="i-checks" @("id=rdoclientsupplies" + oC.LineNo) @(oC.ClientSupplies == true? "checked='checked'" : "") /><span>Client Supplies</span>
                                                                        </label>
                                                                    </div>
                                                                </td>
                                                                <td><input onchange="changeSelectedType(@oC.LineNo)" type="checkbox" @("id=chkTaxExcempt" + oC.LineNo) @("name=chkTaxExcempt" + oC.LineNo) @(oC.TaxExcempt == true ? "checked='checked'" : "") /><label>Tax Exempt</label></td>

                                                            </tr>
                                                        </table>
                                                    </td>
                                                </tr>


                                                <tr class="theadRowH" style="background-color:#eef1f5;">
                                                    <td style="text-align:center;width:60px;padding: 0px !important;"><input type="text" readonly @("id=txtlinenumber" + @oC.LineNo) @("name=txtlinenumber" + @oC.LineNo) value="@oC.LineNo" class="form-control input-sm cnumeric" style="padding: 5px;border-radius: 0px;text-align:center" /></td>
                                                    <td style="text-align:center;width:200px;">Service</td>
                                                    <td style="text-align:center;">Detail Description</td>
                                                    <td style="width:80px;text-align:center;">Markup %</td>
                                                    <td style="width:60px;text-align:center;">Qty</td>
                                                    <td style="width:100px;text-align:center;">Unit Price</td>
                                                    <td style="width:100px;text-align:center;">Markup Amt.</td>
                                                    <td style="width:100px;text-align:center;">Extended Price</td>
                                                    <td style="width:90px;text-align:center;">Tax</td>
                                                    <td style="width:100px;text-align:center;">Total</td>
                                                </tr>
                                                <tr class="theadRowH remove-padding">
                                                    <td style="text-align:center;background-color:#eef1f5;"></td>
                                                    <td style="text-align:center;">
                                                        <select class="form-control input-sm" @("relsel" + oC.LineNo + " = " + oC.ServiceTypeListId)
                                                                @("id=ContractDetailServiceTypeList" + oC.LineNo) @("name=ContractDetailServiceTypeList" + oC.LineNo)></select>
                                                    </td>
                                                    <td style="text-align:left;"><textarea required @("id=txtdescription" + oC.LineNo) @("name=txtdescription" + oC.LineNo) class="form-control input-sm" row="1" style="padding: 5px;border-radius: 0px;resize:vertical;max-height:100px;min-height:30px;">@oC.Description</textarea></td>
                                                    <td style="text-align:right;"><input type="text" required @(oC.ServiceTypeListId != 5 ? "readonly" : "") onchange="CalculateAmount(@oC.LineNo)" @("id=txtmarkup" + oC.LineNo) @("name=txtmarkup" + oC.LineNo) value="@oC.MarkUpTotal" class="form-control input-sm" style="padding: 5px;border-radius: 0px;" /></td>
                                                    <td style="text-align:center;"><input type="text" required onchange="CalculateAmount(@oC.LineNo)" @("id=txtqty" + oC.LineNo) @("name=txtqty" + oC.LineNo) value="@oC.Quantity" class="form-control input-sm" style="padding: 5px;border-radius: 0px;" /></td>

                                                    <td style="text-align:center;">
                                                        <input type="hidden" @("id=hdfunitprice" + oC.LineNo) @("name=hdfunitprice" + oC.LineNo) value="@(oC.UnitPrice))" />

                                                        <input type="text" required onchange="CalculateAmount(@oC.LineNo)" @("id=txtunitprice" + oC.LineNo) @("name=txtunitprice" + oC.LineNo) value="@oC.UnitPrice" class="form-control input-sm unitPrice ccurrency" style="padding: 5px;border-radius: 0px;" />
                                                    </td>
                                                    <td style="text-align:center;"><input type="text" required readonly onchange="CalculateAmount(@oC.LineNo)" @("id=txtMarkupAmt" + oC.LineNo) @("name=txtMarkupAmt" + oC.LineNo) value="@(oC.UnitPrice * (oC.MarkUpTotal / 100.0M))" class="form-control input-sm ccurrency" style="padding: 5px;border-radius: 0px;" /></td>
                                                    <td style="text-align:center;"><input type="text" required readonly onchange="CalculateAmount(@oC.LineNo)" @("id=txtExtendedPrice" + oC.LineNo) @("name=txtExtendedPrice" + oC.LineNo) value="@oC.ExtendedPrice" class="form-control input-sm ccurrency" style="padding: 5px;border-radius: 0px;" /></td>
                                                    <td style="text-align:center;"><input type="text" required readonly onchange="CalculateAmount(@oC.LineNo)" @("id=txttax" + oC.LineNo) @("name=txttax" + oC.LineNo) value="@oC.Tax" class="form-control input-sm ccurrency" style="padding: 5px;border-radius: 0px;" /></td>
                                                    <td style="text-align:right;"><input type="text" required readonly onchange="CalculateAmount(@oC.LineNo)" @("id=txttotal" + oC.LineNo) @("name=txttotal" + oC.LineNo) value="@oC.Total" class="form-control input-sm ccurrency" style="padding: 5px;border-radius: 0px;" /></td>
                                                </tr>
                                            }
                                        </tbody>
                                        <tfoot>
                                            <tr class="theadRowH remove-padding">
                                                @*<td colspan="6" rowspan="3" style="text-align:left;vertical-align:top;padding:7px;"><a href="javascript:void(0);" onclick="addNewEntry()">+ Add</a></td>*@
                                                <td colspan="6" rowspan="3" style="text-align:left;vertical-align:top;padding:7px;"></td>
                                                <td colspan="2" style="padding:4px !important"><b>Sub Total</b></td>
                                                <td colspan="1" style="padding:0 !important"><input readonly id="txtsubtotal" type="text" name="txtsubtotal" value="@Model.CustomerTransactionItems.Sum(o => o.ExtendedPrice)" class="form-control input-sm ccurrency" style="padding: 5px;border-radius: 0px;" /></td>
                                            </tr>
                                            <tr class="theadRowH remove-padding">
                                                <td colspan="2" style="padding:4px !important"><b>Tax</b></td>
                                                <td colspan="1" style="padding:0 !important"><input readonly id="txttaxamount" type="text" name="txttaxamount" value="@Model.CustomerTransactionItems.Sum(o => o.Tax)" class="form-control input-sm ccurrency" style="padding: 5px;border-radius: 0px;" /></td>
                                            </tr>
                                            <tr class="theadRowH remove-padding">
                                                <td colspan="2" style="padding:4px !important"><b>Total</b></td>
                                                <td colspan="1" style="padding:0 !important"><input readonly id="txttotalamount" type="text" name="txttotalamount" value="@Model.CustomerTransactionItems.Sum(o => o.Total)" class="form-control input-sm ccurrency" style="padding: 5px;border-radius: 0px;" /></td>
                                            </tr>
                                        </tfoot>

                                    </table>
                                </div>

                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12">

                                <table class="col-md-12" style="border:1px solid #e8e8e8" id="frdestributionTable">
                                    <thead>
                                        <tr>
                                            <th colspan="4"><input type="text" id="fsearch-box" name="name" value="" placeholder="Search Pay To by Number or Name" class="form-control input-sm typeahead" style="padding: 5px;border-radius: 0px;margin: 0px;" /></th>
                                        </tr>
                                        <tr>
                                            <th style="width:60px;padding:3px;margin: 0px;">Line No</th>
                                            <th style="width:150px;padding:3px;margin: 0px;">Franchisee No.</th>
                                            <th style="padding:3px;">Name</th>
                                            <th style="width:100px;padding:3px;">Amount</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @{int flineNo = 0;}
                                        @foreach (JKApi.Data.DAL.vw_AR_FrenchiseeTransaction OT in Model.FrenchiseeTransactionItems)
                                        {
                                            flineNo++;
                                            <tr>
                                                <td>
                                                    <input type="hidden"
                                                           @("relLine=" + OT.LineNo) @("id=hdfFrenchiseeId" + flineNo + "_" + OT.LineNo) @("name=hdfFrenchiseeId" + flineNo + "_" + OT.LineNo) value="@OT.FranchiseeId" />
                                                    <input type="text" readonly @("id=frlinenumber" + flineNo + "_" + OT.LineNo) @("name=frlinenumber" + flineNo + "_" + OT.LineNo) value="@OT.LineNo" class="form-control input-sm" style="padding: 5px;border-radius: 0px;" />
                                                </td>
                                                <td><input type="text" required relLine="@OT.LineNo" readonly @("id=frfranchiseeno" + flineNo + "_" + OT.LineNo) @("name=frfranchiseeno" + flineNo + "_" + OT.LineNo) value="@OT.FranchiseeNo" class="form-control input-sm" style="padding: 5px;border-radius: 0px;" /></td>
                                                <td><input type="text" required relLine="@OT.LineNo" readonly @("id=frfranchiseename" + flineNo + "_" + OT.LineNo) @("name=frfranchiseename" + flineNo + "_" + OT.LineNo) value="@OT.Name" class="form-control input-sm" style="padding: 5px;border-radius: 0px;" /></td>
                                                <td><input type="text" required relLine="@OT.LineNo" @("id=frfranchiseeamount" + flineNo + "_" + OT.LineNo) @("name=frfranchiseeamount" + flineNo + "_" + OT.LineNo) value="$ @OT.Amount" class="form-control input-sm ccurrency" style="padding: 5px;border-radius: 0px;" /></td>
                                            </tr>

                                        }


                                    </tbody>
                                </table>

                            </div>
                        </div>
                    </div>
                    <div class="form-actions" style="border-style: solid;border-width: 1px;height: auto;">
                         <div class="col-md-1" style="background-color:#3598dc;height: 35px;">
                            <button type="button" id="btnEditMInvoice" class="btn btn-primary button-next pull-right" onclick="" style="margin-right:0px; margin-top: 4px;">Edit</button>
                        </div>
                         <div class="col-md-11" style="background-color:#3598dc;height: 35px;">
                             <button type="button" id="btnCancelMInvoice" class="btn btn-primary button-next pull-right" onclick="" style="margin-right:0px; margin-top: 4px;display:none;">Cancel</button>
                             <button type="button" id="btnSaveMInvoice" class="btn btn-primary button-next pull-right" onclick="" style="margin-right:0px; margin-top: 4px;margin-right: 15px;display:none;">Save</button>
                         </div>
                        @if (Model.PendingDashboardDataModel != null)
                        {
                            int count = Model.PendingDashboardDataModel.Count();
                            var data = Model.PendingDashboardDataModel.LastOrDefault();
                            int i = 0;
                            foreach (var d in Model.PendingDashboardDataModel)
                            {
                                i++;
                                <div class="col-md-12 PendingMessage">

                                    <div class="col-md-2 control-label">
                                        @d.FirstName @d.LastName :<span class="required"> * </span>
                                    </div>
                                    <div class="col-md-6 control-label">
                                        <textarea class="form-control input-sm PendingMessage" style="resize: none;overflow-x: hidden;" readonly="readonly" rows="3" id="txtNote">@d.Message</textarea>
                                    </div>
                                    @if (data != null && data.IsRejacted == true && data.CreatedByChild == Model.USERID)
                                    {

                                        <div class="col-md-2 control-label MainAdmins" style="display:none; margin-top: 30px;">
                                            <input type="button" id="btnReject" onclick="UpdateApproveReject(2)" class="btn btn-primary col-md-11" value="REJECTED" style="margin-bottom:3px;font-size:11px;margin-top:3px;margin-left:5px !important;width: 100px;    height: 25px;" />
                                        </div>
                                        <div class="col-md-2 control-label MainAdmins" style="display:none; margin-top: 30px;right: 40px;">
                                            <input type="button" id="btnApprove" onclick="UpdateApproveReject(1)" class="btn btn-primary col-md-11" value="APPROVED" style="font-size:11px;padding-left:0px !important;padding-right:0px !important;margin-top:3px;margin-left:0px !important;width: 100px;    height: 25px;" />
                                        </div>
                                        if (i == Model.PendingDashboardDataModel.Count())
                                        {
                                            <script>$(".PendingMessage").last().prop("readonly", false)</script>
                                            <div style="left: 35px;" class="col-md-2 control-label">
                                                <input type="button" id="btnSubmit" onclick="UpdateRejectMessage(3,$('.PendingMessage').last())" class="btn btn-primary col-md-11" value="Submit" style="font-size:11px;padding-left:0px !important;padding-right:0px !important;margin-top:3px;margin-left:-40px !important" />
                                            </div>
                                        }
                                    }
                                    else
                                    {
                                        <div class="col-md-2 control-label">
                                        </div>
                                        <div class="col-md-2 control-label">
                                        </div>
                                    }
                                </div>
                            }
                            if (data != null && data.IsRejacted == false && data.CreatedByChild == Model.USERID)
                            {
                                <div class="col-md-12">
                                    @*<input type="hidden" id="hdnCustomerId" name="hdnCustomerId" value="@Model.CustomerTransactionItems.FirstOrDefault().CustomerId" />*@
                                    <div class="col-md-2 control-label">
                                        @*Note :<span class="required"> * </span>*@
                                    </div>
                                    <div class="col-md-6 control-label">
                                        @*<textarea class="form-control input-sm PendingMessage" style="resize: none;overflow-x: hidden;" rows="3" id="txtNote"></textarea>*@
                                    </div>
                                    <script>$(".PendingMessage").last().prop("readonly", false)</script>
                                    <div class="col-md-2 control-label MainAdmins" style="margin-top: 30px;">
                                        <input type="button" id="btnReject" onclick="UpdateApproveReject(2)" class="btn btn-primary col-md-11" value="REJECTED" style="margin-bottom:3px;font-size:11px;margin-top:3px;margin-left:5px !important;width: 100px;    height: 25px;" />
                                    </div>
                                    <div class="col-md-2 control-label MainAdmins" style="margin-top: 30px;right: 40px;">
                                        <input type="button" id="btnApprove" onclick="UpdateApproveReject(1)" class="btn btn-primary col-md-11" value="APPROVED" style="font-size:11px;padding-left:0px !important;padding-right:0px !important;margin-top:3px;margin-left:0px !important;width: 100px;    height: 25px;" />
                                    </div>
                                    <div style="left: 35px;" class="col-md-2 control-label">
                                        <input type="button" id="btnSubmit" onclick="UpdateRejectMessage(4,$('.PendingMessage').last())" class="btn btn-primary col-md-11" value="Submit" style="font-size:11px;padding-left:0px !important;padding-right:0px !important;margin-top:3px;margin-left:-40px !important" />
                                    </div>
                                </div>
                            }
                            else if ((data != null && data.IsRejacted == true && data.CreatedByChild != Model.USERID))
                            {


                                <div class="col-md-12">
                                    @*<input type="hidden" id="hdnCustomerId" name="hdnCustomerId" value="@Model.CustomerTransactionItems.FirstOrDefault().CustomerId" />*@
                                    <div class="col-md-2 control-label">
                                        Note :<span class="required"> * </span>
                                    </div>
                                    <div class="col-md-6 control-label">
                                        <textarea class="form-control input-sm PendingMessage" style="resize: none;overflow-x: hidden;" rows="3" id="txtNote"></textarea>
                                    </div>
                                    <div class="col-md-2 control-label MainAdmins" style="margin-top: 30px;">
                                        <input type="button" id="btnReject" onclick="UpdateApproveReject(2)" class="btn btn-primary col-md-11" value="REJECTED" style="margin-bottom:3px;font-size:11px;margin-top:3px;margin-left:5px !important;width: 100px;    height: 25px;" />
                                    </div>
                                    <div class="col-md-2 control-label MainAdmins" style="margin-top: 30px;right: 40px;">
                                        <input type="button" id="btnApprove" onclick="UpdateApproveReject(1)" class="btn btn-primary col-md-11" value="APPROVED" style="font-size:11px;padding-left:0px !important;padding-right:0px !important;margin-top:3px;margin-left:0px !important;width: 100px;    height: 25px;" />
                                    </div>
                                    <div style="left: 35px;" class="col-md-2 control-label">
                                        <input type="button" id="btnSubmit" onclick="UpdateRejectMessage(4,$('.PendingMessage').last())" class="btn btn-primary col-md-11" value="Submit" style="font-size:11px;padding-left:0px !important;padding-right:0px !important;margin-top:3px;margin-left:-40px !important" />
                                    </div>
                                </div>
                            }
                            else if ((data != null && data.IsRejacted == false && data.CreatedByChild != Model.USERID))
                            {
                                <div class="col-md-12">
                                    @*<input type="hidden" id="hdnCustomerId" name="hdnCustomerId" value="@Model.CustomerTransactionItems.FirstOrDefault().CustomerId" />*@
                                    <div class="col-md-2 control-label">
                                        Note :<span class="required"> * </span>
                                    </div>
                                    <div class="col-md-6 control-label">
                                        <textarea class="form-control input-sm PendingMessage" style="resize: none;overflow-x: hidden;" rows="3" id="txtNote"></textarea>
                                    </div>
                                    <div class="col-md-2 control-label MainAdmins" style="margin-top: 30px;">
                                        <input type="button" id="btnReject" onclick="UpdateApproveReject(2)" class="btn btn-primary col-md-11" value="REJECTED" style="margin-bottom:3px;font-size:11px;margin-top:3px;margin-left:5px !important;width: 100px;    height: 25px;" />
                                    </div>
                                    <div class="col-md-2 control-label MainAdmins" style="margin-top: 30px;right: 40px;">
                                        <input type="button" id="btnApprove" onclick="UpdateApproveReject(1)" class="btn btn-primary col-md-11" value="APPROVED" style="font-size:11px;padding-left:0px !important;padding-right:0px !important;margin-top:3px;margin-left:0px !important;width: 100px;    height: 25px;" />
                                    </div>
                                    <div style="left: 35px; display:none;" class="col-md-2 control-label">
                                        <input type="button" id="btnSubmit" onclick="UpdateRejectMessage(4,$('.PendingMessage').last())" class="btn btn-primary col-md-11" value="Submit" style="font-size:11px;padding-left:0px !important;padding-right:0px !important;margin-top:3px;margin-left:-40px !important" />
                                    </div>
                                </div>
                            }
                            else
                            {
                                <div class="col-md-12">
                                    @*<input type="hidden" id="hdnCustomerId" name="hdnCustomerId" value="@Model.CustomerTransactionItems.FirstOrDefault().CustomerId" />*@
                                    <div class="col-md-2 control-label">
                                        Note :<span class="required"> * </span>
                                    </div>
                                    <div class="col-md-6 control-label">
                                        <textarea class="form-control input-sm PendingMessage" style="resize: none;overflow-x: hidden;" rows="3" id="txtNote"></textarea>
                                    </div>
                                    <div class="col-md-2 control-label MainAdmins" style="margin-top: 30px;">
                                        <input type="button" id="btnReject" onclick="UpdateApproveReject(2)" class="btn btn-primary col-md-11" value="REJECTED" style="margin-bottom:3px;font-size:11px;margin-top:3px;margin-left:5px !important;width: 100px;    height: 25px;" />
                                    </div>
                                    <div class="col-md-2 control-label MainAdmins" style="margin-top: 30px;right: 40px;">
                                        <input type="button" id="btnApprove" onclick="UpdateApproveReject(1)" class="btn btn-primary col-md-11" value="APPROVED" style="font-size:11px;padding-left:0px !important;padding-right:0px !important;margin-top:3px;margin-left:0px !important;width: 100px;    height: 25px;" />
                                    </div>
                                    <div style="left: 35px; display:none;" class="col-md-2 control-label">
                                        <input type="button" id="btnSubmit" onclick="UpdateRejectMessage(4,$('.PendingMessage').last())" class="btn btn-primary col-md-11" value="Submit" style="font-size:11px;padding-left:0px !important;padding-right:0px !important;margin-top:3px;margin-left:-40px !important" />
                                    </div>
                                </div>
                            }

                        }
                        else
                        {
                            <div class="col-md-12">
                                @*<input type="hidden" id="hdnCustomerId" value="@Model.CustomerTransactionItems.FirstOrDefault().CustomerId" />*@
                                <div class="col-md-2 control-label">
                                    Note :<span class="required"> * </span>
                                </div>
                                <div class="col-md-6 control-label">
                                    <textarea class="form-control input-sm PendingMessage" style="resize: none;overflow-x: hidden;" rows="3" id="txtNote"></textarea>
                                </div>
                                <div class="col-md-2 control-label MainAdmins" style="margin-top: 30px;">
                                    <input type="button" id="btnReject" onclick="UpdateApproveReject(2)" class="btn btn-primary col-md-11" value="REJECTED" style="margin-bottom:3px;font-size:11px;margin-top:3px;margin-left:5px !important;width: 100px;    height: 25px;" />
                                </div>
                                <div class="col-md-2 control-label MainAdmins" style="  margin-top: 30px;right: 40px;">
                                    <input type="button" id="btnApprove" onclick="UpdateApproveReject(1)" class="btn btn-primary col-md-11" value="APPROVED" style="font-size:11px;padding-left:0px !important;padding-right:0px !important;margin-top:3px;margin-left:0px !important;width: 100px;    height: 25px;" />
                                </div>
                                <div style="left: 35px;" class="col-md-2 control-label">
                                    <input type="button" id="btnSubmit" onclick="UpdateRejectMessage(4,$('.PendingMessage').last())" class="btn btn-primary col-md-11" value="Submit" style="font-size:11px;padding-left:0px !important;padding-right:0px !important;margin-top:3px;margin-left:-40px !important" />
                                </div>
                            </div>
                        }

                    </div>
                    <div style="clear:both;"></div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    $('#modal_invoiceedit .ccurrency').inputmask("currency", {
        alias: 'currency',
        prefix: '$ ',
        digits: 2,
        autoUnmask: true,
        removeMaskOnSubmit: true,
        unmaskAsNumber: true,
        allowPlus: false,
        allowMinus: false,
        autoGroup: true,
        groupSeparator: ",",
    });



    function UpdateApproveReject(status) {
        if ($('#txtNote').val().trim() == '') {
            $('#txtNote').css('border-color', 'red');
            return false;
        } else { $('#txtNote').css('border-color', ''); }

        var Id = $("#hdnCustomerId").val();
        if (Id > 0) {

            $.ajax({
                url: '@Url.Action("UpdateApproveReject", "AccountReceivable")',
                dataType: "json",
                data: { CustomerId: Id, Note: $("#txtNote").val(), Status: status, MasterTmpTrxId: $("#hdnMasterTmpTrxId").val() },
                traditional: true,
                contentType: "application/json; charset=utf-8",
                success: function () {
                    window.location.href = window.location.href;
                },
                error: function () { }
            });
        }
        }

    function UpdateRejectMessage(status,ctl) {

            if ($(ctl).val().trim() == '') {
                $(ctl).css('border-color', 'red');
            return false;
            } else { $(ctl).css('border-color', ''); }

            var Id = $("#hdnCustomerId").val();
            if (Id > 0) {

                $.ajax({
                    url: '@Url.Action("UpdateApproveReject", "AccountReceivable")',
                    dataType: "json",
                    data: { CustomerId: Id, Note: $(ctl).val(), Status: status, MasterTmpTrxId: $("#hdnMasterTmpTrxId").val() },
                    traditional: true,
                    contentType: "application/json; charset=utf-8",
                    success: function () {
                        window.location.href = window.location.href;
                    },
                    error: function () { }
                });
            }
    }


    function UpdateApproveonly() {
        var sURL = '@Url.Action("GenerateInvoiceByIDOnly", "AccountReceivable", new { area = "Portal" })?Id=' + $("#hdnMasterTmpTrxId").val() + '&note=' + $("#txtNote").val() + '&CustomerId=' + $("#hdnCustomerId").val();
                $.ajax(
                {
                    type: "GET", //HTTP POST Method
                    url: sURL, // Controller/View
                    success: function (res) {
                        bindInvoiceList();
                    },
                    error: function (err) {
                        alert('failure');
                    },
                });
    }


    function applyMaskNumber(id) {
        $(id).inputmask("numeric", {
            autoUnmask: true,
            removeMaskOnSubmit: true,
            oncleared: function () { self.Value(''); }
        });
    }
    $('.unitPrice').keyup(function () {
        var fieldId = $(this).attr('id');
        fieldId = fieldId.replace('txtunitprice', '');
        //unitPrice
        $('#hdfunitprice' + fieldId).val($('#txtunitprice' + fieldId).val());
    });

</script>