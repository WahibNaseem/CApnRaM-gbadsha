<style>
    .cls-center {
        text-align: center;
    }

    .cls-left {
        text-align: left;
    }

    .cls-right {
        text-align: right;
    }
</style>
<div class="modal fade custom-model custom-form-design" id="modal_OtherDepositePopupDetail" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
    <div class="modal-dialog" style="width:785px">
        <div class="modal-content" style="border-radius: 8px;">
            <div class="modal-header headerbox list" style="padding:0px!important;border-bottom: none;">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="margin-top: 12px !important;margin-right: 12px !important;"></button>
                <h4 class="modal-title" style="text-align:center;margin-top: 0px; margin-bottom: 0px;  padding: 7px!important;font-size: 12px;font-weight: bold;background: #337ab7 !important;color: #FFF !important;border: 1px solid #337ab7 !important;padding: 0px;border-radius: 8px 8px 0 0;text-transform: uppercase;">
                    Other Deposits
                </h4>
            </div>
            <div class="modal-header headerbox list" style="padding:0px!important;border-bottom: none;background: #3598DC !important;color: #FFF !important;border: 1px solid #3598DC !important;padding: 0px;">
                <div class="row">
                    <div class="col-md-12">
                        <div class="col-md-2">
                            <label class="mt-radio">
                                <input type="radio" onclick="searchOnChangeOD(13)" name="OptType" id="OptOthersPayaee" value="13" checked="checked">Others Payee
                                <span></span>
                            </label>
                        </div>
                        <div class="col-md-2">
                            <label class="mt-radio">
                                <input type="radio" onclick="searchOnChangeOD(2)" name="OptType" id="OptFranchisee" value="2"> Franchisee
                                <span></span>
                            </label>
                        </div>
                        <div class="col-md-2">
                            <label class="mt-radio">
                                <input type="radio" onclick="searchOnChangeOD(1)" name="OptType" id="OptCustomer" value="1">Customer
                                <span></span>
                            </label>
                        </div>
                        <div class="col-md-6">
                            <input class="form-control input-sm" id="OD_inputSerach" name="" type="text" value="" placeholder="Name or Number">
                        </div>
                    </div>
                </div>
            </div>
            <div class="custom-form portlet light" id="">
                <div class="portlet-body">
                    @using (Html.BeginForm("", "", FormMethod.Post, new { @id = "", @role = "form", @class = "form form-horizontal", style = "margin: 0px;" }))
                    {
                        <div class="row" style="padding-bottom:15px;">
                            <div class="col-md-12">
                                <label class="control-label col-md-2" style="font-weight:600;">
                                    Payee Name:<span style="color:red">*</span>
                                </label>
                                <div class="col-md-4">
                                    <input class="form-control input-sm" id="OD_txtPayeeName" name="OD_txtPayeeName" type="text" value="">
                                    <input type="hidden" name="OD_txtPayeeId" id="OD_txtPayeeId" value="" />
                                    <input type="hidden" name="OD_txtPayeeType" id="OD_txtPayeeType" value="" />
                                </div>

                                <label class="control-label col-md-2" style="font-weight:600;">
                                    Payee Number:
                                </label>
                                <div class="col-md-4">
                                    <input class="form-control input-sm" id="OD_txtPayeeNumber" name="OD_txtPayeeNumber" type="text" value="">
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12">
                                <hr style="margin-top:10px;margin-bottom: 10px;" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <label class="control-label col-md-3" style="font-weight:600;">
                                    Check/Reference No:<span style="color:red">*</span>
                                </label>
                                <div class="col-md-2">
                                    <input class="form-control input-sm" id="OD_txtReferenceNo" name="OD_txtReferenceNo" type="text" value="">
                                </div>

                                <label class="control-label col-md-1" style="font-weight:600;">
                                    Amount:<span style="color:red">*</span>
                                </label>
                                <div class="col-md-2">
                                    <input class="form-control input-sm" id="OD_txtAmount" name="OD_txtAmount" type="text" value="">
                                </div>

                                <label class="control-label col-md-1" style="font-weight:600;">
                                    Date:<span style="color:red">*</span>
                                </label>
                                <div class="col-md-2">
                                    <div class="input-group" data-date-format="mm/dd/yyyy">
                                        <input id="OD_txtDate" name="OD_txtDate" class="form-control input-sm date-picker" autocomplete="off" />
                                        <span class="input-group-btn cal-btn">
                                            <button class="btn default cal-btn" type="button">
                                                <i class="fa fa-calendar"></i>
                                            </button>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row" style="padding-bottom:20px;">
                            <div class="col-md-12">
                                <label class="control-label col-md-3" style="font-weight:600;">
                                    Deposit/Payment Type:<span style="color:red">*</span>
                                </label>
                                <div class="col-md-2">
                                    @Html.DropDownList("OD_ServiceTypeListIdTrans", (SelectList)ViewBag.ServiceTypeList, "Select", new { @class = "form-control input-sm", required = "required", @id = "OD_ServiceTypeListIdTrans" })

                                    @*<select class="form-control input-sm">
                                            <option value="0">-Select One-</option>
                                            <option value="1">Option 1</option>
                                            <option value="2">Option 2</option>
                                            <option value="3">Option 3</option>
                                        </select>*@
                                </div>
                                <label class="control-label col-md-1" style="font-weight:600;">
                                    Reason:<span style="color:red">*</span>
                                </label>
                                <div class="col-md-6">
                                    <input class="form-control input-sm" id="OD_txtReason" name="OD_txtReason" type="text" value="">
                                </div>
                            </div>
                        </div>

                        <div class="form-actions" style="padding:15px !important;padding-top:25px !important;text-align:center;">
                            <button type="button" class="btn btn-primary" id="OD_btnSave" style="margin-right: 22px;">
                                Save
                                <i class="fa fa-check"></i>
                            </button>
                            <button type="button" class="btn btn-primary button-next" id="OD_btnCancel" data-dismiss="modal" style="margin-right: 30px;">
                                Cancel
                                <i class="fa fa-angle-right"></i>
                            </button>
                        </div>
                    }

                </div>
            </div>

        </div>
    </div>
</div>
<script src="@Url.Content("~/Content/admin/assets/global/plugins/bootstrap-typeahead/bootstrap3-typeahead.min.js")" type="text/javascript"></script>
<script src="~/Scripts/jquery-ui.js" type="text/javascript"></script>
<script type="text/javascript">
        function searchIsValidOD() {
            var retVal = true;
            if ($('#OD_txtReferenceNo').val() == '')
                retVal = false;
            if ($('#OD_txtAmount').val() == '')
                retVal = false;
            if ($('#OD_txtDate').val() == '0' || $('#OD_txtDate').val()=='')
                retVal = false;
            if ($('#OD_txtReason').val() == '')
                retVal = false;
            return retVal;
        }

        function searchOnChangeOD(v) {
            if (v == 13) {
                applyAutoSeacrhComapnyOD(v);
            } else if (v == 2) {
                applyAutoSeacrhFranchiseeOD(v);
            } else if (v == 1) {
                applyAutoSeacrhCustomerOD(v);
            }
        }

        function applyAutoSeacrhCustomerOD(t) {
            $.blockUI()
            $('#OD_inputSerach').val('');
            $('#OD_txtPayeeType').val(t);
            $.ajax({
                type: "GET",
                url: '@Url.Action("GetAllCustomer", "Customer", new { area = "Portal" })',
                data: {},
                success: function (data) {
                    var typeaheadSource = [];
                    $.each(data, function (key, value) {
                        typeaheadSource.push({ id: value.CustomerId, name: value.CustomerNo + ' ' + $.trim(value.Name), number: value.CustomerNo, title: $.trim(value.Name)})
                    });
                    var box = $('#OD_inputSerach').data('typeahead');
                    if (box != null) {

                        console.log('csearch source change');
                        box.source = typeaheadSource;
                    }
                    else {
                        console.log('csearch initiated');
                        $('#OD_inputSerach').typeahead({
                            source: typeaheadSource,
                            updater: function (item) {
                                console.log(item);
                                $('#OD_txtPayeeId').val(item.id);
                                $('#OD_txtPayeeName').val(item.title);
                                $('#OD_txtPayeeNumber').val(item.number);
                               
                                return item;
                            },
                            minLength: 1
                        }).focus();
                    }
                }
            });
            $.unblockUI();
        }

        function applyAutoSeacrhFranchiseeOD(t) {
            $('#OD_inputSerach').val('');
            $('#OD_txtPayeeType').val(t);
            $.blockUI()
            $.ajax({
                type: "GET",
                url: '@Url.Action("GetAllFranchisees", "Franchise", new { area = "Portal" })',
                data: {},
                success: function (data) {
                    var typeaheadSource = [];
                    $.each(data, function (key, value) {
                        typeaheadSource.push({ id: value.FranchiseeId, name: value.FranchiseeNo + ' ' + value.Name, number: value.FranchiseeNo, title: $.trim(value.Name) })
                    });
                    var box = $('#OD_inputSerach').data('typeahead');
                    if (box != null) {

                        console.log('csearch source change');
                        box.source = typeaheadSource;
                    }
                    else {
                        $('#OD_inputSerach').typeahead({
                            source: typeaheadSource,
                            updater: function (item) {
                                console.log(item);
                                $('#OD_txtPayeeId').val(item.id);
                                $('#OD_txtPayeeName').val(item.title);
                                $('#OD_txtPayeeNumber').val(item.number);
                               
                                return item;
                            }, minLength: 1
                        }).focus();
                    }
                }
            });
            $.unblockUI();
        }

        function applyAutoSeacrhComapnyOD(t) {
            $('#OD_inputSerach').val('');
            $('#OD_txtPayeeType').val(t);
            $.blockUI()
            $.ajax({
                type: "GET",
                url: '@Url.Action("GetAllCompanies", "Company", new { area = "Portal" })',
                data: {},
                success: function (data) {
                    var typeaheadSource = [];
                    $.each(data, function (key, value) {
                        typeaheadSource.push({ id: value.CompanyId, name: value.Name, number: '', title: $.trim(value.Name) })
                    });
                    var box = $('#OD_inputSerach').data('typeahead');
                    if (box != null) {

                        console.log('csearch source change');
                        box.source = typeaheadSource;
                    }
                    else {
                        $('#OD_inputSerach').typeahead({
                            source: typeaheadSource,
                            updater: function (item) {
                                console.log(item);
                                $('#OD_txtPayeeId').val(item.id);
                                $('#OD_txtPayeeName').val(item.title);
                                $('#OD_txtPayeeNumber').val(item.number);
                                return item;
                            }, minLength: 1
                        }).focus();
                    }
                }
            });
            $.unblockUI();
        }
</script>

