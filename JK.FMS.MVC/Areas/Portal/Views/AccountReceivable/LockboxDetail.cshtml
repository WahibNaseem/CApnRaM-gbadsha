@model List<JKViewModels.AccountReceivable.LockboxEDIDataViewModel>

@{
    ViewBag.Title = "LockboxFileSummary";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section styles{
    <style type="text/css">
        .lbl-p5 {
            padding: 3px;
        }

            .lbl-p5.red {
                color: red;
            }

            .lbl-p5.green {
                color: lightgreen;
            }

        tr > td {
            font-size: 11px !important;
            padding: 4px !important;
        }

        /*tr > th {
            font-size: 11px !important;
            text-transform: uppercase;
        }*/

        .row {
            margin: 0;
            padding: 5px 0;
        }

        .opendiv {
            padding: 4px;
            background-color: gold;
            text-align: center;
            font-weight: bold;
            color: #ffffff;
        }

        .closeddiv {
            padding: 4px;
            background-color: limegreen;
            text-align: center;
            font-weight: bold;
            color: #ffffff;
        }

        .overpaiddiv {
            padding: 4px;
            background-color: deepskyblue;
            text-align: center;
            font-weight: bold;
            color: #ffffff;
        }

        .overduediv {
            padding: 4px;
            background-color: orangered;
            text-align: center;
            font-weight: bold;
            color: #ffffff;
        }

        .btn {
            padding: 3px 12px;
            font-size: 12px;
        }

        #lockboxsummaryListUnmatched thead th,
        #lockboxsummaryList thead th,
        #invoiceList thead th {
            font-size: 11px !important;
            text-transform: uppercase;
            padding: 5px !important;
        }

        #lockboxsummaryListUnmatched tbody td,
        #lockboxsummaryList tbody td,
        #invoiceList tbody td {
            font-size: 11px !important;
            text-transform: uppercase;
            padding: 5px !important;
        }

        .custom-listbox .headerbox {
            padding: 0px !important;
            border-radius: 0px !important;
        }

        .lbl-p5 {
            padding: 5px;
        }

            .lbl-p5.red {
                color: red;
            }

            .lbl-p5.green {
                color: lightgreen;
            }

        input[type="text"].txtcolon:before {
            content: ": ";
        }

        .payment-field {
            width: 80px !important;
            text-align: right;
        }

        #invoiceList1_filter input {
            min-width: 200%;
        }

        #invoiceList1_filter {
            text-align: left;
            width: 100%;
        }

            #invoiceList1_filter a {
                display: none;
            }

        .sweet-alert {
            z-index: 59999;
        }
    </style>
}



<form class="form-horizontal" action="@Url.Action("LockboxDetail", "AccountReceivable", new { area = "Portal" })" id="from_lockboxsummary" method="POST">
    <div class="custom-form portlet light">
        <div class="headerbox">
            <div class="row">
                &nbsp; LockboxEDIId <input type="hidden" name="hfLockboxEDIId" id="hfLockboxEDIId" value="" />
                <input type="hidden" name="hfLockboxEDIDate" id="hfLockboxEDIDate" value="" />
                <input type="hidden" name="hfSaveValue" id="hfSaveValue" value="" />
                <input type="hidden" name="hflockboxsummaryListDepositCount" id="hflockboxsummaryListDepositCount" value="0" />
            </div>
        </div>
        <div class="portlet-body form">
            <div class="form-body">
                <div class="row">
                    <div class="col-md-2">Date Transmit:</div>
                    <div class="col-md-2"><input type="text" readonly class="form-control input-sm" value="" id="txtVDateTransmit" name="txtVDateTransmit" /></div>
                    <div class="col-md-2">Total number of Check:</div>
                    <div class="col-md-2"><input type="text" readonly class="form-control input-sm" value="" id="txtVTotalnumberofCheck" name="txtVTotalnumberofCheck" /></div>
                    <div class="col-md-2">Total Lockbox Amount:</div>
                    <div class="col-md-2"><input type="text" readonly class="form-control input-sm inputAmt" value="" id="txtVTotalLockboxAmount" name="txtVTotalLockboxAmount" /></div>
                </div>
                <div class="row">
                    <div class="col-md-2">Region Name:</div>
                    <div class="col-md-2"><input type="text" readonly class="form-control input-sm" value="" id="txtVRegionName" name="txtVRegionName" /></div>
                    <div class="col-md-2">Total number of Invoice:</div>
                    <div class="col-md-2"><input type="text" readonly class="form-control input-sm" value="" id="txtVTotalnumberofInvoice" name="txtVTotalnumberofInvoice" /></div>
                    <div class="col-md-2">Total Amount to Apply:</div>
                    <div class="col-md-2">
                        <input type="text" readonly class="form-control input-sm inputAmt" value="" id="txtVTotalAmountoApplyT" name="txtVTotalAmountoApplyT" />
                        <input type="hidden" value="0" id="txtVTotalAmountoApply" name="txtVTotalAmountoApply" />
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-2">LockBox ID:</div>
                    <div class="col-md-2"><input type="text" readonly class="form-control input-sm" value="" id="txtVLockBoxID" name="txtVLockBoxID" /></div>
                    <div class="col-md-2"></div>
                    <div class="col-md-2"></div>
                    <div class="col-md-2">Total Amount Execption:</div>
                    <div class="col-md-2"><input type="text" readonly class="form-control input-sm inputAmt" value="" id="txtVTotalAmountExecption" name="txtVTotalAmountExecption" /></div>
                </div>
                <div class="row" style="display:none;">
                    <div class="col-md-2"></div>
                    <div class="col-md-2"></div>
                    <div class="col-md-2"></div>
                    <div class="col-md-2"></div>
                    <div class="col-md-2">Total Customer Credit:</div>
                    <div class="col-md-2"><input type="text" readonly class="form-control input-sm inputAmt" value="" id="txtVTotalAmountCustomerCredit" name="txtVTotalAmountCustomerCredit" /></div>
                </div>

                <div class="col-md-12">
                    <div class="col-md-12" style="background-color: #3698dc;padding: 5px 15px;text-align: center;color: #fff;font-size: 18px;text-transform: uppercase;">
                        Invoice Payment
                    </div>
                </div>
                <div class="row">

                    <div class="col-md-12">
                        <div class="dataTables_wrapper no-footer">
                            <div class="table-responsive">
                                <table class="table table-striped table-bordered table-hover order-column dataTable no-footer" id="lockboxsummaryList" role="grid">
                                    <thead>
                                        <tr role="row">
                                            <th style="width:24px;text-align:center;">@*<input rel="mgglchkALL" type="checkbox" name="name"  class="chk" />*@</th>
                                            <th style="text-align:center;width:100px;">Check No</th>
                                            <th style="text-align:center;width:100px;">Check Amount</th>
                                            <th style="text-align:center;width:100px;">Customer No</th>
                                            <th style="text-align:center;width:185px;">Customer Name</th>
                                            <th style="text-align:center;width:100px;">Invoice No</th>
                                            <th style="text-align:center;width:120px;">Invoice Date</th>
                                            <th style="text-align:center;width:120px;">Invoice Amount</th>
                                            <th style="text-align:center;width:120px;">Curent Invoice Balance</th>
                                            <th style="text-align:center;width:120px;">Apply Amount</th>
                                            <th style="text-align:center;width:120px;">New Invoice Balance</th>
                                            <th style="text-align:center;width:80px;">Over Payment</th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                    <tfoot>
                                        <tr role="row">
                                            <th style="width:24px;text-align:center;"></th>
                                            <th style="text-align:center;width:100px;"></th>
                                            <th style="text-align:center;width:100px;"></th>
                                            <th style="text-align:center;width:100px;"></th>
                                            <th style="text-align:center;width:185px;"></th>
                                            <th style="text-align:center;width:100px;"></th>
                                            <th style="text-align:center;width:120px;font-weight:bold;">Total</th>
                                            <th style="text-align:right;width:120px;">$<span id="lockboxsummaryList_InvoiceAmount">0</span></th>
                                            <th style="text-align:center;width:120px;"></th>
                                            <th style="text-align:right;width:120px;">$<span id="lockboxsummaryList_ApplyAmount">0</span></th>
                                            <th style="text-align:center;width:120px;"></th>
                                            <th style="text-align:right;width:80px;"><span id="lockboxsummaryList_OverPayment">0</span></th>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <br />
                <div class="col-md-12">
                    <div class="col-md-12" style="background-color: #3698dc;padding: 5px 15px;text-align: center;color: #fff;font-size: 18px;text-transform: uppercase;">
                        Other Deposits
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="dataTables_wrapper no-footer">
                            <div class="table-responsive">
                                <table class="table table-striped table-bordered table-hover order-column dataTable no-footer" id="lockboxsummaryListDeposit" role="grid">
                                    <thead>
                                        <tr role="row">
                                            <th style="width:24px;text-align:center;"></th>
                                            <th style="text-align:center;width:100px;">Check No</th>
                                            <th style="text-align:center;width:100px;">Check Amount</th>
                                            <th style="text-align:center;width:100px;">Payee No</th>
                                            <th style="text-align:center;">Payee Name</th>
                                            <th style="text-align:center;">Reason</th>
                                            <th style="text-align:center;width:120px;">Apply Amount</th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                    <tfoot>
                                        <tr role="row">
                                            <th colspan="5"></th>
                                            <th style="text-align:right;width:120px;font-weight:bold;">Total</th>
                                            <th style="text-align:right;width:80px;">$<span id="lockboxsummaryListDeposit_OtherDeposit">0</span></th>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <br />
                <div class="col-md-12">
                    <div class="col-md-12" style="background-color: #3698dc;padding: 5px 15px;text-align: center;color: #fff;font-size: 18px;text-transform: uppercase;">
                        Total Deposits
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="dataTables_wrapper no-footer">
                            <div class="table-responsive">
                                <table class="table table-striped table-bordered table-hover order-column dataTable no-footer" id="lockboxsummaryListTotalDeposit" role="grid">
                                    <tfoot>
                                        <tr role="row">
                                            <th style="width:24px;text-align:center;"></th>
                                            <th style="text-align:center;width:100px;"></th>
                                            <th style="text-align:center;width:185px;"></th>
                                            <th style="text-align:center;width:100px;"></th>
                                            <th style="text-align:right;width:120px;font-weight:bold;font-size: 16px!important;">Total Deposit</th>
                                            <th style="text-align:right;width:80px;font-size: 16px!important;">$<span id="lockboxsummaryListTotalDeposit_TotalDeposit">0</span></th>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <input type="hidden" name="name" value="" />
                <div class="row">
                    <div class="col-md-12">
                        <input type="button" class="btn btn-primary pull-right" name="btnProcess" style="margin-right:10px;" id="btnProcessPayment_OnSubmit" value="Process Payment" @((Model.Where(m => m.StatusListId == 50).Count() > 0 || Model.Where(m => m.StatusListId == 52).Count() > 0) ? "disabled" : "") />
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="dataTables_wrapper no-footer">
                            <div class="table-responsive">
                                <table class="table table-striped table-bordered table-hover order-column dataTable no-footer" id="lockboxsummaryListUnmatched" role="grid">
                                    <thead>
                                        <tr role="row">
                                            <th style="width:24px;text-align:center;"></th>
                                            <th style="text-align:center;width:100px;">Check No</th>
                                            <th style="text-align:center;width:100px;">Check Amount</th>
                                            <th style="text-align:center;width:100px;">Customer No</th>
                                            <th style="text-align:center;width: 185px;">Customer Name</th>
                                            <th style="text-align:center;width:100px;">Invoice No</th>
                                            <th style="text-align:center;width:120px;">Invoice Date</th>
                                            <th style="text-align:center;width:120px;">Invoice Amount</th>
                                            <th style="text-align:center;width:120px;">Available Apply Amount</th>
                                            <th style="text-align:center;width:30px;"></th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <input type="button" class="btn btn-primary pull-right" name="btnSave" style="margin-right:10px;" id="btnProcessPayment_OnSaveforLater" value="Save for Later" @(Model.Where(m => m.StatusListId == 50).Count() > 0 ? "" : "disabled") />
                    </div>
                </div>
            </div>
        </div>
    </div>





    <div class="modal fade custom-model custom-form-design" id="modal_lockboxview_error_detail" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
        <div class="modal-dialog" style="width:1250px">
            <div class="modal-content" style="border-radius: 8px;">
                <div class="modal-header headerbox list" style="padding:0px!important;border-bottom: none;">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="margin-top: 12px !important;margin-right: 12px !important;"></button>
                    <h4 class="modal-title" style="margin-top: 0px; margin-bottom: 4px;  padding: 7px!important;font-size: 12px;font-weight: bold;background: #3598DC !important;color: #FFF !important;border: 1px solid #3598DC !important;padding: 0px;border-radius: 8px 8px 0 0;text-transform: uppercase;">
                        LockBox View Detail
                    </h4>
                </div>
                <div class="modal-body" style="padding: 0px 15px 15px 15px;">
                    <div class="row">
                        <div class="col-md-12">
                            <table class="table table-striped table-bordered table-hover order-column table-responsive" id="tblviewdetailH" width="100%">
                                <thead>
                                    <tr>
                                        <th style="text-align:center">Bank Name</th>
                                        <th style="text-align:center">Bank Account</th>
                                        <th style="text-align:center;width:150px;">Check No.</th>
                                        <th style="text-align:center;width:150px;">Check Amount</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td style="text-align:center"><span id="spnEBankName"></span></td>
                                        <td style="text-align:center"><span id="spnEBankAccount"></span></td>
                                        <td style="text-align:center"><span id="spnECheckNo"></span></td>
                                        <td style="text-align:right">$ <span id="spnELockboxAmount"></span></td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td></td>
                                        <td style="text-align:center">Apply Amount</td>
                                        <td style="text-align:center"><input type="text" name="txtEApplyAmount" id="txtEApplyAmount" readonly value="0" /></td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td></td>
                                        <td style="text-align:center">Balance</td>
                                        <td style="text-align:center"><input type="text" name="txtEBalanceAmount" id="txtEBalanceAmount" readonly value="0" /></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12" id="divtblviewdetail">
                            <table class="table table-striped table-bordered table-hover order-column table-responsive" id="tblviewdetail" width="100%">
                                <thead>
                                    <tr>
                                        <th style="text-align:center">Customer No.</th>
                                        <th style="text-align:center">Customer Name</th>
                                        <th style="text-align:center">Invoice No.</th>
                                        <th style="text-align:center;width:150px;">Invoice Amount</th>
                                        <th style="text-align:center;width:150px;">Apply Amount</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>

                    <div class="row" id="divInvoiceListSelected">
                        <div class="col-md-12">
                            <h3 style="margin-top: 0px; margin-bottom: 4px;  padding: 7px!important;font-size: 12px;font-weight: bold;background: #3598DC !important;color: #FFF !important;border: 1px solid #3598DC !important;padding: 0px;text-transform: uppercase;">
                                Selected Invoices
                            </h3>
                        </div>
                        <div class="col-md-12">
                            <div class="tablebox">
                                <table class="table table-striped table-bordered table-hover order-column" id="invoiceListSelected">
                                    <thead>
                                        <tr>
                                            <th class="tblInvoice_chk" style="text-align:center; width: 30px"></th>
                                            <th class="tblInvoice_customerNo" style="width:70px;text-align:center;">
                                                Customer No.
                                            </th>
                                            <th class="tblInvoice_customerName" style="width:180px;text-align:center;">
                                                Customer Name
                                            </th>
                                            <th class="tblInvoice_invoiceNo" style="width:80px;text-align:center;">
                                                Invoice No
                                            </th>
                                            <th class="tblInvoice_invoiceDate" style="width:80px;text-align:center;">
                                                Invoice Date
                                            </th>
                                            <th class="tblInvoice_invoiceDesc" style="width:220px;text-align:center;">
                                                Invoice Description
                                            </th>
                                            <th class="tblInvoice_invoiceAmt" style="text-align:center;width:60px;">
                                                Inv. Amount
                                            </th>
                                            <th class="tblInvoice_invoiceAmt" style="text-align:center;width:60px;">
                                                Current Balance
                                            </th>
                                            <th class="tblInvoice_payment" style="text-align:center;width:60px;">
                                                Payment Apply
                                            </th>
                                            <th class="tblInvoice_balance" style="text-align:center;width:60px;">
                                                New Balance
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-1"></div><div id="divrightckbox1" class="col-md-4"></div>
                        <div id="divrightckbox" class="col-md-4 pull-right text-center">

                        </div>
                    </div>



                    <div class="form-group" style="margin: 0px !important;">
                        <div class="row" style="background-color: #4b85cc;color: #fff;padding-top:8px;padding-bottom:8px">
                            <div class="col-md-12">
                                <div class="col-md-3">
                                    <div class="input-icon">
                                        <i class="icon-magnifier icon-align-right" style="margin-top: 8px;"></i>
                                        <input type="text" placeholder="Search..." class="form-control input-sm typeahead" value="" autocomplete="off" id="input_SearchMP" />
                                    </div>
                                    <div id="container">
                                    </div>
                                </div>
                                <div class="col-md-1">
                                    <label class="mt-checkbox" style="margin-bottom: 0px;">
                                        <input type="checkbox" id="chkIsOpen" class="search-field" checked>Open
                                        <span></span>
                                    </label>
                                </div>
                                <div class="col-md-1">
                                    <label class="mt-checkbox" style="margin-bottom: 0px;">
                                        <input type="checkbox" id="chkIsClose" class="search-field" checked>Close
                                        <span></span>
                                    </label>
                                </div>
                                <div class="col-md-1">
                                    <label class="mt-checkbox" style="margin-bottom: 0px;">
                                        <input type="checkbox" id="chkIsConsolidated" class="search-field">Consolidated
                                        <span></span>
                                    </label>
                                </div>
                                <div class="col-md-5 pull-right no-padding" style="text-align:center;">
                                    <div class="col-md-6 no-padding" style="margin-left:30px;">
                                        <select id="select_dateRangeMP" class="form-control input-sm">
                                            <option value="1">This Week</option>
                                            <option value="2">This Week-to-date</option>
                                            <option value="3">This Month</option>
                                            <option value="4">This Month-to-date</option>
                                            <option value="5">This Quarter</option>
                                            <option value="6">This Quarter-to-date</option>
                                            <option value="7">This Fiscal Year</option>
                                            <option value="8">This Fiscal Year-to-date</option>
                                            <option value="9">Today</option>
                                            <option value="10">Yesterday</option>
                                            <option value="11">Last Week</option>
                                            <option value="12">Last Month</option>
                                            <option value="13">Last Quarter</option>
                                            <option value="14">Last Year</option>
                                            <option value="15">Custom Date</option>
                                            <option value="16">Period</option>
                                            <option value="17" selected="selected">Last 90 Days</option>
                                        </select>
                                    </div>
                                    <div class="col-md-5 divspandate no-padding" style="margin-top: 7px; margin-left: 0px; display: block; float: right;">
                                        <span id="spnStartDate"></span> - <span id="spnEndtDate"></span>
                                    </div>
                                    <div class="col-md-3 no-padding" style="margin-left: 3px; width: 80px; display: none;" id="divSD">
                                        <input type="text" name="txtStartDate" id="txtStartDate" value="" class="form-control input-sm date-picker RemovePeriodvalidation" style="padding: 3px;" />
                                    </div>
                                    <div class="col-md-3 no-padding" style="margin-left: 3px; width: 80px; display: none;" id="divED">
                                        <input type="text" name="txtEndtDate" id="txtEndtDate" value="" class="form-control input-sm date-picker RemovePeriodvalidation" style="padding: 3px;" />
                                    </div>
                                    <div class="col-md-3 no-padding" style="margin-left: 3px; width: 100px; display: none;" id="divmonth">
                                        <select id="lbmonthlist" class="form-control input-sm">
                                            <option value="">Month</option>
                                            <option value="1">Jan</option>
                                            <option value="2">Feb</option>
                                            <option value="3">Mar</option>
                                            <option value="4">Apr</option>
                                            <option value="5">May</option>
                                            <option value="6">June</option>
                                            <option value="7">July</option>
                                            <option value="8">Aug</option>
                                            <option value="9">Sep</option>
                                            <option value="10">Oct</option>
                                            <option value="11">Nov</option>
                                            <option value="12">Dec</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3 no-padding" style="margin-left: 3px; width: 100px; display: none;" id="divyear">
                                        <select class="form-control input-sm" id="lbyearlist" style="padding-left: 2px;">
                                            <option value="">Year</option>
                                            <option value="2018">2018</option>
                                            <option value="2017">2017</option>
                                            <option value="2016">2016</option>
                                            <option value="2015">2015</option>
                                            <option value="2014">2014</option>
                                            <option value="2013">2013</option>
                                            <option value="2012">2012</option>
                                            <option value="2011">2011</option>
                                            <option value="2010">2010</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row" id="divtblviewdetail_invoicelist">
                        <div class="col-md-12">
                            <div class="table-responsive">
                                <table class="table table-striped table-bordered table-hover order-column" id="invoiceList1">
                                    <thead>
                                        <tr>
                                            <th class="tblInvoice_chk" style="text-align:center; width: 30px">
                                            </th>
                                            <th class="tblInvoice_customerNo" style="width:70px;text-align:center;">
                                                Customer No.
                                            </th>
                                            <th class="tblInvoice_customerName" style="width:180px;text-align:center;">
                                                Customer Name
                                            </th>
                                            <th class="tblInvoice_invoiceNo" style="width:80px;text-align:center;">
                                                Invoice No
                                            </th>
                                            <th class="tblInvoice_invoiceDate" style="width:80px;text-align:center;">
                                                Invoice Date
                                            </th>
                                            <th class="tblInvoice_invoiceDesc" style="width:220px;text-align:center;">
                                                Invoice Description
                                            </th>
                                            <th class="tblInvoice_invoiceAmt" style="text-align:center;width:60px;">
                                                Inv. Amount
                                            </th>
                                            <th class="tblInvoice_invoiceAmt" style="text-align:center;width:60px;">
                                                Current Balance
                                            </th>
                                            @*<th class="tblInvoice_payment" style="text-align:center;width:60px;">
                                                    Payment Apply
                                                </th>
                                                <th class="tblInvoice_balance" style="text-align:center;width:60px;">
                                                    New Balance
                                                </th>*@
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade custom-model custom-form-design" id="modal_lockboxview_error_detailconfirm" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
        <div class="modal-dialog" style="width:450px;top: 150px;">
            <div class="modal-content" style="border-radius: 8px;">
                <div class="modal-header headerbox list" style="padding:0px!important;border-bottom: none;">
                    <h4 class="modal-title" style="margin-top: 0px; margin-bottom: 4px;  padding: 7px!important;font-size: 12px;font-weight: bold;background: #3598DC !important;color: #FFF !important;border: 1px solid #3598DC !important;padding: 0px;border-radius: 8px 8px 0 0;text-transform: uppercase;">
                        &nbsp;
                    </h4>
                </div>
                <div class="modal-body" style="padding: 0px 15px 15px 15px;">
                    <div class="row">
                        <div class="col-lg-12" style="text-align:center;">
                            <h4>Do you want to apply partial payment against invoice No. <span id="spninvoicenumber_err_detail"></span>?</h4>
                        </div>
                    </div>
                    <br />

                    <div class="row">
                        <div class="form-actions">

                            <div class="col-md-12" style="text-align:center;">
                                <input type="hidden" id="hdf_errlockbox_detail_Invoiceid" name="hdf_errlockbox_detail_Invoiceid" value="" />
                                <input type="hidden" id="hdf_errlockbox_detail_InvoiceChequeno" name="hdf_errlockbox_detail_InvoiceChequeno" value="" />

                                <button type="button" class="btn btn-primary button-next" onclick="btnOpenApplyPaymentFormYes()" style="margin-right:10px;">Yes</button>
                                <button type="button" class="btn btn-primary button-next" onclick="btnOpenApplyPaymentFormNo()" style="margin-right:10px;">No</button>
                            </div>

                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <div class="modal fade custom-model custom-form-design" id="modal_lockboxview_errorAmount_detailconfirm" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
        <div class="modal-dialog" style="width:400px;top: 150px;">
            <div class="modal-content" style="border-radius: 8px;">
                <div class="modal-header headerbox list" style="padding:0px!important;border-bottom: none;">
                    <h4 class="modal-title" style="margin-top: 0px; margin-bottom: 4px;  padding: 7px!important;font-size: 12px;font-weight: bold;background: #3598DC !important;color: #FFF !important;border: 1px solid #3598DC !important;padding: 0px;border-radius: 8px 8px 0 0;text-transform: uppercase;">
                        &nbsp;
                    </h4>
                </div>
                <div class="modal-body" style="padding: 0px 15px 15px 15px;">
                    <div class="row">
                        <div class="col-lg-12" style="text-align:center;">
                            <h3>No more credit available</h3>
                        </div>
                    </div>
                    <br />

                    <div class="row">
                        <div class="form-actions">

                            <div class="col-md-12" style="text-align:center;">

                                <button type="button" class="btn btn-primary button-next" data-dismiss="modal" onclick="" style="margin-right:10px;">OK</button>
                            </div>

                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div class="modal fade custom-model custom-form-design" id="modal_lockboxview_otherdeposite" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
        <div class="modal-dialog" style="top: 150px;">
            <div class="modal-content" style="border-radius: 8px;width:750px;">
                <div class="modal-header headerbox list" style="padding:0px!important;border-bottom: none;">
                    <h4 class="modal-title" style="margin-top: 0px; margin-bottom: 4px;  padding: 7px!important;font-size: 12px;font-weight: bold;background: #3598DC !important;color: #FFF !important;border: 1px solid #3598DC !important;padding: 0px;border-radius: 8px 8px 0 0;text-transform: uppercase;">
                        Other Deposites
                    </h4>
                </div>
                <div class="modal-body" style="padding: 0px 15px 15px 15px;">
                    <div class="row">
                        <div class="col-lg-12" style="text-align:center;">
                            <h3>Other Deposites</h3>
                        </div>
                    </div>
                    <br />

                    <div class="row">
                        <div class="form-actions">

                            <div class="col-md-12" style="text-align:center;">

                                <button type="button" class="btn btn-primary button-next" data-dismiss="modal" onclick="" style="margin-right:10px;">OK</button>
                            </div>

                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>



    <div id="divApplyPartialPayment"></div>
    <div class="form-horizontal" id="form_invoicedetail"></div>
</form>

<div class="modal fade custom-model custom-form-design" id="modal_lockboxview_detailPaid" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
    <div class="modal-dialog" style="width:1000px">
        <div class="modal-content" style="border-radius: 8px;" id="modal_lockboxview_detailPaidInner">
            <div class="modal-header headerbox list" style="padding:0px!important;border-bottom: none;">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="margin-top: 12px !important;margin-right: 12px !important;"></button>
                <h4 class="modal-title" style="margin-top: 0px; margin-bottom: 4px;  padding: 7px!important;font-size: 12px;font-weight: bold;background: #3598DC !important;color: #FFF !important;border: 1px solid #3598DC !important;padding: 0px;border-radius: 8px 8px 0 0;text-transform: uppercase;">
                    LockBox View Detail
                </h4>
            </div>
            <div class="modal-body" style="padding: 0px 15px 15px 15px;">
                <div class="row">
                    <div class="col-md-2">Date Transmit:</div>
                    <div class="col-md-2"><span class="form-control input-sm" id="txtDVDateTransmit"></span></div>
                    <div class="col-md-2">Region Bank:</div>
                    <div class="col-md-2"><span class="form-control input-sm" id="txtDVRegionBank"></span></div>
                    <div class="col-md-2">Total Lockbox Amount:</div>
                    <div class="col-md-2"><span class="form-control input-sm" id="txtDVTotalLockboxAmount"></span></div>
                </div>
                <div class="row">
                    <div class="col-md-2">Region Name:</div>
                    <div class="col-md-2"><span class="form-control input-sm" id="txtDVRegionName"></span></div>
                    <div class="col-md-2">Region Bank Account:</div>
                    <div class="col-md-2"><span class="form-control input-sm" id="txtDVRegionBankAccount"></span></div>
                    <div class="col-md-2">Total number of Check:</div>
                    <div class="col-md-2"><span class="form-control input-sm" id="txtDVTotalnumberofCheck"></span></div>
                </div>
                <div class="row">
                    <div class="col-md-2">LockBox ID:</div>
                    <div class="col-md-2"><span class="form-control input-sm" id="txtDVLockBoxID"></span></div>
                    <div class="col-md-2"></div>
                    <div class="col-md-2"></div>
                    <div class="col-md-2">Total number of Invoice:</div>
                    <div class="col-md-2"><span class="form-control input-sm" id="txtDVTotalnumberofInvoice"></span></div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <table class="table table-striped table-bordered table-hover order-column table-responsive" id="tblviewdetailPaid" width="100%">
                            <thead>
                                <tr>
                                    <th style="text-align:center;width:100px;">Check No.</th>
                                    <th style="text-align:center;width:100px;">Check Amount</th>
                                    <th style="text-align:center;width:100px;">Customer No.</th>
                                    <th style="text-align:center">Customer Name</th>
                                    <th style="text-align:center;width:100px;">Invoice No.</th>
                                    <th style="text-align:center;width:115px;">Apply Amount</th>
                                    <th style="text-align:center;width:100px;">Status</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
                <a href="javascript:void(0);" class="btn btn-primary pull-left" id="btnPrintLockbox" style="margin-left:10px;">Print</a>
                <a href="javascript:void(0);" class="btn btn-primary pull-right" data-dismiss="modal" style="margin-right:10px;">Close</a>
                <div class="clearfix"></div>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
</div>

<div class="form-horizontal" id="RenderOtherDepositePopup"></div>

@section scripts{
    <script type="text/javascript">
        var _lockboxId = @Model.FirstOrDefault().LockboxEDIId;
        var _lockboxRegionId = @Model.FirstOrDefault().RegionId;
        var _lockboxRawData = @Html.Raw(Json.Encode(Model));
        var _lockboxIsProcessed = ('@(ViewBag.LockboxProcessed)'=='False'?false:true);
        $(document).ready(function () {




            if(_lockboxIsProcessed)
            {
                swal({
                    title: "",
                    text: "System detected the Lockbox file already processed and all payment completed.",
                    type: "info",
                    showCancelButton: true,
                    closeOnConfirm: true,
                    showLoaderOnConfirm: false,
                    confirmButtonText: 'View payment',
                    cancelButtonText: "Close"
                }, function (isConfirm) {
                    if (isConfirm) {
                        ViewLockboxDetail(_lockboxRawData);
                    } else {
                        window.location.href = '@Url.Action("PaymentList", "AccountReceivable", new { area = "portal" })';
                    }
                });
            }




            $('#BatchNumber').inputmask("mask", { "mask": "999" });
            $('#LockboxDate').inputmask({ "mask": "99/99/9999", "placeholder": 'MM/DD/YYYY' });
            $('#hfLockboxEDIId').val(@ViewBag.LockboxId);
            $('#hfLockboxEDIDate').val('@ViewBag.LockboxDate');



            $('#txtVTotalAmountCustomerCredit').val(0);

            applyMaskCurrency('#txtVTotalLockboxAmount');
            applyMaskCurrency('#txtVTotalAmountoApplyT');
            applyMaskCurrency('#txtVTotalAmountExecption');
            applyMaskCurrency('#txtVTotalAmountCustomerCredit');

            $('#lockboxsummaryList tbody').html("");
            $('#lockboxsummaryListUnmatched tbody').html("");



            var res =_lockboxRawData;
            var trInvoicelist = "";
            var trInvoicelistIsOpen = 0;
            var trInvoicelistIsClosed = 0;
            var trInvoicelistIsOverPaid = 0;
            var trInvoicelistIsOverDue = 0;

            var TotalInvoiceAmount = 0;
            var TotalInvoiceBalance = 0;


            var tblinvoiceList = $('#lockboxsummaryList tbody');
            var tblinvoiceListUnmatched = $('#lockboxsummaryListUnmatched tbody');
            tblinvoiceList.html("");
            tblinvoiceListUnmatched.html("");
            var isFirst = true;
            var chkNumber = "";
            var chkAmount = 0;

            var vTotalApply = 0;
            var vTotalBalance = 0;
            var vTotalAmount = 0;
            var overflowAMT = 0.00;

            AllDetailRow = res;

            var errList = $.grep(res, function (t, i) { return !(t.InvoiceNo != "" && t.InvoiceNo != null && t.CustomerName != "" && t.CustomerName != null && parseFloat(t.BalanceAmount, 10).toFixed(2).toString() == '0.00'); });
            var chkNum = ''
            res.forEach(function (item) {

                if (isFirst) {
                    vTotalAmount = parseFloat(item.TotalDollars, 10);
                    $('#txtVDateTransmit').val(item.YYMMDD.substring(2, 4) + '/' + item.YYMMDD.substring(4, 6) + '/' + item.YYMMDD.substring(0, 2))
                    $('#txtVLockBoxID').val(item.LockboxNumber)
                    $('#txtVRegionName').val(item.RegionName)
                    $('#txtVTotalLockboxAmount').val(parseFloat(item.TotalDollars, 10))
                    isFirst = false;
                }

                var vInvoiceDate = (item.InvoiceDate != null ? moment(new Date(parseInt(item.InvoiceDate.substr(6)))).format("MM/DD/YYYY") : "");
                var vInvoiceAmount = (item.InvoiceAmount != null ? parseFloat(item.InvoiceAmount, 10) : 0.00);
                var vInvoiceOAmount = (item.InvoiceOAmount != null ? parseFloat(item.InvoiceOAmount, 10) : 0.00);
                var vApplyAmount = (item.ApplyAmount != null ? parseFloat(item.ApplyAmount, 10) : 0.00);
                var vBalanceAmount = (item.BalanceAmount != null ? parseFloat(item.BalanceAmount, 10) : 0.00);


                AppendLockboxItem(0, item.RowNo, item.CheckNumber, item.LockboxEDIDetailId, item.CustomerId, item.CustomerNo, item.CustomerName,
                    item.InvoiceId, item.InvoiceNo, vInvoiceDate, vInvoiceAmount, vInvoiceOAmount, vApplyAmount, vBalanceAmount, item.IsProcessed, (item.StatusListId == 50 ? false : true),
                    item.StatusListId, item.DollarAmount, item.OverflowAmount, false, item.IsODeposit, item.DepositReason, item.DepositPayeeType, item.DepositServiceTypeListId, item.DepositPayeeId, item.DepositPayeeName, item.DepositPayeeNo)

                var errListInner = $.grep(errList, function (t, i) { return t.CheckNumber == item.CheckNumber; });




                if (item.StatusListId==50)
                {
                    if (chkNum != item.CheckNumber) {
                        vTotalBalance += parseFloat(item.DollarAmount, 10);
                        chkNum = item.CheckNumber;
                    }
                }
                else
                 {
                    vTotalApply += parseFloat(item.ApplyAmount, 10);
                }

                overflowAMT=overflowAMT+item.OverflowAmount;

            });



            var dupes = {}, chkCount = 0, invCount = 0
            $.each(res, function (i, el) {
                if (!dupes[el.CheckNumber]) {
                    dupes[el.CheckNumber] = true;
                    chkCount++;
                }
                invCount++;
                //if (!dupes[el.InvoiceNo]) {
                //    dupes[el.InvoiceNo] = true;

                //}



            });
            $('#txtVTotalnumberofCheck').val(chkCount);
            $('#txtVTotalnumberofInvoice').val(invCount);
            $('#txtVTotalAmountExecption').val(vTotalBalance.toFixed(2).toString())
            $('#txtVTotalAmountoApply').val(vTotalApply.toFixed(2).toString())
            $('#txtVTotalAmountoApplyT').val((vTotalApply + overflowAMT).toFixed(2).toString())
            $('#txtVTotalAmountCustomerCredit').val(overflowAMT.toFixed(2).toString())

            $.unblockUI()
        });

        function AppendLockboxItem(Id, RowNo, CheckNumber, LockboxEDIDetailId, CustomerId, CustomerNo, CustomerName, InvoiceId,
            InvoiceNo, InvoiceDate, InvoiceAmount, InvoiceOAmount, ApplyAmount, BalanceAmount, IsProcessed, IsMatched, StatusListId, CheckAmount, OverflowAmount, NewMatch,
            isDeposit, DepositReason, DepositPayeeType, DepositServiceTypeListId, DepositPayeeId, DepositPayeeName, DepositPayeeNo) {


            var tblMatched = $('#lockboxsummaryList tbody');
            var tblMatchedDeposit = $('#lockboxsummaryListDeposit tbody');
            var tblUnMatched = $('#lockboxsummaryListUnmatched tbody');

            trData = "";
            if ((StatusListId == 49 || StatusListId == 52) && !isDeposit) {
                trData += '<tr  rel="mcr_' + CheckNumber + '">'
                trData += '<td style="width:25px;text-align:center;">'
                trData += '     <input type="hidden" name="hf_' + LockboxEDIDetailId+'_' + InvoiceId + '_LockboxEDIDetailId" value="' + LockboxEDIDetailId + '" />'
                trData += '     <input type="hidden" name="hf_' + LockboxEDIDetailId+'_' + InvoiceId + '_customerid" value="' + CustomerId + '" />'
                trData += '     <input type="hidden" name="hf_' + LockboxEDIDetailId+'_' + InvoiceId + '_chkNumber" value="' + CheckNumber + '" />'
                trData += '     <input type="hidden" name="hf_' + LockboxEDIDetailId+'_' + InvoiceId + '_chkAmount" value="' + CheckAmount + '" />'
                trData += '     <input type="hidden" name="hf_' + LockboxEDIDetailId+'_' + InvoiceId + '_invoiceid" value="' + InvoiceId + '" />'
                trData += '     <input type="hidden" name="hf_' + LockboxEDIDetailId+'_' + InvoiceId + '_invoiceamount" value="' + InvoiceAmount + '" />'
                trData += '     <input type="hidden" name="hf_' + LockboxEDIDetailId+'_' + InvoiceId + '_applyamount" value="' + ApplyAmount + '" />'
                trData += '     <input type="hidden" name="hf_' + LockboxEDIDetailId+'_' + InvoiceId + '_balanceamount" value="' + (InvoiceAmount-ApplyAmount) + '" />'
                trData += '     <input type="hidden" name="hf_' + LockboxEDIDetailId+'_' + InvoiceId + '_overflowamount" value="' +OverflowAmount + '" />'
                trData += '     <input type="hidden" name="hf_' + LockboxEDIDetailId+'_' + InvoiceId + '_newmatch" value="' + NewMatch + '" />'
                trData += '</td>'
                //trData += '<td style="text-align: left;padding-left: 30px!important;"><a href="javascript:void(0)" onclick="bindLockboxErrorDataList(' + LockboxEDIDetailId + ',\'' + CheckNumber + '\')">' + CheckNumber + '</a></td>'
                trData += '<td style="text-align: left;padding-left: 30px!important;">' + CheckNumber + '</td>'

                trData += '<td style="text-align:right;">$ ' + parseFloat(CheckAmount.toString(), 10).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td>'

                trData += '<td style="text-align: left;padding-left: 30px!important;">' + CustomerNo + '</td>'
                trData += '<td style="text-align: left;padding-left: 30px!important;">' + CustomerName + '</td>'
                trData += '<td style="text-align:center;"><a href="javascript:void(0)" onclick="btnOpenInvoiceDetail(' + InvoiceId + ')">' + InvoiceNo + '</a></td>'
                trData += '<td style="text-align:center;">' + InvoiceDate + '</td>'
                trData += '<td style="text-align:right;">$ ' + parseFloat(InvoiceOAmount.toString(), 10).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td>'
                trData += '<td style="text-align:right;">$ ' + parseFloat(InvoiceAmount.toString(), 10).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td>'
                //trData += '<td style="text-align:right;">$ ' + (parseFloat(ApplyAmount.toString(), 10) + parseFloat(OverflowAmount.toString(), 10)).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td>'

                trData += '<td style="text-align:right;">$ ' + (parseFloat(ApplyAmount.toString(), 10) + parseFloat(OverflowAmount.toString(), 10)).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td>'

                trData += '<td style="text-align:right;width:120px;">$ ' + (InvoiceAmount-ApplyAmount).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td>'
                trData += '<td style="text-align:right;width:120px;">$ ' + parseFloat(OverflowAmount.toString(), 10).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",")+ '</td></tr>'
                tblMatched.append(trData);

                $('#lockboxsummaryList_InvoiceAmount').html((parseFloat($('#lockboxsummaryList_InvoiceAmount').html().toString(), 10) + parseFloat(InvoiceAmount.toString(), 10)).toFixed(2))
                $('#lockboxsummaryList_ApplyAmount').html((parseFloat($('#lockboxsummaryList_ApplyAmount').html().toString(), 10) + parseFloat(ApplyAmount.toString(), 10) + parseFloat(OverflowAmount.toString(), 10)).toFixed(2))
                $('#lockboxsummaryList_OverPayment').html((parseFloat($('#lockboxsummaryList_OverPayment').html().toString(), 10) + parseFloat(OverflowAmount.toString(), 10)).toFixed(2))
                $('#lockboxsummaryList_OverPayment').hide();

            }
            else if ((StatusListId == 49 || StatusListId == 52) && isDeposit) {
                var rDCount = (parseInt($('#hflockboxsummaryListDepositCount').val().toString()) + 1);

                trData += '<tr  rel="mcr_' + CheckNumber + '">'
                trData += '<td style="width:25px;text-align:center;">'
                trData += '     <input type="hidden" name="hfdeposit_' + rDCount + '_LockboxEDIDetailId" value="' + LockboxEDIDetailId + '" />'
                trData += '     <input type="hidden" name="hfdeposit_' + rDCount + '_customerid" value="' + CustomerId + '" />'
                trData += '     <input type="hidden" name="hfdeposit_' + rDCount + '_chkNumber" value="' + CheckNumber + '" />'
                trData += '     <input type="hidden" name="hfdeposit_' + rDCount + '_chkAmount" value="' + CheckAmount + '" />'
                trData += '     <input type="hidden" name="hfdeposit_' + rDCount + '_invoiceid" value="0" />'
                trData += '     <input type="hidden" name="hfdeposit_' + rDCount + '_invoiceamount" value="0" />'
                trData += '     <input type="hidden" name="hfdeposit_' + rDCount + '_applyamount" value="' + ApplyAmount + '" />'
                trData += '     <input type="hidden" name="hfdeposit_' + rDCount + '_balanceamount" value="0" />'
                trData += '     <input type="hidden" name="hfdeposit_' + rDCount + '_overflowamount" value="0" />'
                trData += '     <input type="hidden" name="hfdeposit_' + rDCount + '_newmatch" value="' + NewMatch + '" />'
                trData += '     <input type="hidden" name="hfdeposit_' + rDCount + '_deposit" value="' + isDeposit+'" />'
                trData += '     <input type="hidden" name="hfdeposit_' + rDCount + '_DepositPayeeType" value="' + DepositPayeeType + '" />'
                trData += '     <input type="hidden" name="hfdeposit_' + rDCount + '_DepositReason" value="' + DepositReason + '" />'
                trData += '     <input type="hidden" name="hfdeposit_' + rDCount + '_DepositServiceTypeListId" value="' + DepositServiceTypeListId + '" />'
                trData += '     <input type="hidden" name="hfdeposit_' + rDCount + '_DepositPayeeId" value="' + DepositPayeeId + '" />'
                trData += '     <input type="hidden" name="hfdeposit_' + rDCount + '_DepositPayeeName" value="' + DepositPayeeName + '" />'
                trData += '     <input type="hidden" name="hfdeposit_' + rDCount + '_DepositPayeeNo" value="' + DepositPayeeNo + '" />'


                trData += '</td>'
                trData += '<td style="text-align: left;padding-left: 30px!important;">' + CheckNumber + '</td>'
                trData += '<td style="text-align:right;">$ ' + parseFloat(CheckAmount.toString(), 10).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td>'
                trData += '<td style="text-align: left;padding-left: 30px!important;">' + CustomerNo + '</td>'
                trData += '<td style="text-align: left;padding-left: 30px!important;">' + CustomerName + '</td>'
                trData += '<td style="text-align: left;padding-left: 30px!important;">' + DepositReason + '</td>'
                trData += '<td style="text-align:right;">$ ' + parseFloat(ApplyAmount.toString(), 10).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td></tr>'
                tblMatchedDeposit.append(trData);
                $('#lockboxsummaryListDeposit_OtherDeposit').html((parseFloat($('#lockboxsummaryListDeposit_OtherDeposit').html().toString(), 10) + parseFloat(ApplyAmount.toString(), 10)).toFixed(2))

                $('#hflockboxsummaryListDepositCount').val(rDCount);

            }
            else {

                trData += '<tr rel="umcr_' + CheckNumber + '">'
                if (BalanceAmount > 0)
                    trData += '<td style="width:25px;text-align:center;"><a href="javascript:void(0)" onclick="btnOpenApplyPaymentForm(' + InvoiceId + ',\'' + InvoiceNo + '\',\'' + CheckNumber + '\')"><i class="fa fa-times" aria-hidden="true" style="color:red;"></i></a></td>'
                else
                    trData += '<td style="width:25px;text-align:center;"><a href="javascript:void(0)" onclick="bindLockboxErrorDataList(' + LockboxEDIDetailId + ',\'' + CheckNumber + '\')"><i class="fa fa-times" aria-hidden="true" style="color:red;"></i></a></td>'

                trData += '<td style="text-align: left;padding-left: 30px!important;">' + CheckNumber + '</td>'
                trData += '<td style="text-align:right;">$ ' +  parseFloat(CheckAmount.toString(), 10).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td>'
                trData += '<td style="text-align: left;padding-left: 30px!important;">' + CustomerNo + '</td>'
                trData += '<td style="text-align: left;padding-left: 30px!important;">' + (CustomerName != null ? CustomerName : '') + '</td>'


                if (InvoiceId != null && InvoiceId.toString() != 'null') {
                    trData += '<td style="text-align:center;"><a href="javascript:void(0)" onclick="btnOpenInvoiceDetail(' + InvoiceId + ')">' + (InvoiceNo != null ? InvoiceNo : '') + '</a></td>'
                }
                else {
                    trData += '<td style="text-align:center;">' + (InvoiceNo != null ? InvoiceNo : '') + '</td>'
                }
                trData += '<td style="text-align:center;">' + InvoiceDate + '</td>'
                trData += '<td style="text-align:right;">$ ' + parseFloat(InvoiceOAmount.toString(), 10).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td>'
                //trData += '<td style="text-align:right;">$ ' + parseFloat(InvoiceAmount.toString(), 10).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td>'
                //trData += '<td style="text-align:right;">$ ' + parseFloat(ApplyAmount.toString(), 10).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td>'
                //trData += '<td style="text-align:right;width:120px;">$ ' + parseFloat(BalanceAmount.toString(), 10).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td></tr>'
                trData += '<td style="text-align:right;">$ ' + parseFloat(ApplyAmount.toString(), 10).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td>'
                trData += '<td style="text-align:center;"><a href="javascript:void(0)" onclick="OpenOtherDepositePopup('+LockboxEDIDetailId+')"><i class="fa fa-hand-o-right" aria-hidden="true"></i></a></td></tr>'
                tblUnMatched.append(trData);

            }

            $('#lockboxsummaryListTotalDeposit_TotalDeposit').html((
                parseFloat($('#lockboxsummaryList_ApplyAmount').html().toString(), 10)
                + parseFloat($('#lockboxsummaryListDeposit_OtherDeposit').html().toString(), 10)
            ).toFixed(2))
        }



        function btnApply_SelectedInvoice(_lockboxedidetailid, CheckNumber) {

            
            debugger
            var countLBDetail = errLBDetail.length;






            //if(errLBDetailSelectedCount!=countLBDetail)
            //{
            //    swal({title: "",text: "Please select "+countLBDetail+" Invoice!",icon: "info"});
            //    return;
            //}


            if(countLBDetail==1)
            {
                _lockboxedidetailid = errLBDetail[0].LockboxEDIDetailId;
            }

            var _txtEBalanceAmount = parseFloat($('#txtEBalanceAmount').val(), 10);
            var _txtEApplyAmount = parseFloat($('#txtEApplyAmount').val(), 10);

            if (_txtEBalanceAmount == 0) {
                var isHavePartial = false;
                $('tr[rel = "mcr_' + CheckNumber + '"]').remove();
                $('input[rel="smgglchk"]').each(function (item) {
                    if ($(this).is(":checked")) {

                        //_lockboxedidetailid = errLBDetail[countLBDetail-1].LockboxEDIDetailId;
                        //countLBDetail--;

                        var InvId = $(this).val();
                        var selectedErrDetail = $.grep(InvoicelistH, function (t, i) { return t.InvoiceId == InvId; })[0];

                        var vInvoiceDate = (selectedErrDetail.InvoiceDate != null ? moment(new Date(parseInt(selectedErrDetail.InvoiceDate.substr(6)))).format("MM/DD/YYYY") : "");
                        var vInvoiceAmount = (selectedErrDetail.Balance != null ? parseFloat(selectedErrDetail.Balance, 10) : 0);
                        var vInvoiceOAmount = (selectedErrDetail.Amount != null ? parseFloat(selectedErrDetail.Amount, 10) : 0);

                        //var vApplyAmount = ($('#txtIApplyAmount_' + InvId).val() != null ? parseFloat($('#stxtIApplyAmount_' + InvId).val(), 10).toFixed(2).toString() : 0);
                        //var vBalanceAmount = ($('#txtIBalanceAmount_' + InvId).val() != null ? parseFloat($('#stxtIBalanceAmount_' + InvId).val(), 10).toFixed(2).toString() : 0);
                        //var vOverflowAmount = ($('#hfTIOverflowAmount_' + InvId).val() != null ? parseFloat($('#shfTIOverflowAmount_' + InvId).val(), 10).toFixed(2).toString() : 0);

                        var vApplyAmount = ($('#stxtIApplyAmount_' + InvId).val() != null ? parseFloat($('#stxtIApplyAmount_' + InvId).val(), 10).toFixed(2).toString() : 0);
                        var vBalanceAmount = ($('#stxtIBalanceAmount_' + InvId).val() != null ? parseFloat($('#stxtIBalanceAmount_' + InvId).val(), 10).toFixed(2).toString() : 0);
                        var vOverflowAmount = ($('#shfTIOverflowAmount_' + InvId).val() != null ? parseFloat($('#shfTIOverflowAmount_' + InvId).val(), 10).toFixed(2).toString() : 0);


                        //var vApplyAmount = ($('#txtIApplyAmount_' + InvId).val() != null ? parseFloat($('#txtIApplyAmount_' + InvId).val(), 10): 0);
                        //var vBalanceAmount = ($('#txtIBalanceAmount_' + InvId).val() != null ? parseFloat($('#txtIBalanceAmount_' + InvId).val(), 10) : 0);

                        //var vDollarAmount = $('#spnELockboxAmount').html();

                        

                        if (vBalanceAmount > 0) {
                            isHavePartial = true;
                            swal({
                                title: "",
                                text: "Do you want to apply partial payment against invoice No. " + selectedErrDetail.InvoiceNo,
                                type: "info",
                                showCancelButton: true,
                                closeOnConfirm: true,
                                showLoaderOnConfirm: true,
                                confirmButtonText: 'Yes',
                                cancelButtonText: "No"
                            }, function () {
                                debugger
                                var _lbED = $.grep(_lockboxRawData, function (t, i) { return t.LockboxEDIDetailId == _lockboxedidetailid; })[0];
                                vApplyAmount = (parseFloat(vApplyAmount.toString(), 10));
                                vOverflowAmount = (parseFloat(vOverflowAmount.toString(), 10));

                                AppendLockboxItem(0, _lbED.RowNo, _lbED.CheckNumber, _lbED.LockboxEDIDetailId, selectedErrDetail.CustomerId, selectedErrDetail.CustomerNo,
                                    selectedErrDetail.CustomerName, InvId, selectedErrDetail.InvoiceNo, vInvoiceDate, vInvoiceAmount, vInvoiceOAmount, vApplyAmount, vBalanceAmount, false, true, 49, _lbED.DollarAmount, vOverflowAmount, true,
                                    false, '', '', -1, -1, '', '')


                                $('#txtVTotalAmountoApply').val((parseFloat($('#txtVTotalAmountoApply').val().toString().replace(',', ''), 10) + vApplyAmount).toFixed(2).toString());
                                $('#txtVTotalAmountExecption').val((parseFloat($('#txtVTotalAmountExecption').val().toString().replace(',', ''), 10) - vApplyAmount).toFixed(2).toString());
                                $('#txtVTotalAmountCustomerCredit').val((parseFloat($('#txtVTotalAmountCustomerCredit').val().toString().replace(',', ''), 10) + vOverflowAmount).toFixed(2).toString());
                                $('#txtVTotalAmountoApply').val((parseFloat($('#txtVTotalAmountoApplyT').val().toString().replace(',', ''), 10) + vApplyAmount + vOverflowAmount).toFixed(2).toString());


                                $('tr[rel = "umcr_' + CheckNumber + '"]').remove();

                                $("#modal_lockboxview_error_detail").modal('hide');

                                var count = $('#lockboxsummaryListUnmatched tbody').children('tr').length;
                                if (count == 0)
                                    $('#btnProcessPayment_OnSubmit').prop('disabled', false);

                            });
                        } else {
                            debugger
                            var _lbED = $.grep(_lockboxRawData, function (t, i) { return t.LockboxEDIDetailId == _lockboxedidetailid; })[0];
                            vApplyAmount = (parseFloat(vApplyAmount.toString(), 10));
                            vOverflowAmount = (parseFloat(vOverflowAmount.toString(), 10));

                            if (vApplyAmount > vInvoiceAmount && parseFloat(vBalanceAmount.toString(), 10) < 0) {
                                vApplyAmount = vInvoiceAmount;
                            }
                            var _overpaymentAMT = vOverflowAmount;
                            if (parseFloat(vBalanceAmount.toString(), 10) < 0) {
                                _overpaymentAMT = Math.abs(parseFloat(vBalanceAmount.toString(), 10)); 
                                vBalanceAmount = 0;
                            }

                            


                            AppendLockboxItem(0, _lbED.RowNo, _lbED.CheckNumber, _lbED.LockboxEDIDetailId, selectedErrDetail.CustomerId, selectedErrDetail.CustomerNo,
                                selectedErrDetail.CustomerName, InvId, selectedErrDetail.InvoiceNo, vInvoiceDate, vInvoiceAmount, vInvoiceOAmount, vApplyAmount, vBalanceAmount, false, true, 49, _lbED.DollarAmount, _overpaymentAMT, true,
                                false, '', '', -1, -1, '', '')


                            $('#txtVTotalAmountoApply').val((parseFloat($('#txtVTotalAmountoApply').val().toString().replace(',', ''), 10) + vApplyAmount).toFixed(2).toString());
                            $('#txtVTotalAmountExecption').val((parseFloat($('#txtVTotalAmountExecption').val().toString().replace(',', ''), 10) - vApplyAmount).toFixed(2).toString());
                            $('#txtVTotalAmountCustomerCredit').val((parseFloat($('#txtVTotalAmountCustomerCredit').val().toString().replace(',', ''), 10) + vOverflowAmount).toFixed(2).toString());
                            $('#txtVTotalAmountoApply').val((parseFloat($('#txtVTotalAmountoApplyT').val().toString().replace(',', ''), 10) + vApplyAmount + vOverflowAmount).toFixed(2).toString());


                            $('tr[rel = "umcr_' + CheckNumber + '"]').remove();

                            var count = $('#lockboxsummaryListUnmatched tbody').children('tr').length;
                            if (count == 0)
                                $('#btnProcessPayment_OnSubmit').prop('disabled', false);
                            
                        }


                       
                    }
                });
                $("#divtblviewdetail_invoicelist").show();
                if (!isHavePartial) {
                    $("#modal_lockboxview_error_detail").modal('hide');
                }
            }
            else {
                swal({
                    title: "",
                    text: "Amount is more then Invoice Amount, do you want to process payment?",
                    type: "info",
                    showCancelButton: true,
                    closeOnConfirm: true,
                    showLoaderOnConfirm: true,
                    confirmButtonText: 'Yes',
                    cancelButtonText: "No"
                }, function () {

                    $('tr[rel = "mcr_' + CheckNumber + '"]').remove();
                    var _checkedLength = $('input[rel="mgglchk"]:checked').length;
                    $('input[rel="smgglchk"]:checked').each(function (index,item) {
                        //if ($(this).is(":checked")) {
                            //_lockboxedidetailid = errLBDetail[countLBDetail-1].LockboxEDIDetailId;
                            //countLBDetail--;

                            var InvId = $(this).val();
                            var selectedErrDetail = $.grep(InvoicelistH, function (t, i) { return t.InvoiceId == InvId; })[0];

                            var vInvoiceDate = (selectedErrDetail.InvoiceDate != null ? moment(new Date(parseInt(selectedErrDetail.InvoiceDate.substr(6)))).format("MM/DD/YYYY") : "");
                            var vInvoiceOAmount = (selectedErrDetail.Amount != null ? parseFloat(selectedErrDetail.Amount, 10) : 0);
                            var vInvoiceAmount = (selectedErrDetail.Balance != null ? parseFloat(selectedErrDetail.Balance, 10) : 0);

                            var vApplyAmount = ($('#stxtIApplyAmount_' + InvId).val() != null ? parseFloat($('#stxtIApplyAmount_' + InvId).val(), 10).toFixed(2).toString() : 0);
                            var vBalanceAmount = ($('#stxtIBalanceAmount_' + InvId).val() != null ? parseFloat($('#stxtIBalanceAmount_' + InvId).val(), 10).toFixed(2).toString() : 0);
                            var vOverflowAmount = ($('#shfTIOverflowAmount_' + InvId).val() != null ? parseFloat($('#shfTIOverflowAmount_' + InvId).val(), 10).toFixed(2).toString() : 0);


                            console.log(index)
                            console.log(_checkedLength)
                            console.log(_txtEBalanceAmount)
                            console.log($('#hfTIOverflowAmount_' + InvId).val())

                            if (index === (_checkedLength - 1) && _txtEBalanceAmount>0) {
                                $('#hfTIOverflowAmount_'+InvId).val(_txtEBalanceAmount.toFixed(2))
                                vOverflowAmount = _txtEBalanceAmount
                            }


                            var vDollarAmount = $('#spnELockboxAmount').html();
                            var _lbED = $.grep(_lockboxRawData, function (t, i) { return t.LockboxEDIDetailId == _lockboxedidetailid; })[0];

                            vApplyAmount = (parseFloat(vApplyAmount.toString(), 10));
                            vOverflowAmount = (parseFloat(vOverflowAmount.toString(), 10));

                            AppendLockboxItem(0, _lbED.RowNo, _lbED.CheckNumber, _lbED.LockboxEDIDetailId, selectedErrDetail.CustomerId, selectedErrDetail.CustomerNo,
                                selectedErrDetail.CustomerName, InvId, selectedErrDetail.InvoiceNo, vInvoiceDate, vInvoiceAmount, vInvoiceOAmount, vApplyAmount, vBalanceAmount, false, true, 49, _lbED.DollarAmount, vOverflowAmount, true,
                                false, '', '', -1, -1, '', '')


                            $('#txtVTotalAmountoApply').val((parseFloat($('#txtVTotalAmountoApply').val().toString().replace(',', ''), 10) + vApplyAmount).toFixed(2).toString());
                            $('#txtVTotalAmountExecption').val((parseFloat($('#txtVTotalAmountExecption').val().toString().replace(',', ''), 10) - vApplyAmount-vOverflowAmount).toFixed(2).toString());
                        $('#txtVTotalAmountCustomerCredit').val((parseFloat($('#txtVTotalAmountCustomerCredit').val().toString().replace(',', ''), 10) + vOverflowAmount).toFixed(2).toString());
                        $('#txtVTotalAmountoApplyT').val((parseFloat($('#txtVTotalAmountoApplyT').val().toString().replace(',', ''), 10) + vApplyAmount + vOverflowAmount).toFixed(2).toString());


                            //if(_txtEBalanceAmount>0)
                            //    $('#txtVTotalAmountCustomerCredit').val((parseFloat($('#txtVTotalAmountCustomerCredit').val().toString().replace(',', ''), 10) + _txtEBalanceAmount).toFixed(2).toString());

                            $('tr[rel = "umcr_' + CheckNumber + '"]').remove();

                            $("#modal_lockboxview_error_detail").modal('hide');
                        //}
                    });
                    $("#divtblviewdetail_invoicelist").show();
                });
            }

            var count = $('#lockboxsummaryListUnmatched tbody').children('tr').length;
            if(count==0)
                $('#btnProcessPayment_OnSubmit').prop('disabled',false);

        }

        function ChangeInvoiceSelectedAmount(InvId) {






            debugger;
            var _CheckTotalAmount = parseFloat($('#spnELockboxAmount').html().toString(), 10);
            var _CheckApplyAmount = parseFloat($('#txtEApplyAmount').val().toString(), 10);
            var _CheckBalanceAmount = parseFloat(parseFloat($('#txtEBalanceAmount').val().toString(), 10).toFixed(2));
            var _newINVAMT = parseFloat($('#stxtIApplyAmount_' + InvId).val().toString(), 10);
            var _oldINVAMT = parseFloat(parseFloat($('#sotxtIApplyAmount_' + InvId).val().toString(), 10).toFixed(2));
            if (_newINVAMT > (_CheckBalanceAmount + _oldINVAMT)) {
                swal('amount not more them apply amount.');
                $('#stxtIApplyAmount_' + InvId).val(_oldINVAMT);
                return false;
            }
            //parseFloat($('#sotxtIApplyAmount_217071').val().toString(), 10) == parseFloat((parseFloat($('#sotxtIApplyAmount_217071').val().toString()) + parseFloat($('#txtEBalanceAmount').val().toString(), 10)).toFixed(2))

            var _invBal = parseFloat($('#shfINVbalanceAmount_' + InvId).val().toString(), 10);

            



            _CheckBalanceAmount = _CheckBalanceAmount + _oldINVAMT;
            _CheckApplyAmount = _CheckApplyAmount - _oldINVAMT;

            _CheckBalanceAmount = _CheckBalanceAmount - _newINVAMT;
            _CheckApplyAmount = _CheckApplyAmount + _newINVAMT;
         
            $('#txtEApplyAmount').val(parseFloat(_CheckApplyAmount.toString(), 10).toFixed(2));
            $('#txtEBalanceAmount').val(parseFloat(_CheckBalanceAmount.toString(), 10).toFixed(2));

            $('#sotxtIApplyAmount_' + InvId).val(_newINVAMT);
            $('#stxtIBalanceAmount_' + InvId).val(_invBal - _newINVAMT);
            $('#shfTIOverflowAmount_' + InvId).val((_invBal - _newINVAMT) < 0 ? abs(_invBal - _newINVAMT):0);

            
          

            

            //var _InvAmount = parseFloat($('#hfINVbalanceAmount_' + InvId).val().toString(), 10);
            //var _InvApplyAmount = parseFloat($('#txtIApplyAmount_' + InvId).val().toString(), 10);
            //var _InvBalanceAmount = parseFloat($('#txtIBalanceAmount_' + InvId).val().toString(), 10);




            //var countLBDetail = errLBDetail.length;
            //if ($(item).is(':checked')) {
            //    debugger;
            //    errLBDetailSelectedCount++;
            //    if (_CheckBalanceAmount <= 0) {

            //        $(item).prop('checked', false);
            //        errLBDetailSelectedCount--;
            //        swal("No more credit available");
            //        return;
            //    }





            //    if (_CheckBalanceAmount > _InvAmount) {
            //        $('#txtIApplyAmount_' + InvId).val(_InvAmount);
            //        $('#txtIBalanceAmount_' + InvId).val(_InvAmount - _InvAmount)
            //    }
            //    else {
            //        $('#txtIApplyAmount_' + InvId).val(_CheckBalanceAmount);
            //        $('#txtIBalanceAmount_' + InvId).val(_InvAmount - _CheckBalanceAmount)
            //    }



            //    $('#txtEApplyAmount').val((_CheckApplyAmount + parseFloat($('#txtIApplyAmount_' + InvId).val().toString(), 10)).toFixed(2));
            //    $('#txtEBalanceAmount').val((_CheckBalanceAmount - parseFloat($('#txtIApplyAmount_' + InvId).val().toString(), 10)).toFixed(2));





                //var hdf_invCustomerNo = $('#hdf_invCustomerNo' + InvId).val();
                //var hdf_invCustomerName = $('#hdf_invCustomerName' + InvId).val();
                //var hdf_invInvoiceNo = $('#hdf_invInvoiceNo' + InvId).val();
                //var hdf_invInvoiceDate = $('#hdf_invInvoiceDate' + InvId).val();
                //var hdf_invInvoiceDesc = $('#hdf_invInvoiceDesc' + InvId).val();
                //var hdf_invInvoiceAmt = $('#hdf_invInvoiceAmt' + InvId).val();
                //var hdf_invInvoiceBalanceAmt = $('#hdf_invInvoiceBalanceAmt' + InvId).val();

                //var tempTxtIApplyAmount = $('#txtIApplyAmount_' + InvId).val();
                //var tempTxtIBalanceAmount = $('#txtIBalanceAmount_' + InvId).val();
                //var temphfTIOverflowAmount = $('#hfTIOverflowAmount_' + InvId).val();

                //var trInvoicelist = "";
                //trInvoicelist += '<tr id="sir_' + InvId + '">'
                //trInvoicelist += '<td style="text-align:center;">';
                //trInvoicelist += '<input rel="smgglchk" type="checkbox" name="name"  class="chk" value="' + InvId + '" checked  onchange="ChangeInvoiceSelection(this)"/></td>';
                //trInvoicelist += '<td style="text-align:center;width:50px;">' + hdf_invCustomerNo + '</td>';
                //trInvoicelist += '<td style="text-align:left;">' + hdf_invCustomerName + '</td>';
                //trInvoicelist += '<td style="text-align:center;"><a href="javascript:void(0);" onclick="btnOpenInvoiceDetail(' + InvId + ')">' + hdf_invInvoiceNo + '</a></td>';
                //trInvoicelist += '<td style="text-align:center;">' + hdf_invInvoiceDate + '</td>';
                //trInvoicelist += '<td style="text-align:left;">' + hdf_invInvoiceDesc + '</td>';
                //trInvoicelist += '<td style="text-align:right;">$ ' + parseFloat(hdf_invInvoiceAmt, 10).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td>';
                //trInvoicelist += '<td style="text-align:right;"><input type="hidden" rel="shdnIInvoiceAmount" id="shfINVbalanceAmount_' + InvId + '" value="' + parseFloat(hdf_invInvoiceBalanceAmt, 10).toFixed(2).toString() + '" />$ <span rel="sspnIInvoiceAmount">' + parseFloat(hdf_invInvoiceBalanceAmt, 10).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</span></td>';
                //trInvoicelist += '<td style="text-align:right;"><input type="text" rel="sTIApplyAmount" onchange="chkChangeinvAMT(' + item.InvoiceId + ')" name="stxtIApplyAmount_' + InvId + '" id="stxtIApplyAmount_' + InvId + '" value="' + parseFloat(tempTxtIApplyAmount, 10).toFixed(2) + '" /></td>';
                //trInvoicelist += '<td style="text-align:right;"><input type="text" readonly rel="sTIBalanceAmount" name="stxtIBalanceAmount_' + InvId + '" id="stxtIBalanceAmount_' + InvId + '" value="' + parseFloat(tempTxtIBalanceAmount, 10).toFixed(2) + '" />';
                //trInvoicelist += '<input type="hidden" rel="TIOverflowAmount" name="shfTIOverflowAmount_' + InvId + '" id="shfTIOverflowAmount_' + InvId + '" value="' + temphfTIOverflowAmount + '" /></td></tr>';
                //$('#invoiceListSelected tbody').append(trInvoicelist);

                //applyMaskCurrency('#stxtIApplyAmount_' + InvId)
                //applyMaskCurrency('#stxtIBalanceAmount_' + InvId)
                //$('#divInvoiceListSelected').show();






        }

        function ChangeInvoiceSelection(item) {

            var InvId = $(item).val();
            var _CheckTotalAmount = parseFloat($('#spnELockboxAmount').html().toString(), 10);
            var _CheckApplyAmount = parseFloat($('#txtEApplyAmount').val().toString(), 10);
            var _CheckBalanceAmount = parseFloat($('#txtEBalanceAmount').val().toString(), 10);




            var _InvAmount = parseFloat((($('#hdf_invInvoiceAmt' + InvId).val() == undefined) ? $('#shdnIInvoiceAmount_' + InvId).val().toString() : $('#hdf_invInvoiceAmt' + InvId).val().toString()).toString(), 10);
            var _InvApplyAmount = 0.00; //parseFloat($('#txtIApplyAmount_'+InvId).val().toString(), 10);

            
            
            var _InvBalanceAmount = parseFloat((($('#hdf_invInvoiceBalanceAmt' + InvId).val() == undefined) ? $('#shfINVbalanceAmount_' + InvId).val().toString() : $('#hdf_invInvoiceBalanceAmt' + InvId).val().toString()).toString(), 10);

            //var _InvAmount = parseFloat($('#hfINVbalanceAmount_' + InvId).val().toString(), 10);
            //var _InvApplyAmount = parseFloat($('#txtIApplyAmount_' + InvId).val().toString(), 10);
            //var _InvBalanceAmount = parseFloat($('#txtIBalanceAmount_' + InvId).val().toString(), 10);




            var countLBDetail = errLBDetail.length;
            if($(item).is(':checked'))
            {
                debugger;
                errLBDetailSelectedCount++;
                if(_CheckBalanceAmount<=0)
                {

                    $(item).prop('checked',false);
                    errLBDetailSelectedCount--;
                    swal("No more credit available");
                    return;
                }




                var _txtIApplyAmount = 0.0;
                var _txtIBalanceAmount = 0.0;
                if (_CheckBalanceAmount > _InvBalanceAmount)
                {
                    _txtIApplyAmount = _InvBalanceAmount;
                    _txtIBalanceAmount = _InvBalanceAmount - _txtIApplyAmount;
                    //$('#txtIApplyAmount_'+InvId).val(_InvAmount);
                    //$('#txtIBalanceAmount_'+InvId).val(_InvAmount - _InvAmount)
                }
                else
                {
                    _txtIApplyAmount = _CheckBalanceAmount;
                    _txtIBalanceAmount = _InvBalanceAmount - _CheckBalanceAmount;

                    //$('#txtIApplyAmount_'+InvId).val(_CheckBalanceAmount);
                    //$('#txtIBalanceAmount_'+InvId).val(_InvAmount - _CheckBalanceAmount)
                }



                $('#txtEApplyAmount').val((_CheckApplyAmount + parseFloat(_txtIApplyAmount.toString(), 10)).toFixed(2));
                $('#txtEBalanceAmount').val((_CheckBalanceAmount - parseFloat(_txtIApplyAmount.toString(), 10)).toFixed(2));


                //if(errLBDetailSelectedCount==countLBDetail && parseFloat($('#txtEBalanceAmount').val().toString(), 10)>0)
                //if(parseFloat($('#txtEBalanceAmount').val().toString(), 10)>0)
                //{
                //    $('#hfTIOverflowAmount_'+InvId).val(parseFloat($('#txtEBalanceAmount').val().toString(), 10).toFixed(2))
                //}



                var hdf_invCustomerNo = $('#hdf_invCustomerNo' + InvId).val();
                var hdf_invCustomerName = $('#hdf_invCustomerName' + InvId).val();
                var hdf_invInvoiceNo = $('#hdf_invInvoiceNo' + InvId).val();
                var hdf_invInvoiceDate = $('#hdf_invInvoiceDate' + InvId).val();
                var hdf_invInvoiceDesc = $('#hdf_invInvoiceDesc' + InvId).val();
                var hdf_invInvoiceAmt = $('#hdf_invInvoiceAmt' + InvId).val();
                var hdf_invInvoiceBalanceAmt = $('#hdf_invInvoiceBalanceAmt' + InvId).val();

                var tempTxtIApplyAmount = _txtIApplyAmount;//$('#txtIApplyAmount_' + InvId).val();
                var tempTxtIBalanceAmount = _txtIBalanceAmount;//$('#txtIBalanceAmount_' + InvId).val();
                var temphfTIOverflowAmount = $('#hfTIOverflowAmount_' + InvId).val();

                var trInvoicelist = "";
                trInvoicelist += '<tr id="sir_' + InvId + '">'
                trInvoicelist += '<td style="text-align:center;">';
                trInvoicelist += '<input rel="smgglchk" type="checkbox" name="name"  class="chk" value="' + InvId + '" checked  onchange="ChangeInvoiceSelection(this)"/></td>';
                trInvoicelist += '<td style="text-align:center;width:50px;">' + hdf_invCustomerNo + '</td>';
                trInvoicelist += '<td style="text-align:left;">' + hdf_invCustomerName + '</td>';
                trInvoicelist += '<td style="text-align:center;"><a href="javascript:void(0);" onclick="btnOpenInvoiceDetail(' + InvId + ')">' + hdf_invInvoiceNo + '</a></td>';
                trInvoicelist += '<td style="text-align:center;">' + hdf_invInvoiceDate + '</td>';
                trInvoicelist += '<td style="text-align:left;">' + hdf_invInvoiceDesc + '</td>';
                trInvoicelist += '<td style="text-align:right;"><input type="hidden" rel="shdnIInvoiceAmount" id="shdnIInvoiceAmount_' + InvId + '" value="' + parseFloat(hdf_invInvoiceBalanceAmt, 10).toFixed(2).toString() + '" />$ ' + parseFloat(hdf_invInvoiceAmt, 10).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td>';
                trInvoicelist += '<td style="text-align:right;"><input type="hidden" rel="shfINVbalanceAmount" id="shfINVbalanceAmount_' + InvId + '" value="' + parseFloat(hdf_invInvoiceBalanceAmt, 10).toFixed(2).toString() + '" />$ <span rel="sspnIInvoiceAmount">' + parseFloat(hdf_invInvoiceBalanceAmt, 10).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</span></td>';
                trInvoicelist += '<td style="text-align:right;"><input type="hidden" rel="soTIApplyAmount" name="sotxtIApplyAmount_' + InvId + '" id="sotxtIApplyAmount_' + InvId + '" value="' + parseFloat(tempTxtIApplyAmount, 10).toFixed(2) + '" />'
                trInvoicelist += '<input type="text" rel="sTIApplyAmount" onchange="ChangeInvoiceSelectedAmount(' + InvId + ')" name="stxtIApplyAmount_' + InvId + '" id="stxtIApplyAmount_' + InvId + '" value="' + parseFloat(tempTxtIApplyAmount, 10).toFixed(2) + '" /></td>';
                trInvoicelist += '<td style="text-align:right;"><input type="text" readonly rel="sTIBalanceAmount" name="stxtIBalanceAmount_' + InvId + '" id="stxtIBalanceAmount_' + InvId + '" value="' + parseFloat(tempTxtIBalanceAmount, 10).toFixed(2) + '" />';
                trInvoicelist += '<input type="hidden" rel="TIOverflowAmount" name="shfTIOverflowAmount_' + InvId + '" id="shfTIOverflowAmount_' + InvId + '" value="' + temphfTIOverflowAmount + '" /></td></tr>';
                $('#invoiceListSelected tbody').append(trInvoicelist);

                applyMaskCurrency('#stxtIApplyAmount_' + InvId)
                applyMaskCurrency('#stxtIBalanceAmount_' + InvId)
                $('#divInvoiceListSelected').show();


            }
            else
            {
                errLBDetailSelectedCount--;

                $('#txtIBalanceAmount_'+InvId).val(_InvAmount.toFixed(2))
                $('#txtEApplyAmount').val((_CheckApplyAmount - parseFloat($('#stxtIApplyAmount_'+InvId).val().toString(), 10)).toFixed(2));
                $('#txtEBalanceAmount').val((_CheckBalanceAmount + parseFloat($('#stxtIApplyAmount_'+InvId).val().toString(), 10)).toFixed(2));
                //$('#txtIApplyAmount_' + InvId).val(0);


                $('#sir_' + InvId).remove();

                if ($('#invoiceListSelected tbody').html() == '')
                    $('#divInvoiceListSelected').hide();

                //$('#chkinvmgglchk' + InvId).prop('checked', false);

                var table = $("#invoiceList1").DataTable();
                // Get all rows with search applied
                var rows = table.rows().nodes();
                $('#chkinvmgglchk' + InvId, rows).prop('checked', false);

            }


            //$('input[rel="mgglchk"]').each(function (item) {
            //    var InvId = $(this).val();
            //    var INVbalanceAmount = parseFloat($('#hfINVbalanceAmount_' + InvId).val(), 10).toFixed(2);

            //    $('#txtIApplyAmount_'+ InvId).val(0.00);
            //    $('#txtIBalanceAmount_'+ InvId).val(INVbalanceAmount);

            //});


            ////errLBDetail
            //$('input[rel="mgglchk"]').each(function (item) {
            //    var InvId = $(this).val();
            //    var INVbalanceAmount = parseFloat($('#hfINVbalanceAmount_' + InvId).val(), 10).toFixed(2);

            //    $('#txtIApplyAmount_'+ InvId).val(0.00);
            //    $('#txtIBalanceAmount_'+ InvId).val(INVbalanceAmount);

            //});
            //var txtELockboxAmount = parseFloat($('#spnELockboxAmount').html().toString().replace(',', '').replace(' ', ''));
            //$('#txtEBalanceAmount').val(txtELockboxAmount);
            //$('#txtEApplyAmount').val(0);


            //var selectedErrDetail = $.grep(InvoicelistH, function (t, i) { return t.InvoiceId == item.value; });



            //var invAmount = parseFloat($('#hfINVbalanceAmount_' + selectedErrDetail[0].InvoiceId).val());



            //if(invAmount<txtELockboxAmount)
            //{


            //    $('#txtEApplyAmount').val(invAmount);
            //    txtEBalanceAmount1 = txtELockboxAmount  - invAmount;
            //    $('#txtEBalanceAmount').val(txtEBalanceAmount1);
            //}
            //else
            //{
            //    $('#txtEApplyAmount').val(txtELockboxAmount);
            //    $('#txtEBalanceAmount').val(0.00);
            //}
            //var txtEApplyAmount = parseFloat($('#txtEApplyAmount').val());
            //var txtEBalanceAmount = parseFloat($('#txtEBalanceAmount').val());

            //$('#txtIApplyAmount_'+item.value).val(txtEApplyAmount);
            //$('#txtIBalanceAmount_'+item.value).val(invAmount-txtEApplyAmount);

        }


        function btnInvoicePopupClose()
        {
            $("#modal_invoicedetail").modal('hide');
        }



        function ViewLockboxDetail(_lockboxRawData) {


            var trInvoicelist = "";
            var tblviewdetail = $('#tblviewdetailPaid tbody');
            tblviewdetail.html("");
            var isFirst = true;
            var chkCount = "";
            var invCount = "";

            _lockboxRawData.forEach(function (item) {

                if (isFirst) {
                    $('#txtDVDateTransmit').html(item.YYMMDD.substring(2, 4) + '/' + item.YYMMDD.substring(4, 6) + '/' + item.YYMMDD.substring(0, 2));
                    $('#txtDVRegionBank').html(item.RegionBank);
                    $('#txtDVTotalLockboxAmount').html(item.TotalDollars);
                    $('#txtDVRegionName').html(item.RegionName);
                    $('#txtDVRegionBankAccount').html(item.Destination);
                    $('#txtDVLockBoxID').html(item.LockboxNumber);
                    applyMaskCurrency('#txtDVTotalLockboxAmount');
                    isFirst = false;
                }
                trInvoicelist = "";
                trInvoicelist += '<tr><td style="text-align:center">' + (item.CheckNumber != null ? item.CheckNumber : '') + '</td>'
                trInvoicelist += '<td style="text-align:right">$ ' + (item.DollarAmount != null ? parseFloat(item.DollarAmount, 10).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") : '$ 0.00') + '</td>'
                trInvoicelist += '<td style="text-align:center">' + (item.CustomerNo != null ? item.CustomerNo : '') + '</td>'
                trInvoicelist += '<td>' + (item.CustomerName != null ? item.CustomerName : '') + '</td>'
                trInvoicelist += '<td style="text-align:center">' + (item.InvoiceNo != null ? item.InvoiceNo : '') + '</td>'
                trInvoicelist += '<td style="text-align:right">$ ' + (item.ApplyAmount != null ? parseFloat(item.ApplyAmount, 10).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") : '') + '</td>'
                trInvoicelist += '<td style="text-align:center">Paid</tr>'
                tblviewdetail.append(trInvoicelist);


            });
            var dupes = {};
            $.each(_lockboxRawData, function (i, el) {
                if (!dupes[el.CheckNumber]) {
                    dupes[el.CheckNumber] = true;
                    chkCount++;
                }
                invCount++;
            });
            $('#txtDVTotalnumberofCheck').html(chkCount);
            $('#txtDVTotalnumberofInvoice').html(invCount);

            $("#modal_lockboxview_detailPaid").modal({ backdrop: 'static' });

        };
        $("#btnPrintLockbox").click(function () {

            // window.print();
            $('#_FAHR__btnPrint').hide();
            $('#_FAHR__btnExport').hide();
            var contents = $("#modal_lockboxview_detailPaid").html();
            var frame1 = $('<iframe />');
            frame1[0].name = "_FranchiseeAccountHistoryReportPrintframe1";
            frame1.css({ "position": "absolute", "top": "-1000000px" });
            $("body").append(frame1);
            var frameDoc = frame1[0].contentWindow ? frame1[0].contentWindow : frame1[0].contentDocument.document ? frame1[0].contentDocument.document : frame1[0].contentDocument;
            frameDoc.document.open();
            //Create a new HTML document.
            frameDoc.document.write('<html><head><title></title>');
            frameDoc.document.write('</head><body>');
            //Append the external CSS file.
            frameDoc.document.write('<link href="/fonts/FaceFontcss.css" rel="stylesheet" />');
            frameDoc.document.write('<link href="/Content/admin/assets/global/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css" />');
            frameDoc.document.write('<link href="/Content/admin/assets/global/plugins/simple-line-icons/simple-line-icons.min.css" rel="stylesheet" type="text/css" />');
            frameDoc.document.write('<link href="/Content/admin/assets/global/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />');
            frameDoc.document.write('<link href="/Content/admin/assets/global/plugins/bootstrap-switch/css/bootstrap-switch.min.css" rel="stylesheet" type="text/css" />');
            frameDoc.document.write('<link href="/Content/admin/assets/global/plugins/datatables/datatables.min.css" rel="stylesheet" type="text/css" />');
            frameDoc.document.write('<link href="/Content/admin/assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.css" rel="stylesheet" type="text/css" />');
            //Append the DIV contents.
            frameDoc.document.write(contents);
            frameDoc.document.write('</body></html>');
            frameDoc.document.close();
            console.log(window.frames["_FranchiseeAccountHistoryReportPrintframe1"])
            setTimeout(function () {

                window.frames["_FranchiseeAccountHistoryReportPrintframe1"].focus();
                window.frames["_FranchiseeAccountHistoryReportPrintframe1"].print();
                frame1.remove();
                $('#_FAHR__btnPrint').show();
                $('#_FAHR__btnExport').show();
            }, 500);
        });
    </script>
    <script type="text/javascript">


        var GlobalInvoiceData =[];
        var selectDetailRow = {};
        var AllDetailRow = [];

        var errLBDetail = [];
        var errLBDetailSelectedCount = 0;
        var errCustomerName;

        function refreshTable(id, chkno,firstTime) {
           
            var sURL = getSearchURL(_lockboxRegionId);
                console.log(1)
                $.ajax(
                {
                    type: "GET", //HTTP POST Method
                    url: sURL, // Controller/View
                    //data: { 'accid': id, 'issubacct': issub },
                    success: function (res) {
                        if (firstTime!=1)
                            $('#invoiceList1').DataTable().destroy();


                        GlobalInvoiceData = res.aadata;
                        var trInvoicelist = "";
                        var trInvoicelistIsOpen = 0;
                        var trInvoicelistIsClosed = 0;
                        var trInvoicelistIsOverPaid = 0;
                        var trInvoicelistIsOverDue = 0;
                        var TotalInvoiceAmount = 0;
                        var TotalInvoiceBalance = 0;
                        var tblinvoiceList = $('#invoiceList1 tbody');
                        tblinvoiceList.html("");
                        InvoicelistH = res.aadata;

                        $.each(res.aadata, function (index, item) {
                            trInvoicelist = "";
                            trInvoicelist += '<tr id="ir_' + item.InvoiceId + '">'
                            trInvoicelist += '<td style="text-align:center;">';
                            trInvoicelist += '<input type="hidden" id="hdf_invCustomerNo' + item.InvoiceId + '" value="' + item.CustomerNo + '" />';
                            trInvoicelist += '<input type="hidden" id="hdf_invCustomerName' + item.InvoiceId + '" value="' + item.CustomerName + '" />';
                            trInvoicelist += '<input type="hidden" id="hdf_invInvoiceNo' + item.InvoiceId + '" value="' + item.InvoiceNo + '" />';
                            trInvoicelist += '<input type="hidden" id="hdf_invInvoiceDate' + item.InvoiceId + '" value="' + moment(new Date(parseInt(item.InvoiceDate.substr(6)))).format("MM/DD/YYYY") + '" />';
                            trInvoicelist += '<input type="hidden" id="hdf_invInvoiceDesc' + item.InvoiceId + '" value="' + item.Description + '" />';
                            trInvoicelist += '<input type="hidden" id="hdf_invInvoiceAmt' + item.InvoiceId + '" value="' + item.Amount + '" />';
                            trInvoicelist += '<input type="hidden" id="hdf_invInvoiceBalanceAmt' + item.InvoiceId + '" value="' + item.Balance + '" />';

                            trInvoicelist += '<input rel="mgglchk" id="chkinvmgglchk' + item.InvoiceId + '" type="checkbox" name="name" onchange="ChangeInvoiceSelection(this)"  class="chk" value="' + item.InvoiceId + '"  /></td>';
                            trInvoicelist += '<td style="text-align:center;width:50px;">' + item.CustomerNo + '</td>';
                            trInvoicelist += '<td style="text-align:left;">' + item.CustomerName + '</td>';
                            trInvoicelist += '<td style="text-align:center;"><a href="javascript:void(0);" onclick="btnOpenInvoiceDetail(' + item.InvoiceId + ')">' + item.InvoiceNo + '</a></td>';
                            trInvoicelist += '<td style="text-align:center;">' + moment(new Date(parseInt(item.InvoiceDate.substr(6)))).format("MM/DD/YYYY") + '</td>';
                            trInvoicelist += '<td style="text-align:left;">' + item.Description + '</td>';
                            trInvoicelist += '<td style="text-align:right;">$ ' + parseFloat(item.Amount, 10).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</td>';
                            trInvoicelist += '<td style="text-align:right;">$ ' + parseFloat(item.Balance, 10).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + ' <input type="hidden" rel="TIOverflowAmount" name="hfTIOverflowAmount_' + item.InvoiceId + '" id="hfTIOverflowAmount_' + item.InvoiceId + '" value="0" /></td>';
                            //trInvoicelist += '<input type="hidden" readonly rel="TIApplyAmount" name="txtIApplyAmount_' + item.InvoiceId + '" id="txtIApplyAmount_' + item.InvoiceId + '" value="0.00" />';
                            //trInvoicelist += '<input type="hidden" readonly rel="TIBalanceAmount" name="txtIBalanceAmount_' + item.InvoiceId + '" id="txtIBalanceAmount_' + item.InvoiceId + '" value="' + parseFloat(item.Balance, 10).toFixed(2) + '" />';
                            //trInvoicelist += '<input type="hidden" rel="TIOverflowAmount" name="hfTIOverflowAmount_' + item.InvoiceId + '" id="hfTIOverflowAmount_' + item.InvoiceId + '" value="0" />';
                            //trInvoicelist += '<td style="text-align:right;"><input type="hidden" rel="hdnIInvoiceAmount" id="hfINVbalanceAmount_' + item.InvoiceId + '" value="' + parseFloat(item.Balance, 10).toFixed(2).toString() + '" />$ <span rel="spnIInvoiceAmount">' + parseFloat(item.Balance, 10).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '</span></td>';
                            //trInvoicelist += '<td style="text-align:right;"><input type="text" readonly rel="TIApplyAmount" onchange="chkChangeinvAMT(' + item.InvoiceId + ')" name="txtIApplyAmount_' + item.InvoiceId + '" id="txtIApplyAmount_' + item.InvoiceId + '" value="0.00" /></td>';
                            //trInvoicelist += '<td style="text-align:right;"><input type="text" readonly rel="TIBalanceAmount" name="txtIBalanceAmount_' + item.InvoiceId + '" id="txtIBalanceAmount_' + item.InvoiceId + '" value="' + parseFloat(item.Balance, 10).toFixed(2) + '" />';
                            //trInvoicelist += '<input type="hidden" rel="TIOverflowAmount" name="hfTIOverflowAmount_' + item.InvoiceId + '" id="hfTIOverflowAmount_' + item.InvoiceId + '" value="0" /></td>';
                            trInvoicelist += '</tr>';
                            tblinvoiceList.append(trInvoicelist);

                            applyMaskCurrency('#txtIApplyAmount_' + item.InvoiceId)
                            applyMaskCurrency('#txtIBalanceAmount_' + item.InvoiceId)
                        });


                        var oTable = $('#invoiceList1').DataTable({
                            "paging": true,
                            "ordering": true,
                            "info": true,
                            "bProcessing": true,
                            "pageLength": 10,
                            "dom": "<'headerbox list'><'table-responsive't><'bottom'ip><'clear'>"

                        });


                        isShowInvoicelist = true;
                        if (errCustomerName != '' && errCustomerName != undefined) {
                            $('#invoiceList1').DataTable().search(errCustomerName).draw();
                        }

                        txtEApplyAmount = 0;
                        txtEBalanceAmount = 0;
                        txtELockboxAmount = 0;
                        $.unblockUI();


                        $("#divrightckbox").html('<a href="javascript:void(0);"  class="btn btn-primary pull-right" onclick="btnApply_SelectedInvoice('+id+',\'' + chkno + '\')" style="margin-right:10px;">Apply</a>');

                        $("#input_SearchMP").keyup(function () {
                            var table = $("#invoiceList1").DataTable();
                            table.search($(this).val()).draw();
                        });



                    },
                    error: function (err) {
                        alert('failure');
                        $.unblockUI();
                    },
                });
        }
        var _lockboxDetailOpened = 0;

        //functions
        function _bindInvoiceListLB() {
            refreshTable(_idInvoiceList, _chknoInvoiceList);
        }

        $('#chkIsOpen').click(function () {
            refreshTable(_idInvoiceList, _chknoInvoiceList);
        });
        $('#chkIsClose').click(function () {
            refreshTable(_idInvoiceList, _chknoInvoiceList);
        });
        $('#chkIsConsolidated').click(function () {
            refreshTable(_idInvoiceList, _chknoInvoiceList);
        });

        $('#select_dateRangeMP').change(function () {
            console.log(2)
            applyDurationFilterMP(parseInt($(this).val()));
            if (parseInt($(this).val()) != 15 && parseInt($(this).val()) != 16)
                refreshTable(_idInvoiceList, _chknoInvoiceList);
        });
        $('#txtStartDate').change(function () {

            $('#spnStartDate').html($(this).val());
            if ($('#txtStartDate').val() != '' && $('#txtEndtDate').val() != '')
                refreshTable(_idInvoiceList, _chknoInvoiceList);
        });
        $('#txtEndtDate').change(function () {

            $('#spnEndtDate').html($(this).val());
            if ($('#txtStartDate').val() != '' && $('#txtEndtDate').val() != '')
                refreshTable(_idInvoiceList, _chknoInvoiceList);
        });
        $('#lbmonthlist').change(function () {
            $('#spnStartDate').html('');
            if ($('#lbmonthlist').val() != '' && $('#lbyearlist').val() != '')
                refreshTable(_idInvoiceList, _chknoInvoiceList);
        });
        $('#lbyearlist').change(function () {
            $('#spnEndtDate').html('');
            if ($('#lbmonthlist').val() != '' && $('#lbyearlist').val() != '')
                refreshTable(_idInvoiceList, _chknoInvoiceList);
        });

        $('#monthlist').change(function () {
            $('#dtpfrom').val('');
            $('#dtpTo').val('');
            if ($('#monthlist').val() != '' && $('#yearlist').val() != '')
                refreshTable(_idInvoiceList, _chknoInvoiceList);
        });
        $('#yearlist').change(function () {
            $('#dtpfrom').val('');
            $('#dtpTo').val('');
            if ($('#monthlist').val() != '' && $('#yearlist').val() != '')
                refreshTable(_idInvoiceList, _chknoInvoiceList);
        });


        var _idInvoiceList = 0;
        var _chknoInvoiceList = 0;


        function bindLockboxErrorDataList(id, chkno) {
            _idInvoiceList = id;
            _chknoInvoiceList = chkno;

            $('#input_SearchMP').val('');
            $('#select_dateRangeMP').val(17);
            $('#chkIsOpen').prop("checked", true);
            $('#chkIsClose').prop("checked", true);
            $('#chkIsConsolidated').prop("checked", false);
            

            //$('#chkIsOpen').click(function () {
            //        refreshTable(id, chkno);
            //});
            //$('#chkIsClose').click(function () {
            //    refreshTable(id, chkno);
            //});
            //$('#chkIsConsolidated').click(function () {
            //    refreshTable(id, chkno);
            //});

            //$('#select_dateRangeMP').change(function () {
            //    console.log(2)
            //    applyDurationFilterMP(parseInt($(this).val()));
            //    if (parseInt($(this).val()) != 15 && parseInt($(this).val()) != 16)
            //        refreshTable(id, chkno);
            //});
            //$('#txtStartDate').change(function () {
                
            //    $('#spnStartDate').html($(this).val());
            //    if ($('#txtStartDate').val() != '' && $('#txtEndtDate').val() != '')
            //        refreshTable(id, chkno);
            //});
            //$('#txtEndtDate').change(function () {
                
            //    $('#spnEndtDate').html($(this).val());
            //    if ($('#txtStartDate').val() != '' && $('#txtEndtDate').val() != '')
            //        refreshTable(id, chkno);
            //});
            //$('#lbmonthlist').change(function () {
            //    $('#spnStartDate').html('');
            //    if ($('#lbmonthlist').val() != '' && $('#lbyearlist').val() != '')
            //        refreshTable(id, chkno);
            //});
            //$('#lbyearlist').change(function () {
            //    $('#spnEndtDate').html('');
            //    if ($('#lbmonthlist').val() != '' && $('#lbyearlist').val() != '')
            //        refreshTable(id, chkno);
            //});

            //$('#monthlist').change(function () {
            //    $('#dtpfrom').val('');
            //    $('#dtpTo').val('');
            //    if ($('#monthlist').val() != '' && $('#yearlist').val() != '')
            //        refreshTable();
            //});
            //$('#yearlist').change(function () {
            //    $('#dtpfrom').val('');
            //    $('#dtpTo').val('');
            //    if ($('#monthlist').val() != '' && $('#yearlist').val() != '')
            //        refreshTable();
            //});


            applyDurationFilterMP(parseInt($('#select_dateRangeMP').val()));


            $('#divInvoiceListSelected').hide();
            $('#invoiceListSelected tbody').html('');
            errLBDetail = [];
            errLBDetailSelectedCount = 0;
            $('input[rel="mgglchk"]').prop('checked', false);
            $('input[rel="TIApplyAmount"]').prop('value', 0);
            $('input[rel="TIBalanceAmount"]').prop('value', 0);

            $('#spnEBankName').html('');
            $('#spnEBankAccount').html('');
            $('#spnECheckNo').html('');
            $('#spnELockboxAmount').html('');


            applyMaskCurrency('#txtEApplyAmount');
            applyMaskCurrency('#txtEBalanceAmount');

            var selectedErrDetail = $.grep(AllDetailRow, function (item, i) { return item.CheckNumber == chkno; });
            $('#spnEBankName').html(selectedErrDetail[0].BankName != null ? selectedErrDetail[0].BankName : "");
            $('#spnEBankAccount').html(selectedErrDetail[0].AccountNumber != null ? selectedErrDetail[0].AccountNumber : '');
            $('#spnECheckNo').html(selectedErrDetail[0].CheckNumber);
            $('#spnELockboxAmount').html(parseFloat(selectedErrDetail[0].DollarAmount, 10).toFixed(2).toString().toString().replace(/\B(?=(\d{3})+(?!\d))/g, ","));
            $('#txtEApplyAmount').val(0.00);
            $('#txtEBalanceAmount').val(parseFloat(selectedErrDetail[0].DollarAmount, 10).toFixed(2).toString());


            var tblinvoiceList = $('#tblviewdetail tbody');
            tblinvoiceList.html("");
            selectedErrDetail.forEach(function (item) {
                errLBDetail.push(item);
                if ((item.CustomerName != null ? item.CustomerName : '') != '')
                    errCustomerName = item.CustomerName;
                else
                    errCustomerName = '';




                if (item.CustomerId == null) {

                    $('#divtblviewdetail_invoicelist').show();
                    $('#divtblviewdetail_invoicelist_btn').show();
                }
                //else {
                trInvoicelist = "";
                trInvoicelist += '<tr id="lbediRow_' + item.LockboxEDIDetailId + '"  relInvid="' + item.InvoiceId + '" relcusId="' + item.CustomerId + '" relLbId="' + item.LockboxEDIDetailId + '">'
                trInvoicelist += '<td style="text-align:center"><span name="spnECustomerNumber_' + item.LockboxEDIDetailId + '" id="spnECustomerNumber_' + item.LockboxEDIDetailId + '">' + item.CustomerNo + '</span></td>'
                trInvoicelist += '<td style="text-align:center"><span id="spnECustomerName_' + item.LockboxEDIDetailId + '">' + (item.CustomerName != null ? item.CustomerName : '') + '</span></td>'
                trInvoicelist += '<td style="text-align:center"><span id="spnEInvoiceNumber_' + item.LockboxEDIDetailId + '">' + item.InvoiceNo + '</span></td>'
                trInvoicelist += '<td style="text-align:right"><span id="spnEInvoiceAmount_' + item.LockboxEDIDetailId + '">' + (item.InvoiceAmount != null ? ('$ ' + parseFloat(item.InvoiceAmount, 15).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",")) : '') + '</span></td>'
                trInvoicelist += '<td style="text-align:right">$ ' + parseFloat(item.ApplyAmount, 15).toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + '<span style="display:none" id="spnEApplyAmount_' + item.LockboxEDIDetailId + '" id="spnEApplyAmount_' + item.LockboxEDIDetailId + '">' + parseFloat(item.ApplyAmount, 15).toFixed(2) + '</span></td>'
                trInvoicelist += '</tr>'

                tblinvoiceList.append(trInvoicelist);
            });

            if (_lockboxDetailOpened == 0) {
                console.log(3)
                _lockboxDetailOpened = 1;
                refreshTable(id, chkno, 1);
            } else {
                console.log(3.1)
                refreshTable(id, chkno);
            }

            jQuery(function ($) {
                $('#tblviewdetail tbody tr').click(function () {
                    return false;
                }).dblclick(function () {
                    bindINvoiceList();
                    return false;
                });
            });
            $("#modal_lockboxview_error_detail").modal({ backdrop: 'static' });
        }
        var isShowInvoicelist = false;
        var InvoicelistH = [];
        function bindINvoiceList() {
            $("#divtblviewdetail_invoicelist").show();
            $('input[rel="mgglchk"]').prop('checked', false);
            $('input[rel="TIApplyAmount"]').prop('value', '0.00');
            //$('input[rel="TIBalanceAmount"]').prop('value', '0.00');



        };

        function getInvoiceIdChunk(elem) {
            return $(elem).attr("id").split('_')[0];
        }
        function btnOpenApplyPaymentForm(id, InvoiceNo, chknum) {

            $('#hdf_errlockbox_detail_Invoiceid').val(id);
            $('#hdf_errlockbox_detail_InvoiceChequeno').val(chknum);
            $('#spninvoicenumber_err_detail').html(InvoiceNo);
            $("#modal_lockboxview_error_detailconfirm").modal({ backdrop: 'static' });
        };
        function btnOpenApplyPaymentFormYes() {
            var InvId = $('#hdf_errlockbox_detail_Invoiceid').val();
            var InvCheckNumber = $('#hdf_errlockbox_detail_InvoiceChequeno').val();
            var sURL = '@Url.Action("GetApplyLockboxPaymentForm", "AccountReceivable", new { area = "Portal" })?Id=' + InvId;
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    $.blockUI();
                    if (!data) {


                        var tblinvoiceList = $('#lockboxsummaryList tbody');

                        var selectedErrDetail = $.grep(_lockboxRawData, function (t, i) { return t.InvoiceId == InvId; })[0];

                        var vInvoiceDate = (selectedErrDetail.InvoiceDate != null ? moment(new Date(parseInt(selectedErrDetail.InvoiceDate.substr(6)))).format("MM/DD/YYYY") : "");
                        var vInvoiceAmount = (selectedErrDetail.Amount != null ? parseFloat(selectedErrDetail.Amount, 10).toFixed(2).toString() : 0);

                        var vInvoiceOAmount = (selectedErrDetail.InvoiceOAmount != null ? parseFloat(selectedErrDetail.InvoiceOAmount, 10).toFixed(2).toString() : 0);

                        AppendLockboxItem(0, selectedErrDetail.RowNo, selectedErrDetail.CheckNumber, selectedErrDetail.LockboxEDIDetailId, selectedErrDetail.CustomerId, selectedErrDetail.CustomerNo,
                            selectedErrDetail.CustomerName, selectedErrDetail.InvoiceId, selectedErrDetail.InvoiceNo, vInvoiceDate, selectedErrDetail.InvoiceAmount, selectedErrDetail.InvoiceOAmount,
                            selectedErrDetail.ApplyAmount, selectedErrDetail.BalanceAmount, false, true, 49,
                            selectedErrDetail.DollarAmount, selectedErrDetail.OverflowAmount, true, false, '', '', -1, -1, '', '')


                        $('#txtVTotalAmountoApply').val((parseFloat($('#txtVTotalAmountoApply').val().toString().replace(',', ''), 10) + parseFloat((selectedErrDetail.ApplyAmount != null ? parseFloat(selectedErrDetail.ApplyAmount) : 0), 10)).toFixed(2).toString());
                        $('#txtVTotalAmountExecption').val((parseFloat($('#txtVTotalAmountExecption').val().toString().replace(',', ''), 10) - parseFloat((selectedErrDetail.ApplyAmount != null ? parseFloat(selectedErrDetail.ApplyAmount) : 0), 10)).toFixed(2).toString());

                        $('#txtVTotalAmountoApplyT').val((parseFloat($('#txtVTotalAmountoApplyT').val().toString().replace(',', ''), 10) + parseFloat((selectedErrDetail.ApplyAmount != null ? parseFloat(selectedErrDetail.ApplyAmount) : 0), 10)).toFixed(2).toString());

                        $('tr[rel = "umcr_' + InvCheckNumber + '"]').remove();
                    }
                    else {
                        btnOpenApplyPaymentFormOpen($('#hdf_errlockbox_detail_Invoiceid').val())
                    }
                    $("#modal_lockboxview_error_detailconfirm").modal('hide');

                    var count = $('#lockboxsummaryListUnmatched tbody').children('tr').length;
                    if(count==0)
                        $('#btnProcessPayment_OnSubmit').prop('disabled',false);

                    $.unblockUI();
                },
                error: function () {
                    alert("Content load failed.");
                    $("#modal_lockboxview_error_detailconfirm").modal('hide');
                }
            });
        };
        function btnOpenApplyPaymentFormNo() {
            $('#hdf_errlockbox_detail_Invoiceid').val('');
            $("#modal_lockboxview_error_detailconfirm").modal('hide');
        };



        function btnOpenApplyPaymentFormOpen(id) {

            var existingForm = $("#inv" + id + "_modal_applypaymentform");

            if ($(existingForm).length > 0) // already fetched form, so just display it again
            {
                $(existingForm).modal({ backdrop: 'static' });
            }
            else // first time loading form, so fetch by ajax
            {
                var sURL = '@Url.Action("ApplyLockboxPaymentForm", "AccountReceivable", new { area = "Portal" })?Id=' + id;
                $.ajax({
                    type: "GET",
                    url: sURL,
                    contentType: "application/json; charset=utf-8",
                    datatype: "json",
                    success: function (data) {
                        vselCust = 0;

                        $('#divApplyPartialPayment').append(data);
                        var newForm = $('#divApplyPartialPayment').children().last();

                        $(".date-picker").datepicker();

                        var inv = getInvoiceIdChunk(newForm);
                        initPaymentForm(inv);
                        //var selectedErrDetail = $.grep(AllDetailRow, function (t, i) { return t.InvoiceId == id; })[0];

                        var vApplyAmount = ($('#txtIApplyAmount_' + id).val() != null ? parseFloat($('#txtIApplyAmount_' + id).val(), 10).toFixed(2).toString() : '');
                        $("#inv" + id + "_paymentAmt").val(parseFloat(vApplyAmount, 10).toFixed(2));
                        $("#inv" + id + "_modal_applypaymentform").modal({ backdrop: 'static' });
                    },
                    error: function () {
                        alert("Content load failed.");
                    }
                });
            }
        };
        function initPaymentForm(inv) {

            var invPrefix = getInvoicePrefix(inv);

            var totalPayment = parseFloat($("#" + invPrefix + "totalPayment").val());
            if ($.isNumeric(totalPayment)) {
                $("#" + invPrefix + "paymentAmt").val(totalPayment.toFixed(2));
            }

            refreshPaymentForm(inv);
            showFranchiseesForLineNumber(inv, 1);
            togglePaymentUnitColumns(inv);
        }

        function buildFilters(table, element, filterClass) {
            var searchFilters;
            if (filterClass === "undefined") {
                filterClass = ".searchFilter";
            }
            if (typeof element === "undefined") {
                searchFilters = $(filterClass);
            } else {
                searchFilters = $(element).find(filterClass);
            }
            searchFilters.each(function () {
                var t = $(this);
                var type = t.data('type'),
                    col = t.data('col'),
                    id = this.id;
                if (type === 'select') {
                    //build options
                    table.column(col).data().unique().sort().each(function (d, j) {
                        t.append('<option value="' + d + '">' + d + '</option>')
                    });
                    //apply filters
                    t.on('change', function () {
                        var val = $(this).val();

                        table.column(col)
                            .search(val ? '^' + $(this).val() + '$' : val, true, false)
                            .draw();
                    })
                } else {
                    t.on('keyup change', function () {
                        table
                            .column(col)
                            .search(this.value)
                            .draw();
                    });
                }
            })
        }

        var txtEApplyAmount = 0;
        var txtEBalanceAmount = 0;
        var txtELockboxAmount = 0;



        function hideInvoiceListApply(id, CheckNumber) {
            if (txtEBalanceAmount == 0) {
                CheckNumber = $('#spnECheckNo').html();

                var _partialInvoiceId = 0;
                var _partialInvoiceNo = 0;
                var _partialCheckNumber = 0;

                $('tr[rel = "mcr_' + CheckNumber + '"]').remove();
                $('input[rel="mgglchk"]').each(function (item) {
                    if ($(this).is(":checked")) {
                        var InvId = $(this).val();


                        var tblinvoiceList = $('#lockboxsummaryList tbody');

                        var selectedErrDetail = $.grep(InvoicelistH, function (t, i) { return t.InvoiceId == InvId; })[0];

                        var vInvoiceDate = (selectedErrDetail.InvoiceDate != null ? moment(new Date(parseInt(selectedErrDetail.InvoiceDate.substr(6)))).format("MM/DD/YYYY") : "");
                        var vInvoiceAmount = (selectedErrDetail.Amount != null ? parseFloat(selectedErrDetail.Amount, 10).toFixed(2).toString() : '');
                        var vApplyAmount = ($('#txtIApplyAmount_' + InvId).val() != null ? parseFloat($('#txtIApplyAmount_' + InvId).val(), 10).toFixed(2).toString() : '');
                        var vBalanceAmount = ($('#txtIBalanceAmount_' + InvId).val() != null ? parseFloat($('#txtIBalanceAmount_' + InvId).val(), 10).toFixed(2).toString() : '');



                        var trInvoicelist = "";
                        trInvoicelist += '<tr  rel="mcr_' + CheckNumber + '"><td style="width:25px;text-align:center;">'
                        trInvoicelist += '<input type="hidden" name="hf_' + InvoiceId + '_LockboxEDIDetailId" value="' + LockboxEDIDetailId + '" />'
                        trInvoicelist += '<input type="hidden" name="hf_' + InvId + '_customerid" value="' + selectedErrDetail.CustomerId + '" />'
                        trInvoicelist += '<input type="hidden" name="hf_' + InvId + '_chkNumber" value="' + CheckNumber + '" />'
                        trInvoicelist += '<input type="hidden" name="hf_' + InvId + '_invoiceid" value="' + InvId + '" />'
                        trInvoicelist += '<input type="hidden" name="hf_' + InvId + '_invoiceamount" value="' + vInvoiceAmount + '" />'
                        trInvoicelist += '<input type="hidden"name="hf_' + InvId + '_applyamount" value="' + vApplyAmount + '" />'
                        trInvoicelist += '<input type="hidden"name="hf_' + InvId + '_balanceamount" value="' + vBalanceAmount + '" />'
                        trInvoicelist += '</td>'

                        trInvoicelist += '<td style="text-align: left;padding-left: 30px!important;"><a href="javascript:void(0)" onclick="bindLockboxErrorDataList(' + selectedErrDetail.LockboxEDIDetailId + ',\'' + CheckNumber + '\')">' + CheckNumber + '</a></td>'
                        trInvoicelist += '<td style="text-align: left;padding-left: 30px!important;">' + selectedErrDetail.CustomerNo + '</td>'
                        trInvoicelist += '<td style="text-align: left;padding-left: 30px!important;">' + selectedErrDetail.CustomerName + '</td>'
                        trInvoicelist += '<td style="text-align:center;"><a href="javascript:void(0)" onclick="btnOpenInvoiceDetail(' + InvId + ')">' + selectedErrDetail.InvoiceNo + '</a></td>'
                        trInvoicelist += '<td style="text-align:center;">' + vInvoiceDate + '</td>'
                        trInvoicelist += '<td style="text-align:right;">$ ' + vInvoiceAmount + '</td>'
                        trInvoicelist += '<td style="text-align:right;">$ ' + vApplyAmount + '</td>'
                        trInvoicelist += '<td style="text-align:right;width:120px;">$ ' + vBalanceAmount + '</td></tr>'



                        $('#txtVTotalAmountoApply').val((parseFloat($('#txtVTotalAmountoApply').val().toString().replace(',', ''), 10) + parseFloat(vApplyAmount, 10)).toFixed(2).toString());
                        $('#txtVTotalAmountoApplyT').val((parseFloat($('#txtVTotalAmountoApplyT').val().toString().replace(',', ''), 10) + parseFloat(vApplyAmount, 10) + vOverflowAmount).toFixed(2).toString());
                        $('#txtVTotalAmountExecption').val((parseFloat($('#txtVTotalAmountExecption').val().toString().replace(',', ''), 10) - parseFloat(vApplyAmount, 10)).toFixed(2).toString());
                        $('#txtVTotalAmountCustomerCredit').val((parseFloat($('#txtVTotalAmountCustomerCredit').val().toString().replace(',', ''), 10) +vOverflowAmount).toFixed(2).toString());
                        tblinvoiceList.append(trInvoicelist);



                        $('tr[rel = "umcr_' + CheckNumber + '"]').remove();

                        $("#modal_lockboxview_error_detail").modal('hide');

                       
                    }
                });

               

                $("#divtblviewdetail_invoicelist").show();
            }
            else {
                alert("Please apply complete amount!")
            }
        }



        function btnOpenInvoiceDetail(id) {
            var sURL = '@Url.Action("InvoiceDetail", "AccountReceivable", new { area = "Portal" })?Id=' + id;
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    $.blockUI();//$.blockUI({ message: $('#throbberBlock'), theme: true, baseZ: 12000 });
                    $('#form_invoicedetail').html(data);
                    $("#modal_invoicedetail").modal({ backdrop: 'static' });
                    $.unblockUI();
                },
                error: function () {
                    alert("Content load failed.");
                }
            });

        }






        

        $("#btnProcessPayment_OnSubmit").click(function () {
            $.blockUI();//$.blockUI({ message: $('#throbberBlock'), theme: true, baseZ: 12000 });
            $('#hfSaveValue').val("Process")
            $("#from_lockboxsummary").submit();
        });

        $("#btnProcessPayment_OnSaveforLater").click(function () {
            $.blockUI();//$.blockUI({ message: $('#throbberBlock'), theme: true, baseZ: 12000 });
            $('#hfSaveValue').val("Save")
            $("#from_lockboxsummary").submit();

        });

        function OpenOtherDepositePopup(Id)
        {
            $.blockUI();
            var sURL = '@Url.Action("OtherDepositePopup", "AccountReceivable", new { area = "Portal" })?Id=' + Id;
            console.log(sURL);
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    $('#RenderOtherDepositePopup').html(data);
                    $.unblockUI();
                    applyAutoSeacrhComapnyOD(13);

                    var _lockboxedidetailid = Id;
                    var _lockboxediDetail = $.grep(_lockboxRawData, function (t, i) { return t.LockboxEDIDetailId == _lockboxedidetailid; })[0];
                    $('#OD_txtReferenceNo').val(_lockboxediDetail.CheckNumber);
                    $('#OD_txtAmount').val(_lockboxediDetail.DollarAmount);
                    $('#OD_txtDate').val(moment(new Date(parseInt(_lockboxediDetail.LockboxDate.substr(6)))).format("MM/DD/YYYY"));


                    applyMaskCurrency('#OD_txtAmount');
                    $(".date-picker").datepicker();
                    console.log(_lockboxediDetail);

                    $('#OD_btnSave').click(function () {
                        if (!searchIsValidOD()) {
                            swal('Please enter required values.')
                            return;
                        }
                        //$('#OD_txtPayeeType').val(t);
                        var vInvoiceDate = "";
                        var vInvoiceAmount = 0.00;
                        var vInvoiceOAmount = 0.00;
                        var vApplyAmount = ($('#OD_txtAmount').val() != "" ? parseFloat($('#OD_txtAmount').val(), 10) : 0.00);
                        var vBalanceAmount = 0.00;

                        AppendLockboxItem(0, _lockboxediDetail.RowNo, _lockboxediDetail.CheckNumber, _lockboxediDetail.LockboxEDIDetailId,
                            $('#OD_txtPayeeId').val(), $('#OD_txtPayeeNumber').val(), $('#OD_txtPayeeName').val(), -1, '', '', 0, 0, $('#OD_txtAmount').val(), 0, false, true, 49,
                            _lockboxediDetail.DollarAmount, 0, true,
                            true, $('#OD_txtReason').val(), $('#OD_txtPayeeType').val(), $('#OD_ServiceTypeListIdTrans').val(), $('#OD_txtPayeeId').val(), $('#OD_txtPayeeName').val(), $('#OD_txtPayeeNumber').val());

                        $('#txtVTotalAmountoApply').val((parseFloat($('#txtVTotalAmountoApply').val().toString().replace(',', ''), 10) + vApplyAmount).toFixed(2).toString());
                        $('#txtVTotalAmountExecption').val((parseFloat($('#txtVTotalAmountExecption').val().toString().replace(',', ''), 10) - vApplyAmount).toFixed(2).toString());
                        $('#txtVTotalAmountCustomerCredit').val((parseFloat($('#txtVTotalAmountCustomerCredit').val().toString().replace(',', ''), 10) + 0).toFixed(2).toString());
                        $('#txtVTotalAmountoApplyT').val((parseFloat($('#txtVTotalAmountoApplyT').val().toString().replace(',', ''), 10) + vApplyAmount + (parseFloat($('#txtVTotalAmountCustomerCredit').val().toString().replace(',', ''), 10) + 0)).toFixed(2).toString());
                        $('tr[rel = "umcr_' + _lockboxediDetail.CheckNumber + '"]').remove();

                        $("#modal_OtherDepositePopupDetail").modal('hide');

                        var count = $('#lockboxsummaryListUnmatched tbody').children('tr').length;
                        if (count == 0)
                            $('#btnProcessPayment_OnSubmit').prop('disabled', false);
                    });

                    $("#modal_OtherDepositePopupDetail").modal({ backdrop: 'static' });
                },
                error: function () {
                    $.unblockUI();
                    alert("Content load failed.");
                }
            });

        }


        function applyDurationFilterMP(v) {
            $('#spnStartDate').html('');
            $('#spnEndtDate').html('');
            $('.divspandate').show();
            $('#divSD').hide();
            $('#divED').hide();
            $('#divmonth').hide();
            $('#divyear').hide();
            $('#spnStartDate').html('');
            $('#spnEndtDate').html('');
            $('#lbmonthlist').val('');
            $('#lbyearlist').val('');
            switch (v) {
                case 1:
                    firstDay = moment().startOf('isoWeek').toString();
                    lastDay = moment().endOf('isoWeek').toString();
                    break;
                case 2:
                    //code block
                    firstDay = moment().startOf('isoWeek').toString();
                    lastDay = new Date().toString();
                    break;
                case 3:
                    firstDay = moment().subtract(0, 'month').startOf('month').toString();
                    lastDay = moment().subtract(0, 'month').endOf('month').toString();
                    break;
                case 4:
                    //code block
                    firstDay = moment().subtract(0, 'month').startOf('month').toString();
                    lastDay = new Date().toString();
                    break;
                case 5:
                    //code block
                    firstDay = moment().startOf('quarter').toString();
                    lastDay = moment().endOf('quarter').toString();
                    break;
                case 6:
                    //code block
                    firstDay = moment().startOf('quarter').toString();
                    lastDay = new Date().toString();
                    break;
                case 7:
                    //code block
                    firstDay = moment().startOf('year').toString();;
                    lastDay = moment().endOf('year').toString();
                    break;
                case 8:
                    //code block
                    firstDay = moment().startOf('year').toString();
                    lastDay = new Date().toString();
                    break;
                case 9:
                    //code block
                    firstDay = moment().toString();
                    lastDay = moment().toString();
                    break;
                case 10:
                    //code block
                    firstDay = moment().add(-1, 'days').toString();
                    lastDay = moment().add(-1, 'days').toString();
                    break;
                case 11:
                    //code block
                    firstDay = moment().subtract(1, 'week').startOf('week').toString();
                    lastDay = moment().subtract(1, 'week').endOf('week').toString();
                    break;
                case 12:
                    //code block
                    firstDay = moment().subtract(1, 'month').startOf('month').toString();
                    lastDay = moment().subtract(1, 'month').endOf('month').toString();
                    break;
                case 13:
                    //code block
                    firstDay = moment().subtract(1, 'quarter').startOf('quarter').toString();
                    lastDay = moment().subtract(1, 'quarter').endOf('quarter').toString();
                    break;
                case 14:
                    //code block
                    firstDay = moment().subtract(1, 'year').startOf('year').toString();
                    lastDay = moment().subtract(1, 'year').endOf('year').toString();
                    break;
                case 15:
                    //code block
                    $('.divspandate').hide();
                    $('#divSD').show();
                    $('#divED').show();
                    $('#txtStartDate').val('');
                    $('#txtEndtDate').val('')
                    break;
                case 16:
                    $('.divspandate').hide();
                    $('#divSD').hide();
                    $('#divED').hide();
                    $('#divmonth').show();
                    $('#divyear').show();
                    break
                case 17:
                    //code block
                    firstDay = moment().subtract(90, 'days').startOf('days').toString()
                    lastDay = new Date().toString();
                    break;
                default:
                //code block
            }
            $('#spnStartDate').html(moment(firstDay).format('L'));
            $('#spnEndtDate').html(moment(lastDay).format('L'));
        }


        function getSearchURL(_regionId) {
            var _searchtextVal = $('#input_SearchTop').val();
            var _consolidated = "false";
            var OC_Value = "";
            if ($('#chkIsOpen').is(":checked")) {
                OC_Value = "4,7";
            }
            if ($('#chkIsClose').is(":checked")) {
                if (OC_Value == "4,7")
                    OC_Value = OC_Value + ",6";
                else
                    OC_Value = "6";
            }

            if ($('#chkIsConsolidated').is(":checked")) {
                _consolidated = 'true';
            }
            
            //var _regionId = $("#regionlist").val();
            //var date = $('#dtpfrom').val() + '-' + $('#dtpto').val();
            var date = $('#spnStartDate').html() + '-' + $('#spnEndtDate').html();

            //$('#spnStartDate').html(moment(firstDay).format('L'));
            //$('#spnEndtDate').html(moment(lastDay).format('L'));
            var _monthVal = $('#lbmonthlist').val();
            var _yearVal = $('#lbyearlist').val();
            var _incClosed = "false";
            

            var sURL = '@Url.Action("OpenInvoiceListdataNew", "AccountReceivable", new { area = "Portal" })?rgId=' + _regionId + '&date=' + date + '&st=' + _searchtextVal + '&sb=' + 1 + '&closed=' + _incClosed + '&consolidated=' + _consolidated + '&OCValue=' + OC_Value + '&month=' + _monthVal + '&year=' + _yearVal;

            return sURL;
        }



        function onlyDecimal(id) {
            $(id).keydown(function (event) {
                if (event.shiftKey == true) { event.preventDefault(); }
                if ((event.keyCode >= 48 && event.keyCode <= 57) || (event.keyCode >= 96 && event.keyCode <= 105) || event.keyCode == 8 || event.keyCode == 9 || event.keyCode == 37 || event.keyCode == 39 || event.keyCode == 46 || event.keyCode == 190 || event.keyCode == 110) { }
                else { event.preventDefault(); }
                if ($(this).val().indexOf('.') !== -1 && (event.keyCode == 190 || event.keyCode == 110)) event.preventDefault();
            });
        }
        function OnlyNumber(id) {
            $(id).keydown(function (event) {
                if (event.shiftKey == true) { event.preventDefault(); }
                if ((event.keyCode >= 48 && event.keyCode <= 57) || (event.keyCode >= 96 && event.keyCode <= 105) || event.keyCode == 8 || event.keyCode == 9 || event.keyCode == 37 || event.keyCode == 39 || event.keyCode == 46) { }
                else { event.preventDefault(); }
            });
        }
        function applyMaskCurrency(id) {
            $(id).inputmask("currency", {
                alias: 'currency',
                prefix: '$ ',
                digits: 2,
                autoUnmask: true,
                removeMaskOnSubmit: true,
                unmaskAsNumber: true,
                allowPlus: false,
                allowMinus: true,
                autoGroup: true,
                groupSeparator: ",",
            });
        }

    </script>
}

