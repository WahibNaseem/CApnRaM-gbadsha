@{
    ViewBag.Title = "RegularCHKAccount";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@*<link href="~/Content/admin/assets/Card/dist/card.css" rel="stylesheet" />
<link href="~/Content/admin/assets/global/plugins/bootstrap-sweetalert/sweetalert.css" rel="stylesheet" />
<link href="@Url.Content("~/Content/admin/assets/global/plugins/datatables/datatables.min.css")" rel="stylesheet" type="text/css" />*@
@* <link href="@Url.Content("~/Content/admin/assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.css")" rel="stylesheet" type="text/css"/> *@
<link href="@Url.Content("~/Content/admin/assets/global/plugins/bootstrap-multiselect/css/bootstrap-multiselect.css")" rel="stylesheet" />
<link href="~/Content/admin/assets/global/plugins/icheck/skins/minimal/_all.css" rel="stylesheet"/>

@section styles{
    <link href="~/Content/admin/assets/layouts/layout2/css/custom-rev-1.css" rel="stylesheet"/>
    <link href="@Url.Content("~/Content/admin/assets/global/plugins/bootstrap-multiselect/css/bootstrap-multiselect.css")" rel="stylesheet" />
    <style type="text/css">
        .topheader {
            font-size: 14px;
            font-weight: bold;
            color: #FFF !important;
            text-transform: uppercase;
            margin-top: 3px;
        }


        .lbl-p5 { padding: 5px; }

        .lbl-p5.red { color: red; }


        .lbl-p5.green { color: lightgreen; }

        input[type="text"].txtcolon:before { content: ": "; }

        .credit-field { width: 80px !important; }

        .alignRight { text-align: right; }

        .alignCenter { text-align: center; }

        .close {
            background-image: url(/Content/admin/assets/global/img/stick_close.png) !important;
            height: 12px !important;
            width: 12px !important;
            margin-top: 0px !important;
        }

        .custom-listbox .headerbox {
            padding: 3px 0px 3px 5px;
            font-weight: normal;
        }

        .custom-listbox {
            margin-top: 4px;
            margin-bottom: 0px;
        }

        .row {
            margin: 0;
            padding: 3px 0;
        }

        .btn.multiselect {
            text-align: left;
            padding-top: 4px;
            padding-bottom: 4px;
            font-size: 11px;
            color: #555;
        }

        .multiselect .caret {
            right: 0;
            position: absolute;
            margin-top: 8px;
            margin-right: 8px;
        }

        .multiselect-container.dropdown-menu {
            text-transform: none;
            font-size: 14px;
        }

        .no-padding { padding: 0; }

        #modal_RegionModel .modal-content {
            width: 55% !important;
            margin-left: 30% !important;
        }

        table.dataTable thead th { padding: 4px !important; }
    </style>
}

<div class="headerbox">
    <div class="row" style="background-color: #3598DC; color: #fff;">
        <div class="col-md-12 no-padding">
            <div class="alignCenter">
                <div class="col-md-4" style="text-align: right;">
                </div>
                <div class="col-md-4 topheader">
                    Regular Account Check Book
                </div>

            </div>
        </div>
    </div>
</div>
<div class="custom-listbox" style="margin-top: 4px; margin-bottom: 0px;">
    <div class="headerbox">
        <input type="hidden" id="pageSize" value="100"/>
        <input type="hidden" id="trxType" value="0"/>
        <div class="row">
            <div class="col-md-2">
                <div class="input-icon">
                    <i class="icon-magnifier icon-align-right" style="margin-top: 6px;"></i>
                    <input id="input_Search" type="text" name="input_Search" autocomplete="off" placeholder="Search Within Results" value="" class="form-control input-sm typeahead"/>
                </div>
            </div>
            <div class="col-md-3"></div>
                <div class="col-md-7">
                    <div class="col-md-2 col-md-push-8 no-padding">
                        <select id="select_timeduration" class="form-control input-sm">
                            <option value="1">This Week</option>
                            <option value="2">This Week-to-date</option>
                            <option value="3">This Month</option>
                            <option value="4">This Month-to-date</option>
                            <option value="5">This Quarter</option>
                            <option value="6">This Quarter-to-date</option>
                            <option value="7">This Fiscal Year</option>
                            <option value="8">This Fiscal Year-to-date</option>
                            <option value="9">Today</option>
                            <option value="10">Yesterday</option>
                            <option value="11">Last Week</option>
                            <option value="12">Last Month</option>
                            <option value="13">Last Quarter</option>
                            <option value="14">Last Year</option>
                            <option value="15">Custom Date</option>
                            <option value="16">Period</option>
                        </select>
                    </div>
                    <div class="col-md-3  col-md-push-8 no-padding" style="margin-left: 3px; width: 85px; display: none;" id="divSD">
                        <input type="text" name="txtStartDate" id="txtStartDate" placeholder="MM/DD/YYYY" value="" class="form-control input-sm date-picker RemovePeriodvalidation" style="padding: 3px;" />
                    </div>
                    <div class="col-md-3  col-md-push-8 no-padding"  placeholder="MM/DD/YYYY" style="margin-left: 3px; width: 85px; display: none;" id="divED">
                        <input type="text" name="txtEndDate" id="txtEndDate" value="" class="form-control input-sm date-picker RemovePeriodvalidation" style="padding: 3px;" />
                    </div>
                    <div class="col-md-3  col-md-push-8  no-padding" style="margin-left: 3px; width: 85px;" id="divMonth">
                        <select id="monthList" class="form-control input-sm">
                            <option value=""></option>
                            <option value="1">Jan</option>
                            <option value="2">Feb</option>
                            <option value="3">Mar</option>
                            <option value="4">Apr</option>
                            <option value="5">May</option>
                            <option value="6">June</option>
                            <option value="7">July</option>
                            <option value="8">Aug</option>
                            <option value="9" selected>Sep</option>
                            <option value="10">Oct</option>
                            <option value="11">Nov</option>
                            <option value="12">Dec</option>
                        </select>
                    </div>
                    <div class="col-md-3  col-md-push-8 no-padding" style="margin-left: 3px; width: 85px" id="divYear">
                        <select class="form-control input-sm" id="yearList" style="padding-left: 2px;">
                            <option value=""></option>
                            <option value="2018" selected>2018</option>
                            <option value="2017">2017</option>
                            <option value="2016">2016</option>
                            <option value="2015">2015</option>
                            <option value="2014">2014</option>
                            <option value="2013">2013</option>
                            <option value="2012">2012</option>
                            <option value="2011">2011</option>
                            <option value="2010">2010</option>
                        </select>
                    </div>
            </div>
        </div>
    </div>
</div>
<div class="tablebox" style="margin-top: -9px;">
    <div class="row">
        <div class="row no-padding">
            <div class="table-responsive">
                <table class="table table-striped table-bordered table-hover" id="RegularCHKAccountList">
                <thead>
                <tr><th colspan="7" style="text-align: center;">Transactions <span id="spnStartDate"></span> <span id="spnEndDate"></span>
            </th></tr>
                <tr>
                    <th colspan="6" style="text-align: right;">STARTING GL BALANCE: </th>
                    <th style="width: 140px; text-align: right;">
                        <div id="startingBalance"></div>
                    </th>
                </tr>
            <tr>
                <th style="width: 140px; text-align: center;">Chk/Dep/Bank</th>
                <th style="text-align: center; width: 140px;">Date</th>
                <th style="width: 60%; text-align: left;">Description</th>
                <th style="width: 140px; text-align: center;">Reference</th>
                <th style="width: 140px; text-align: right;">Deposit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
                <th style="width: 140px; text-align: right;">Withdrawal&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
                <th style="width: 140px; text-align: right; white-space: nowrap;">Balance&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
            </tr>
            </thead>
            <tbody></tbody>
            <tfoot>
            </tfoot>
            </table>
        </div>
    </div>
</div>
</div>

<div class="modal fade custom-model custom-form-design" id="modal_CheckDetail" tabindex="-1" role="basic" aria-hidden="true" style="display: none;">
    <div class="modal-dialog" style="width: 800px">
        <div class="modal-content" style="border-radius: 8px;">
            <div class="modal-header headerbox list" style="padding: 0px !important; border-bottom: none;">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="margin-top: 12px !important; margin-right: 12px !important;"></button>
                <h4 class="modal-title" style="margin-top: 0px; margin-bottom: 4px; padding: 7px !important; font-size: 12px; font-weight: bold; background: #3598DC !important; color: #FFF !important; border: 1px solid #3598DC !important; padding: 0px; border-radius: 8px 8px 0 0; text-transform: uppercase;">
                    Transaction Details
                </h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-8">
                        <div class="custom-form portlet light" style="margin: 0px auto; padding: 0;">
                            <div class="custom-form portlet light" style="margin: 0px auto; padding: 0;">
                                <div class="portlet-body form">
                                    <table class="table table-bordered table-responsive">
                                        <thead class="table-header-fixed">
                                        <tr>
                                            <th colspan="3">
                                                <h6>Vendor</h6>
                                            </th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr>
                                            <td style="text-align: right;">Vendor ID:</td>
                                            <td style="text-align: left;">
                                                <div id="vendorId"></div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: right;">Name:</td>
                                            <td style="text-align: left;">
                                                <div id="vendorName"></div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: right;">Address:</td>
                                            <td style="text-align: left;">
                                                <div id="vendorAddressLine1"></div><br/>
                                                <div id="vendorAddressLine2"></div><br/>
                                                <div id="vendorAddressCityStateZip"></div>
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="custom-form portlet light" style="margin: 0px auto; padding: 0;">
                            <div class="custom-form portlet light" style="margin: 0px auto; padding: 0;">
                                <div class="portlet-body form">
                                    <table class="table table-bordered table-responsive">
                                        <thead class="table-header-fixed">
                                        <tr>
                                            <th colspan="3">
                                                <h6>Check</h6>
                                            </th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr>
                                            <td style="text-align: right;">Check No:</td>
                                            <td style="text-align: right;">
                                                <div id="checkNumber"></div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: right;">Date:</td>
                                            <td style="text-align: right;">
                                                <div id="checkDate"></div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="text-align: right;">Amount:</td>
                                            <td style="text-align: right;">
                                                <div id="checkAmount"></div>
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <br/>
                <div class="row">
                    <h3>Transactions from 08/01/2017 thru 08/31/2017</h3>
                    <table class="table table-bordered table-responsive" width="100%">
                        <thead>
                        <tr>
                            <th colspan="6" style="text-align: center; background: #3598dc; color: #FFF !important;">Transaction Details</th>
                        </tr>
                        <tr>
                            <th style="width: 60px; text-align: center;">Number</th>
                            <th style="width: 60px; text-align: center;">Date</th>
                            <th style="width: 60px; text-align: center;">Amount</th>
                            <th style="width: 180px; text-align: center;">Description</th>
                            <th style="width: 60px; text-align: center;">GL Account</th>
                            <th style="width: 60px; text-align: center;">Amount</th>
                        </tr>
                        </thead>
                        <tbody id="tableBodyTrxDetails"></tbody>
                    </table>
                </div>
                <hr/>
                <div class="row">
                    <div class="col-md-5">
                        @*<button type="button" class="btn btn-primary button-next" style="margin-right:10px;" onclick="DetailCreditListPrint()">Print <i class="fa fa-print"></i></button>*@
                        @*<button type="submit" class="btn btn-primary button-next" style="margin-right:10px;" onclick="DetailCreditListExportPDF()">Export <i class="fa fa-download"></i></button>*@
                        @*<button type="button" class="btn btn-primary button-next" style="margin-right:10px;" @*onclick="DetailInvoiceListSendEmail()"*>Email <i class="fa fa-envelope"></i></button>*@
                        @*<button type="button" class="btn btn-primary button-next" id="btnPrintModel" onclick="ExportPDFForm()">
                                Print
                                <i class="fa fa-print"></i>
                            </button>*@
                    </div>
                    <div class="col-md-2"></div>
                    <div class="col-md-5">
                        <button type="button" class="btn btn-primary button-next  pull-right" data-dismiss="modal">
                            Close
                            <i class="fa fa-close"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section pageplugins{
    @if (Request.IsSecureConnection)
    {
        <script src="https://code.jquery.com/ui/1.11.4/jquery-ui.js" type="text/javascript"></script>
    }
    else
    {
        <script src="http://code.jquery.com/ui/1.11.4/jquery-ui.js" type="text/javascript"></script>
    }
    <!-- BEGIN PAGE LEVEL PLUGINS -->
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/select2/js/select2.full.min.js")" type="text/javascript"></script>
    @* <script src="@Url.Content("~/Content/admin/assets/global/plugins/jquery-validation/js/jquery.validate.min.js")" type="text/javascript"></script> *@
    @* <script src="@Url.Content("~/Content/admin/assets/global/plugins/jquery-validation/js/additional-methods.min.js")" type="text/javascript"></script> *@
    @* <script src="@Url.Content("~/Content/admin/assets/global/plugins/bootstrap-wizard/jquery.bootstrap.wizard.min.js")" type="text/javascript"></script> *@
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/jquery-inputmask/jquery.inputmask.bundle.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/scripts/datatable.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/datatables/datatables.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/scripts/app.min.js")" type="text/javascript"> </script>
    <script src="@Url.Content("~/Content/admin/assets/pages/scripts/table-datatables-managed.min.js")" type="text/javascript"></script>
    @* <script src="~/Content/admin/assets/global/plugins/icheck/icheck.min.js"></script> *@
}

@section scripts{
    <script>

    var regularCHKAccountTable;
    var timeDurationSelection, filterLabel;
    var monthSelected, yearSelected, regionSelected;
    var startDateSelected, endDateSelected;

    $(window).load(function() {
        $('link[href="/Content/admin/assets/layouts/layout2/css/custom.css"]').prop('disabled', true);
        $('link[href="/Content/admin/assets/layouts/layout2/css/custom.css"]').remove();
        $('head').append('@Url.Content("~/Content/admin/assets/layouts/layout2/css/custom-rev-1.css")');

        monthSelected = '@ViewBag.currentPeriodMonth';
        yearSelected = '@ViewBag.currentPeriodYear';
        regionSelected = '@ViewBag.selectedRegionId';

        $('#select_timeduration').val(16).change();
//            $('#divMonth').val(monthSelected).change();
//            $('#divYear').val(yearSelected).change();
        $('#divMonth').show();
        $('#divYear').show();

        timeDurationSelection = $('#select_timeduration').val();
        applyDurationFilter(timeDurationSelection);
        initPage();
        $('#input_Search').focus();
    });


    function initPage() {
        if ($.fn.DataTable.isDataTable("#RegularCHKAccountList")) {
            $('#RegularCHKAccountList').DataTable().clear().destroy();
        }

        var sURL = '@Url.Action("getregularaccounttransactions", "company", new {area = "Portal"})?region=' +
            regionSelected +
            '&month=' +
            monthSelected +
            '&year=' +
            yearSelected +
            '';
        var ps = $('#pageSize').val();
        var checkLinkToDetail;

        regularCHKAccountTable = $('#RegularCHKAccountList').DataTable({
            "bAutoWidth": false,
            "cache": false,
            "ordering": false,
            "iDisplayLength": ps === '-1' ? 100 : ps,
            "dom": "<'table-responsive't><'bottom'ip><'clear'>",
            "ajax": {
                "url": sURL,
                "dataSrc": function(json) {
                    return json.returnedData;
                },
                "deferRender": true
            },
            "columns": [
                {
                    "data": "SourceId",
                    "render": function(data, type, full) {
                        var amount = formatCurrency(full.balance);
                        if (full.SourceId === '0') {
                            $('#startingBalance').text('$ ' + amount);
                            $('#endingBalance').text('CURRENT GL BALANCE: $ ' + amount);
                        }
                        checkLinkToDetail = '';
                        if (full.dramountfgn == 0) {
                            checkLinkToDetail = '<a class="trxNumLink" id="trxNumLink' +
                                full.SourceId +
                                '" data-trxid=' +
                                full.SourceId +
                                ' onclick="btnOpenCheckDetail(' +
                                full.SourceId +
                                ')">' +
                                full.SourceId +
                                '</a>';
                        } else {
                            checkLinkToDetail = full.SourceId;
                        }
                        return checkLinkToDetail;


                        return full.SourceId;
                    },
                    "class": "text-center",
                },
                {
                    "data": "transdate",
                    "render": function(data, type, full) {
                        var date = formatJSONDateUtc(full.transdate);
                        return date;
                    },
                    "class": "text-center",
                    "sortable": true
                },
                {
                    "data": "descr",
                    "sortable": false
                },
                {
                    "data": "reference",
                    "class": "text-center",
                    "sortable": false
                },
                {
                    "data": "dramountfgn",
                    "render": function(data, type, full) {
                        var amount = formatCurrency(full.dramountfgn);
                        return '$' + amount;
                    },
                    "class": "text-right",
                    "sortable": false
                },
                {
                    "data": "cramountfgn",
                    "render": function(data, type, full) {
                        var amount = formatCurrency(full.cramountfgn);
                        return '$' + amount;
                    },
                    "class": "text-right",
                },
                {
                    "data": "balance",
                    "render": function(data, type, full) {
                        var amount = formatCurrency(full.balance);
                        return '$' + amount;
                    },
                    "searchable": false,
                    "createdCell": function(td, cellData, rowData, row) {
                        if (cellData < 0) {
                            $(td).addClass("text-danger font-weight-bold");
                        } else {
                            $(td).addClass("text-primary");
                        }
                    },

                    "class": "text-right ",
                }
            ],
            "rowCallback": function(row, data, full) {
                if (data.SourceId === "0") {
                    $(row).hide();
                }
            },
            "initComplete": function(settings, json) {
                //var maxRows = settings.aoData.length;
                //console.log(json);
            },
        });
        }

        jQuery(document).ready(function() {
            $('#monthList').change(function() {
                monthSelected = $(this).val();
                filterLabel = ' FOR THE ' + monthSelected + '/' + yearSelected + ' Period';
                initPage();
            });

            $('#yearList').change(function() {
                yearSelected = $(this).val();
                initPage();
            });

            $('#txtStartDate').change(function() {
                startDateSelected = $(this).val();
                endDateSelected = $("#txtEndDate").val();
                if (endDateSelected !== '') {
                    fromDate = new Date(startDateSelected);
                    toDate = new Date(endDateSelected);
                    if (toDate.getTime() >= fromDate.getTime()) {
                        initPage();
                    }
                }
            });

            $('#txtEndDate').change(function() {
                endDateSelected = $(this).val();
                startDateSelected = $("#txtStartDate").val();
                if (endDateSelected !== '') {
                    fromDate = new Date(startDateSelected);
                    toDate = new Date(endDateSelected);
                    if (toDate.getTime() >= fromDate.getTime()) {
                        initPage();
                    }
                }
            });

            $("#pageSize").change(function() {
                setPaging();
            });

            $('#divSD').hide();
            $('#divED').hide();


            firstDay = moment().subtract(0, 'month').startOf('month').toString();
            lastDay = moment().subtract(0, 'month').endOf('month').toString();

            $('#spnStartDate').html(moment(firstDay).format('L'));
            $('#spnEndDate').html(moment(lastDay).format('L'));


            $("#input_Search").keyup(function() {
//                var table = $("#RegularCHKAccountList").DataTable();
                regularCHKAccountTable.search($(this).val()).draw();
            });

            $("#txtStartDate").inputmask("99/99/9999", { "placeholder": "MM/DD/YYYY" });
            $("#txtEndDate").inputmask("99/99/9999", { "placeholder": "MM/DD/YYYY" });

//            $(document).on('mouseenter', '.trxNumLink', function () {
//                console.log('over: '+$(this).data("trxid"));
//            });
//            $(document).on("mouseleave", ".trxNumLink", function() {
//                console.log('out: '+$(this).data("trxid"));
//            });


        });

        $('#select_timeduration').change(function() {
            applyDurationFilter(parseInt($(this).val()));
//            if (parseInt($(this).val()) != 15 && parseInt($(this).val()) != 16)
//                regularCHKAccountTable.api().ajax.url(encodeURI(getUrl())).load();
        });

        function btnOpenCheckDetail(id) {
            var sURL = '@Url.Action("ViewTransactionDetail", "Company", new {area = "Portal"})?region=' +
                regionSelected +
                '&checkNum=' +
                id;
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function(data) {
                    if (parseInt(data.returnedData.length) >0) {
                        $('#vendorId').text(data.returnedData[0].Reference);
                        $('#vendorName').text(data.returnedData[0].Name);
                        $('#vendorAddressLine1').text(data.returnedData[0].Addr1);
                        $('#vendorAddressLine2').text(data.returnedData[0].Addr2);
                        $('#vendorAddressCityStateZip').text(data.returnedData[0].City +
                            ' ' +
                            data.returnedData[0].Region +
                            ' ' +
                            data.returnedData[0].PostalCode);

                        $('#checkNumber').html(data.returnedData[0].CheckNum);
                        $('#checkDate').html(formatJSONDateUtc(data.returnedData[0].CheckDate));
                        $('#checkAmount').html('$' + formatCurrency(data.returnedData[0].Deduction));

                        $("#modal_CheckDetail").modal({ backdrop: 'static' });

                        var tableRowOpen = '<tr>';
                        var tableRowClose = '</tr>';
                        var tableRowData = '';
                        var previousInvoiceNum = '';
                        $.each(data.returnedData,
                            function(index, rowData) {
                                tableRowData += '<td class="text-center">' +
                                    (previousInvoiceNum !== rowData.InvoiceNum ? rowData.InvoiceNum : '&nbsp;') +
                                    '</td>';
                                tableRowData += '<td class="text-center">' +
                                    (previousInvoiceNum !== rowData.InvoiceNum
                                        ? formatJSONDateUtc(rowData.InvoiceDate)
                                        : '&nbsp;') +
                                    '</td>';
                                tableRowData += '<td class="text-right">' +
                                    (previousInvoiceNum !== rowData.InvoiceNum
                                        ? '$' + formatCurrency(rowData.Deduction)
                                        : '&nbsp;') +
                                    '</td>';
                                tableRowData += '<td class="text-left">' + rowData.Desc + '</td>';
                                tableRowData += '<td class="text-center">' + rowData.AcctId + '</td>';
                                tableRowData += '<td class="text-right">' +
                                    '$' +
                                    formatCurrency(rowData.DebitAmt) +
                                    '</td>';
                                $('#tableBodyTrxDetails').append(tableRowOpen + tableRowData + tableRowClose);
                                tableRowData = '';
                                previousInvoiceNum = rowData.InvoiceNum;
                            });
                    } else {
                        swal({
                            title: "Information",
                            text: "Well, well, well...There is no check information found on Traverse.",
                            type: "info",
                            showCancelButton: false
                        });
                    }
                },
                error: function() {
                    alert("Content load failed.");
                }
            });
        }

        function formatJSONDateUtc(jsonDate) {
            if (jsonDate != null) {
                var dtstr = jsonDate.substr(6);
                var dateString = dtstr.substring(0, dtstr.length - 2);
                var currentTime = new Date(parseInt(dateString));
                var date = moment.utc(currentTime).format("MM/DD/YYYY");
                return date;
            }
            return null;
        }

        function SearchClick() {
            $("#modal_SearchModel").modal({ backdrop: 'static' });
        }

        function setPaging() {
            var z = $("#pageSize").val();
            var table = $("#RegularCHKAccountList").DataTable();
            if (z > 0) {
                table.page.len(z).draw();
            } else if (z === -1) {
                table.page.len(table.rows().count()).draw();
            } else {
                table.page.page.len(25).draw();
            }
        }

        var date = new Date(), y = date.getFullYear(), m = date.getMonth();
        var firstDay;
        var lastDay;
        Date.prototype.getWeek = function(start) {
            //Calcing the starting point
            start = start || 0;
            var today = new Date(this.setHours(0, 0, 0, 0));
            var day = today.getDay() - start;
            var date = today.getDate() - day;

            // Grabbing Start/End Dates
            var StartDate = new Date(today.setDate(date));
            var EndDate = new Date(today.setDate(date + 6));
            return [StartDate, EndDate];
        }

        $('#txtStartDate').change(function() {
            $('#spnStartDate').html($(this).val());
            if ($('#txtStartDate').val() !== '' && $('#txtEndDate').val() != '') {
            }
        });
        $('#txtEndDate').change(function() {
            $('#spnEndDate').html($(this).val());
            if ($('#txtStartDate').val() !== '' && $('#txtEndDate').val() != '') {
            }
        });

        function applyDurationFilter(v) {
            $('#spnEndDate').html('');
            $('#divSD').hide();
            $('#divED').hide();
            var firstDay, lastDay;
            var filterLabel = '';
            switch (v) {
            case 1:
                firstDay = moment().startOf('isoWeek').toString();
                lastDay = moment().endOf('isoWeek').toString();
                filterLabel = 'Week Period ' + firstDay + ' thru ' + lastDay;
                break;
            case 2:
                //code block
                firstDay = moment().startOf('isoWeek').toString();
                lastDay = new Date().toString();
                break;
            case 3:
                firstDay = moment().subtract(0, 'month').startOf('month').toString();
                lastDay = moment().subtract(0, 'month').endOf('month').toString();
                break;
            case 4:
                //code block
                firstDay = moment().subtract(0, 'month').startOf('month').toString();
                lastDay = new Date().toString();
                break;
            case 5:
                //code block
                firstDay = moment().startOf('quarter').toString();
                lastDay = moment().endOf('quarter').toString();
                break;
            case 6:
                //code block
                firstDay = moment().startOf('quarter').toString();
                lastDay = new Date().toString();
                break;
            case 7:
                //code block
                firstDay = moment().startOf('year').toString();;
                lastDay = moment().endOf('year').toString();
                break;
            case 8:
                //code block
                firstDay = moment().startOf('year').toString();
                lastDay = new Date().toString();
                break;
            case 9:
                //code block
                firstDay = moment().add(-1, 'days').toString();
                lastDay = moment().add(-1, 'days').toString();
                break;
            case 10:
                //code block
                firstDay = moment().subtract(1, 'week').startOf('week').toString();
                lastDay = moment().subtract(1, 'week').endOf('week').toString();
                break;
            case 11:
                //code block
                firstDay = moment().subtract(1, 'month').startOf('month').toString();
                lastDay = moment().subtract(1, 'month').endOf('month').toString();
                break;
            case 12:
                //code block
                firstDay = moment().subtract(1, 'quarter').startOf('quarter').toString();
                lastDay = moment().subtract(1, 'quarter').endOf('quarter').toString();
                break;
            case 13:
                //code block
                firstDay = moment().subtract(1, 'quarter').startOf('quarter').toString();
                lastDay = moment().subtract(1, 'quarter').endOf('quarter').toString();
                break;
            case 14:
                //code block
                firstDay = moment().subtract(1, 'year').startOf('year').toString();
                lastDay = moment().subtract(1, 'year').endOf('year').toString();
                break;
            case 15:
                $('#divSD').show();
                $('#divED').show();
                $('#divMonth').hide();
                $('#divYear').hide();
                $("#txtStartDate").focus();
                break;
            case 16:
                filterLabel = ' FOR THE ' + monthSelected + '/' + yearSelected + ' Period';
                $('#disSD').hide();
                $('#divED').hide();
                $('#divMonth').show();
                $('#divYear').show();
                $("#monthList").focus();
                $("#monthList").trigger('click');
                break;
            default:
            }
            $('#spnStartDate').html(filterLabel);
            $('#spnEndDate').html('');
//            $('#spnStartDate').html(moment(firstDay).format('L'));
//            $('#spnEndDate').html(moment(lastDay).format('L'));

//            if (v != 14) {
//                $('#spnStartDate').html(moment(firstDay).format('L'));
//                $('#spnEndDate').html(moment(lastDay).format('L'));
//            }
        }

        function formatCurrency(total) {
            if (total === null)
                return '';
            var neg = false;
            if (total < 0) {
                neg = true;
                total = Math.abs(total);
            }
            return (neg ? "-" : '') + parseFloat(total, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString();
        }

        $(".trxNumLink").hover(
            function() {
//                console.log('over: ' + $(this).data("trxid"));
            },
            function() {
//                console.log('out: ' + $(this).data("trxid"));
            }
        );


    </script>
}