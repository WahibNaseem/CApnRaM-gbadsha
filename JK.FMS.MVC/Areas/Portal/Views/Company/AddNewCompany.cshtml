@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section pageplugins{
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/jquery-ui/jquery-ui.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/jquery-validation/js/jquery.validate.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/jquery-inputmask/jquery.inputmask.bundle.min.js")" type="text/javascript"></script>
}

<div class="row">
    <div class="col-md-12">
        <div class="portlet box" style="background:#3598DC;">
            <div class="portlet-title">
                <div class="caption">
                    <span class="caption-subject sbold  uppercase">add new company/3rd party</span>
                </div>
            </div>

            <div class="portlet-body">

                <div class="form-body">

                    @*Main Information Section*@
                    <div class="row">
                        <div class="portlet box" style="background:#A3A9AD;">
                            <div class="portlet-title">
                                <div class="caption">
                                    <span class="caption-subject sbold uppercase">main information</span>
                                </div>
                            </div>
                            <div class="portlet-body">
                                <div class="form-body">
                                    <div class="row">
                                        <div class="form-horizontal">
                                            <div class="form-group">
                                                <label class="control-label col-md-3">Name <span class="required">*</span>:</label>
                                                <div class="col-md-8">
                                                    <input type="text" class="form-control input-sm" placeholder="Required" id="input_mainname" />
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="control-label col-md-3">Address <span class="required">*</span>:</label>
                                                <div class="col-md-8">
                                                    <input type="text" class="form-control input-sm" placeholder="Required" id="input_mainaddress" />
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="control-label col-md-3">City/State/Zip <span class="required">*</span>:</label>
                                                <div class="col-md-3">
                                                    <input type="text" class="form-control input-sm" placeholder="Required" id="input_maincity" />
                                                </div>
                                                <div class="col-md-3">
                                                    @*<input type="text" class="form-control input-sm" placeholder="Required" id="select_mainstate" />*@
                                                    @Html.DropDownList("StateList", (SelectList)ViewBag.State, "Select...", new { @class = "form-control input-sm", @id = "select_mainstate" })
                                                </div>
                                                <div class="col-md-2">
                                                    <input type="text" class="form-control input-sm" placeholder="Required" id="input_mainzip" />
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="control-label col-md-3">Phone <span class="required">*</span>:</label>
                                                <div class="col-md-6">
                                                    <input type="text" class="form-control input-sm" placeholder="Required" id="input_mainphone" />
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    @*Contact Information Section*@
                    <div class="row">
                        <div class="portlet box" style="background:#A3A9AD;">
                            <div class="portlet-title">
                                <div class="caption">
                                    <span class="caption-subject sbold uppercase">contact information</span>
                                </div>
                            </div>
                            <div class="portlet-body">
                                <form action="#" id="addnew_company3rdpartycontactinformation">
                                    <div class="form-body">
                                        <div class="row">
                                            <div class="form-horizontal">
                                                <div class="form-group">
                                                    <label class="control-label col-md-3">Name <span class="required">*</span>:</label>
                                                    <div class="col-md-8">
                                                        <input type="text" class="form-control input-sm" placeholder="Required" id="input_contactname" />
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="control-label col-md-3">Title <span class="required">*</span>:</label>
                                                    <div class="col-md-8">
                                                        <input type="text" class="form-control input-sm" placeholder="Required" id="input_contacttitle" />
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="control-label col-md-3">Phone <span class="required">*</span>:</label>
                                                    <div class="col-md-5">
                                                        <input type="text" class="form-control input-sm" placeholder="Required" id="input_contactphone" />
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="control-label col-md-3">Email <span class="required">*</span>:</label>
                                                    <div class="col-md-5">
                                                        <input type="text" class="form-control input-sm" placeholder="Required" id="input_contactemail" />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                </div>

            </div>

            <div class="portlet-body" style="background-color:#F5F5F5;">
                <div class="form-actions row">
                    <div class="col-md-12">
                        <div class="pull-right">
                            <button type="button" class="btn btn-primary  btn-block" id="saveCompany" onclick="ValidateCompany()">Submit</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



@section scripts {
    <script type="text/javascript">

        var ValidateCompany = function () {

            isValid = true;
            //Main Name
            if ($("#input_mainname").val().trim() == "") {
                $("#input_mainname").css('border-color', 'red');
                $(window).scrollTop(0);
                if (isValid) {
                    isValid = false;
                }
            }
            else { $("#input_mainname").css('border-color', ''); }

            //Main Address
            if ($("#input_mainaddress").val().trim() == "") {
                $("#input_mainaddress").css('border-color', 'red');
                $(window).scrollTop(0);
                if (isValid) {
                    isValid = false;
                }
            }
            else { $("#input_mainaddress").css('border-color', ''); }

            //Main City
            if ($("#input_maincity").val().trim() == "") {
                $("#input_maincity").css('border-color', 'red');
                $(window).scrollTop(0);
                if (isValid) {
                    isValid = false;
                }
            }
            else { $("#input_maincity").css('border-color', ''); }

            //Main State
            if ($("#select_mainstate").val().trim() == "") {
                $("#select_mainstate").css('border-color', 'red');
                $(window).scrollTop(0);
                if (isValid) {
                    isValid = false;
                }
            }
            else { $("#select_mainstate").css('border-color', ''); }

            //Main ZipCode
            if ($("#input_mainzip").val().trim() == "") {
                $("#input_mainzip").css('border-color', 'red');
                $(window).scrollTop(0);
                if (isValid) {
                    isValid = false;
                }
            }
            else { $("#input_mainzip").css('border-color', ''); }

            //Main Phone
            if ($("#input_mainphone").val().trim() == "") {
                $("#input_mainphone").css('border-color', 'red');
                $(window).scrollTop(0);
                if (isValid) {
                    isValid = false;
                }
            }
            else { $("#input_mainphone").css('border-color', ''); }


            //Contact Name
            if ($("#input_contactname").val().trim() == "") {
                $("#input_contactname").css('border-color', 'red');
                $(window).scrollTop(0);
                if (isValid) {
                    isValid = false;
                }
            }
            else { $("#input_contactname").css('border-color', ''); }


            //Contact Title
            if ($("#input_contacttitle").val().trim() == "") {
                $("#input_contacttitle").css('border-color', 'red');
                $(window).scrollTop(0);
                if (isValid) {
                    isValid = false;
                }
            }
            else { $("#input_contacttitle").css('border-color', ''); }


            //Contact Phone
            if ($("#input_contactphone").val().trim() == "") {
                $("#input_contactphone").css('border-color', 'red');
                $(window).scrollTop(0);
                if (isValid) {
                    isValid = false;
                }
            }
            else { $("#input_contactphone").css('border-color', ''); }


            //Contact Email
            if ($("#input_contactemail").val().trim() == "") {
                $("#input_contactemail").css('border-color', 'red');
                $(window).scrollTop(0);
                if (isValid) {
                    isValid = false;
                }
            }
            else {

                $("#input_contactemail").css('border-color', '');
            }


            if (isValid) {
                $.blockUI();
                saveCompany();
            }
        }

        var saveCompany = function () {

            var postData = {
                "MainName": $("#input_mainname").val(),
                "MainAddress": $("#input_mainaddress").val(),
                "MainCity": $("#input_maincity").val(),
                "MainState": $("#select_mainstate").val(),
                "MainZip": $("#input_mainzip").val(),
                "MainPhone": $("#input_mainphone").val(),
                "ContactName": $("#input_contactname").val(),
                "ContactTitle": $("#input_contacttitle").val(),
                "ContactPhone": $("#input_contactphone").val(),
                "ContactEmail": $("#input_contactemail").val()
            }

            $.ajax({
                url: "/Portal/Company/AddNewCompany",
                type: "POST",
                dataType: "json",
                data: postData,
                cache: false,
                success: function (response) {
                    if (response.success) {
                        $.unblockUI();
                         swal({
                                title:"OK",
                                text:"Company Saved Successfully",
                                allowOutsideClick:false,
                                html:true
                            },function(){
                                window.location.href='@Url.Action("CompanyList", "Company")';
                            });
                    }
                    else {
                        location.reload();
                    }
                    $.unblockUI();
                },
                error: function (error) {
                    console.log(error.message);
                    $.unblockUI();
                }
            });
        }




        $(document).ready(function () {
            setupform();
        });
        var setupform = function () {
            JK.CRM.CRMFormValidation.init("#addnew_company3rdpartycontactinformation");
            JK.CRM.CRMFormInputMask.handleNumericInputMask("#input_mainzip");
            JK.CRM.CRMFormInputMask.handlePhoneInputMask("#input_mainphone");
            JK.CRM.CRMFormInputMask.handlePhoneInputMask("#input_contactphone");
        }

    </script>

}

