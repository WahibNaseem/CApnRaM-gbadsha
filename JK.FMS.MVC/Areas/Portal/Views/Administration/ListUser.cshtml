@model JKViewModels.User.UserLoginListViewModel
@{
    ViewBag.Title = "ListUser";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="custom-form portlet light">
    @*<div class="headerbox">
            <div class="row">
                <div class="col-md-12 text-center">
                    User List
                </div>
            </div>
        </div>*@
    <div class="portlet-body form">
        <div class="form-body">
            <div class="form-group">
                <div class="row" style="background-color: #4b85cc;color: #fff;padding-top:8px;padding-bottom:8px">
                    <div class="col-md-12">
                        <div class="row" style="margin-top: -7px;">
                            <div class="col-md-7">
                                <div class="form-group">
                                    <div class="col-md-8">
                                        <div class="input-icon">
                                            <i class="icon-magnifier icon-align-right" style="margin-top: 8px;"></i>
                                            <input type="text" placeholder="Search..." class="form-control input-sm search-field col-md-4" id="input_Search" />
                                        </div>
                                    </div>
                                </div><div class="form-group">
                                    <div class="col-md-4">
                                        @Html.DropDownListFor(model => model.RegionId, (SelectList)ViewBag.Region, "--All--", new { @class = "form-control input-sm", required = "required", @id = "RegionListModel" })
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-5">
                                <div class="form-group">
                                    <div class="col-md-4 pnd5">
                                    </div>
                                    <div class="col-md-3" style="margin-bottom: -15px;padding-top: 5px;">
                                        <label class="mt-checkbox">
                                            <input type="checkbox" class="form-control input-sm" id="Inactive" />Inactive
                                            <span></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="table-responsive">
                            <table class="table table-striped table-bordered table-hover order-column" id="UserList">
                                <thead>
                                    <tr>
                                        <th style="width:110px;text-align:center;">
                                            User ID
                                        </th>
                                        <th style="width:150px;text-align:center;">
                                            Employee Name
                                        </th>
                                        @*<th style="text-align:center;width:80px;">
                                                Department
                                            </th>*@
                                        <th style="text-align:center;width:50px;">
                                            Group
                                        </th>
                                        <th style="text-align:center;width:60px;">
                                            Role
                                        </th>
                                        <th style="width:50px;text-align:center;">
                                            Region
                                        </th>
                                        <th style="width:50px;text-align:center;">
                                            OutlookUsername
                                        </th>
                                        <th style="text-align:center;width:70px;">
                                            User Status
                                        </th>
                                        <th style="text-align:center;width:70px;">
                                            Status Date
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @if (Model != null && Model.userList != null && Model.userList.Count > 0)
                                    {
                                        for (int i = 0; i < Model.userList.Count; i++)
                                        {
                                            <tr>
                                                <td style="text-align:center;width:50px;">
                                                    <a href="@Url.Action("AddUser", "Administration", new { UserId = Model.userList[i].UserId , area = "Portal" })">@Model.userList[i].UserName</a>
                                                </td>
                                                <td style="text-align:center;width:50px;">
                                                    @Model.userList[i].FirstName
                                                </td>

                                                @*<td style="text-align:center;width:80px;">
                                                        @Model.userList[i].DeparmentName
                                                    </td>*@
                                                <td style="text-align:center;width:80px;">
                                                    @Model.userList[i].GroupName
                                                </td>
                                                <td style="text-align:center;width:80px;">
                                                    @Model.userList[i].RoleName
                                                </td>
                                                <td style="width:50px;text-align:center;">
                                                    @Model.userList[i].RegionName
                                                </td>
                                                <td style="width:50px;text-align:center;">
                                                    @Model.userList[i].OutlookUsername
                                                </td>
                                                <td style="text-align:center;width:80px;">
                                                    @if (Model.userList[i].IsEnable)
                                                    {
                                                        <span>Active</span>
                                                    }
                                                    else
                                                    {
                                                        <span>DeActive</span>
                                                    }
                                                </td>
                                                <td style="text-align:center;width:80px;">
                                                    @(Model.userList[i].CreatedOn != null ? ((DateTime)Model.userList[i].CreatedOn).ToShortDateString() : "")
                                                </td>
                                            </tr>
                                        }

                                    }
                                    else
                                    {
                                        <tr>
                                            <td colspan="8">
                                                No record found.
                                            </td>
                                        </tr>
                                    }

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
@section pageplugins{
    @if (Request.IsSecureConnection)
    {
        <script src="https://code.jquery.com/ui/1.11.4/jquery-ui.js" type="text/javascript"></script>
    }
    else
    {
        <script src="http://code.jquery.com/ui/1.11.4/jquery-ui.js" type="text/javascript"></script>
    }
    <!-- BEGIN PAGE LEVEL PLUGINS -->
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/select2/js/select2.full.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/jquery-validation/js/jquery.validate.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/jquery-validation/js/additional-methods.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/bootstrap-wizard/jquery.bootstrap.wizard.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/jquery-inputmask/jquery.inputmask.bundle.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/scripts/datatable.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/datatables/datatables.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/scripts/app.min.js")" type="text/javascript" )"></script>
    <script src="@Url.Content("~/Content/admin/assets/pages/scripts/table-datatables-managed.min.js")" type="text/javascript"></script>
}
@section scripts{
    <script>
        jQuery(document).ready(function () {

            var table = $('#UserList');
            table.DataTable({
                "pageLength": 10, // default records per page
                "dom": "<'table-responsive't><'bottom'ip><'clear'>",
                "bInfo": false,
                "bStateSave": false,
                "fnStateSaveParams": function (oSettings, sValue) {
                    $("#UserList tr.filter .form-control").each(function () {
                        sValue[$(this).attr('name')] = $(this).val();
                    });

                    return sValue;
                },

            });

            $("#input_Search").keyup(function () {
                var table = $("#UserList").DataTable();
                table.search($(this).val()).draw();
            });

            $("#RegionListModel").change(function () {
                var RegionId = $("#RegionListModel").val();
                var IsActive = $('.form-control input-sm:checked').val();
                ActionCall(RegionId, IsActive)
            });
            $("#Inactive").change(function () {
                var RegionId = $("#RegionListModel").val();
                var IsActive = $('.form-control input-sm:checked').val();
                ActionCall(RegionId, IsActive)
            });

            function ActionCall(RegionId, IsActive)
            {
                if (RegionId > 0 && IsActive==true)
                    window.location.href = "/Portal/Administration/ListUser?RegionId=" + RegionId + "&IsActive=1";
                else if (RegionId > 0 && IsActive != true)
                    window.location.href = "/Portal/Administration/ListUser?RegionId=" + RegionId;
                else
                    window.location.href = "/Portal/Administration/ListUser";
            }
        });
    </script>
}