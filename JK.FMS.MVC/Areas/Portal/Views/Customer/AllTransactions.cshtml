
@{
    ViewBag.Title = "AllTransactions";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@section styles{
    <link href="@Url.Content("~/Content/admin/assets/global/plugins/datatables/datatables.min.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/admin/assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/admin/assets/global/plugins/bootstrap-multiselect/css/bootstrap-multiselect.css")" rel="stylesheet" />
    <style type="text/css">
        tr > td {
            font-size: 12px !important;
            padding: 4px !important;
        }

        /*tr > th {
            font-size: 11px !important;
            text-transform: uppercase;
        }*/

        .row {
            margin: 0;
            padding: 3px 0;
        }

        .opendiv {
            padding: 4px;
            background-color: gold;
            text-align: center;
            font-weight: bold;
            color: #ffffff;
            display: table-cell;
            min-width: 105px;
        }

        .closeddiv {
            padding: 4px;
            background-color: limegreen;
            text-align: center;
            font-weight: bold;
            color: #ffffff;
            display: table-cell;
            min-width: 90px;
        }

        .overpaiddiv {
            padding: 4px;
            background-color: deepskyblue;
            text-align: center;
            font-weight: bold;
            color: #ffffff;
            display: table-cell;
            min-width: 100px;
        }

        .overduediv {
            padding: 4px;
            background-color: orangered;
            text-align: center;
            font-weight: bold;
            color: #ffffff;
            display: table-cell;
            min-width: 96px;
        }

        .btn {
            padding: 3px 12px;
            font-size: 12px;
        }

        .alignRight {
            text-align: right;
        }

        .alignCenter {
            text-align: center;
        }

        .close {
            background-image: url(/Content/admin/assets/global/img/stick_close.png) !important;
            height: 12px !important;
            width: 12px !important;
            margin-top: 0px !important;
        }

        .page-size {
            padding-left: 0;
            padding-right: 0;
            width: 62px;
        }

        .topheader {
            font-size: 14px;
            font-weight: bold;
            color: #FFF !important;
            text-transform: uppercase;
            margin-top: 3px;
        }

        #invoiceList th {
            vertical-align: middle;
        }

        .no-padding {
            padding: 0;
        }

        .no-margin {
            margin: 0;
        }

        .padding-tb1 {
            padding-top: 1px;
            padding-bottom: 1px;
        }

        .margin-tb1 {
            margin-top: 1px;
            margin-bottom: 1px;
        }

        .custom-listbox .headerbox {
            padding: 3px 0px 3px 5px;
        }

        .custom-listbox {
            margin-top: 4px;
            margin-bottom: 0px;
        }

        #divfranchiseList .headerbox {
            text-transform: none;
            font-weight: normal;
        }

        .btn.multiselect {
            text-align: left;
            padding-top: 4px;
            padding-bottom: 4px;
            font-size: 11px;
            color: #555;
        }

        .multiselect .caret {
            right: 0;
            position: absolute;
            margin-top: 8px;
            margin-right: 8px;
        }

        .multiselect-container.dropdown-menu {
            text-transform: none;
            font-size: 14px;
        }

        #modal_RegionModel .modal-content {
            width: 55% !important;
            margin-left: 30% !important;
        }
    </style>
}


<div class="headerbox">
    <div class="row" style="background-color: #3598DC;color: #fff;">
        <div class="col-md-12 no-padding">
            <div class="alignCenter">
                <div class="col-md-4" style="text-align:right;">
                    <div class="col-md-9">
                        <div class="input-icon">
                            <i class="icon-magnifier icon-align-right" style="margin-top: 8px;"></i>
                            <input id="csearch-box" type="text" required name="customernumber" autocomplete="off" placeholder="Search By Customer Or Number" value="" class="form-control input-sm typeahead" />
                        </div>
                    </div>
                </div>
                <div class="col-md-4 topheader">
                    Customer All Transactions
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row form form-horizontal" style="background: white; border:1px solid gray;">
    <div class="col-md-12" style="padding-top:4px;padding-bottom: 4px;">
        <div class="col-md-2"></div>
        <div class="col-md-8" style="border:1px solid gray;">
            <div class="col-md-12" style="padding:4px;">

                <div class="col-md-2 control-label collapse" style="padding-top: 0px;">
                    <b id="CustomerId"></b>
                </div>
                <div class="col-md-2 control-label" style="padding-top: 0px;">
                    <b>Customer No.:</b>
                </div>
                <div class="col-md-3">
                    <strong><span id="CustomerNo"></span></strong>
                </div>
                <div class="col-md-offset-1 col-md-2 control-label" style="padding-top: 0px;">
                    <b>Address:</b>
                </div>
                <div class="col-md-4">
                    <strong><span id="CustomerAddress"></span></strong>
                </div>
            </div>
            <div class="col-md-12" style="padding:4px;">
                <div class="col-md-2 control-label" style="padding-top: 0px;">
                    <b>Customer Name:</b>
                </div>
                <div class="col-md-3">
                    <strong><span id="CustomerName"></span></strong>
                </div>
                <div class="col-md-offset-3 col-md-4">
                    <strong><span id="CustomerState"></span></strong>
                </div>
            </div>
        </div>
        <div class="col-md-2 datatableClass " style="padding-top: 10px;">
            <input type="button" class="btn btn-primary btn-sm pull-right" onclick="showStatements()" value="Customer Statement" />
        </div>
    </div>
</div>


<div class="custom-listbox datatableClass" id="divfranchiseList" style="margin-top:4px;margin-bottom:3px;">
    <div class="headerbox">
        <div class="row no-padding">
            <div class="col-sm-1 page-size collapse">
                <select class="form-control input-sm" id="pageSize" style="padding-left:6px;">
                    <option value="-1">All</option>
                    <option value="100" selected>100</option>
                    <option value="50">50</option>
                    <option value="25">25</option>
                </select>
            </div>
            <div class="col-md-3">
                <select class="form-control input-sm" id="CustomerTransactionType" name="CustomerTransactionType">
                    <option value="">All Transactions</option>
                    @foreach (var item in ViewBag.CustomerTransactionType)
                    {
                        <option value="@item.Value">@item.Text</option>
                    }
                </select>
            </div>
            <div class="col-md-5 pull-right no-padding">
                <div class="col-md-10 pull-right no-padding" style="text-align:center;">
                    <div class="col-md-6 no-padding" style="margin-left:30px;">
                        <select id="select_timeduration" class="form-control input-sm">
                            <option value="1">This Week</option>
                            <option value="2">This Week-to-date</option>
                            <option value="3" selected="selected">This Month</option>
                            <option value="4">This Month-to-date</option>
                            <option value="5" >This Quarter</option>
                            <option value="6">This Quarter-to-date</option>
                            <option value="7">This Fiscal Year</option>
                            <option value="8">This Fiscal Year-to-date</option>
                            <option value="9">Today</option>
                            <option value="10">Yesterday</option>
                            <option value="11">Last Week</option>
                            <option value="12">Last Month</option>
                            <option value="13">Last Quarter</option>
                            <option value="14">Last Year</option>
                            <option value="15">Custom Date</option>
                            <option value="16">Period</option>
                        </select>
                    </div>
                    <div class="col-md-5 divspandate no-padding" style="margin-top: 3px; margin-left: 0px; display: block; float: right;">
                        <span id="spnStartDate"></span> - <span id="spnEndtDate"></span>
                    </div>
                    <div class="col-md-3 no-padding" style="margin-left: 3px; width: 70px; display: none;" id="divSD">
                        <input type="text" name="txtStartDate" id="txtStartDate" value="" class="form-control input-sm date-picker RemovePeriodvalidation" style="padding: 3px;" />
                    </div>
                    <div class="col-md-3 no-padding" style="margin-left: 3px; width: 70px; display: none;" id="divED">
                        <input type="text" name="txtEndtDate" id="txtEndtDate" value="" class="form-control input-sm date-picker RemovePeriodvalidation" style="padding: 3px;" />
                    </div>
                    <div class="col-md-3 no-padding" style="margin-left: 3px; width: 70px; display: none;" id="divmonth">
                        <select id="monthlist" class="form-control input-sm">
                            <option value=""></option>
                            <option value="1">Jan</option>
                            <option value="2">Feb</option>
                            <option value="3">Mar</option>
                            <option value="4">Apr</option>
                            <option value="5">May</option>
                            <option value="6">June</option>
                            <option value="7">July</option>
                            <option value="8">Aug</option>
                            <option value="9">Sep</option>
                            <option value="10">Oct</option>
                            <option value="11">Nov</option>
                            <option value="12">Dec</option>
                        </select>
                    </div>
                    <div class="col-md-3 no-padding" style="margin-left: 3px; width: 70px; display: none;" id="divyear">
                        <select class="form-control input-sm" id="yearlist" style="padding-left: 2px;">
                            <option value=""></option>
                            <option value="2018">2018</option>
                            <option value="2017">2017</option>
                            <option value="2016">2016</option>
                            <option value="2015">2015</option>
                            <option value="2014">2014</option>
                            <option value="2013">2013</option>
                            <option value="2012">2012</option>
                            <option value="2011">2011</option>
                            <option value="2010">2010</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="tablebox datatableClass">
    <div class="row padding-tb1">
        <div class="row no-padding">
            <div class="table-responsive">
                <table class="table table-striped table-bordered table-hover order-column" id="tblAllTra" style="margin-top:0 !important;">
                    <thead>
                        <tr>
                            <th colspan="7" style="border-right: 2px solid blue;"></th>
                            <th colspan="2" style="text-align:center;border-right: 2px solid blue;border-top: 2px solid blue;">Total Transaction Amount</th>
                            <th></th>
                            <th></th>
                        </tr>
                        <tr>
                            <th colspan="2" style="width:100px;text-align:center;">
                                Transaction Type
                            </th>
                            <th style="width:80px;text-align:center;">
                                Date
                            </th>
                            <th style="text-align:center;width:115px;">
                                Number
                            </th>
                            <th style="width:400px;text-align:center;">
                                Description
                            </th>
                            <th style="text-align:center;width:95px;">
                                Amount
                            </th>
                            <th style="text-align:center;width:95px;border-right: 2px solid blue;">
                                Tax
                            </th>
                            <th style="text-align:center;width:95px;">
                                Debit
                            </th>
                            <th style="text-align:center;width:95px;border-right: 2px solid blue;">
                                Credit
                            </th>
                            @*<th style="text-align:center;width:50px;">
                                Balance
                            </th>*@
                            <th style="text-align:center;width:85px;">
                                Status
                            </th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                    <tfoot>
                        <tr style="background:#95a5a6;color:white;">
                            <td colspan="4" style="text-align:center;"></td>
                            <td style="text-align:center;width:50px;"><strong>Total:</strong> </td>
                            <td style="text-align:center;width:50px;"><strong><span id="totalAmount" style="float: right"></span> </strong> </td>
                            <td style="text-align:center;width:50px; border-right: 2px solid blue; "><strong><span id="totalTax" style="float: right"></span> </strong> </td>
                            <td style="text-align:center;width:70px; border-left: 2px solid blue; border-bottom: 2px solid blue;"><strong><span id="totalDebit" style="float: right"></span> </strong> </td>
                            <td style="text-align:center;width:70px; border-right: 2px solid blue; border-bottom: 2px solid blue;"><strong><span id="totalCredit" style="float: right"></span> </strong> </td>
                            @*<td style="text-align:center;width:50px; border-left: 2px solid blue;"><strong><span id="totalBalance" style="float: right"></span> </strong> </td>*@
                            <td style="text-align:center;width:50px;"><strong><span></span> </strong> </td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="modal_showStatements" tabindex="-1" role="basic" aria-hidden="true" style="display: none; padding-right: 17px;">
    <div class="modal-dialog modal-lg ui-draggable ui-draggable-handle">
        <div class="modal-content" style="border-radius: 8px;">
            <div class="modal-header headerbox list" style="padding:0px!important;background:#3598DC !important;border-bottom-width:0px">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true" style="margin-top: 12px !important;margin-right: 12px !important;"></button>
                <h4 class="modal-title" style="padding:10px;font-size: 12px;font-weight: bold;background: #3598DC !important;color: #FFF !important;border-radius: 8px 8px 0 0;text-transform: uppercase;">
                    Statements
                </h4>
            </div>
            <div class="modal-body form form-horizontal">
                <div class="col-md-12" style="background-color:#67809F !important; color: #fff; padding: 5px">
                    <div class="col-md-1 col-md-offset-5 no-padding">
                        Date
                    </div>
                    <div class="col-md-3">
                        <select id="select_timedurationStatements" class="form-control input-sm">
                            <option value="1">This Week</option>
                            <option value="2">This Week-to-date</option>
                            <option value="3">This Month</option>
                            <option value="4">This Month-to-date</option>
                            <option value="5">This Quarter</option>
                            <option value="6">This Quarter-to-date</option>
                            <option value="7" selected="selected">This Fiscal Year</option>
                            <option value="8">This Fiscal Year-to-date</option>
                            <option value="9">Yesterday</option>
                            <option value="10">Last Week</option>
                            <option value="11">Last Month</option>
                            <option value="12">Last Quarter</option>
                            <option value="13">Last Year</option>
                            <option value="14">Custom Date</option>
                        </select>
                    </div>
                    <div class="col-md-2 no-padding" style="padding-top: 5px;padding-left: 0px;padding-right: 0px;" id="divspandateStatements">
                        <span id="spnStartDateStatements">08/01/2017</span> - <span id="spnEndtDateStatements">08/31/2017</span>
                    </div>
                    <div class="col-md-1 no-padding" style="padding-top: 7px;display:none;" id="divSDStatements">
                        <input type="text" name="txtStartDateStatements" value="" class="form-control input-sm date-picker" style="padding: 3px;" />
                    </div>
                    <div class="col-md-1 no-padding" style="padding-top: 7px;display:none;" id="divED">
                        <input type="text" name="txtEndtDateStatements" value="" class="form-control input-sm date-picker" style="padding: 3px;" />
                    </div>
                </div>
                <div class="form-body" style="padding-top: 0px;">
                    <div class="form-group">
                        <div class="row">
                            <div class="col-md-8" style="padding-top: 12px;">
                                <div class="form-group">
                                    <div class="col-md-12">
                                        <div class="col-md-3 control-label">
                                            <span>Customer No.<span style="color:#000000;">&nbsp;:</span></span>
                                        </div>
                                        <div class="col-md-4" style="padding-top: 8px;">
                                            <strong><span id="staCustomerNo"></span></strong>
                                        </div>
                                        <div class="col-md-2 control-label">
                                            <span>Contact<span style="color:#000000;">&nbsp;:</span></span>
                                        </div>
                                        <div class="col-md-3" style="padding-top: 8px;">
                                            <strong><span id="staContactName"></span></strong>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="col-md-12">
                                        <div class="col-md-3 control-label" style="padding-top: 0px;">
                                            <span>Customer Name<span style="color:#000000;">&nbsp;:</span></span>
                                        </div>
                                        <div class="col-md-4" style="">
                                            <strong><span id="staCustomerName"></span></strong>
                                        </div>
                                        <div class="col-md-2 control-label" style="padding-top: 0px;padding-left: 0px;">
                                            <span>Phone No.<span style="color:#000000;">&nbsp;:</span></span>
                                        </div>
                                        <div class="col-md-3">
                                            <strong><span id="staPhone"></span></strong>

                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4" style="padding-top: 5px;">
                                <div class="table-responsive">
                                    <table class="table table-bordered">
                                        <tr>
                                            <td class="text-center">Previous Balance</td>
                                            <td class="text-right"><span id="spnStatements_PreviousBalance">&nbsp;</span></td>
                                        </tr>
                                        <tr>
                                            <td class="text-center">Credit/Payment</td>
                                            <td class="text-right"><span id="spnStatements_Credits">&nbsp;</span></td>
                                        </tr>
                                        <tr>
                                            <td class="text-center">New Invoices</td>
                                            <td class="text-right"><span id="spnStatements_Debits">&nbsp;</span></td>
                                        </tr>
                                        <tr>
                                            <td class="text-center"><b>Total Balance Due</b></td>
                                            <td class="text-right"><b><span id="spnStatements_NewBalance">&nbsp;</span></b></td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="row" style="margin-top:5px">
                            <div class="col-md-12">
                                <div class="table-responsive">
                                    <table class="table table-striped table-bordered table-hover" id="tbl_statementTransactions">
                                        <thead>
                                            <tr>
                                                <th style="width:70px;text-align:center;background-color: #4b85cc;color:white">
                                                    Trx Type
                                                </th>
                                                <th style="text-align:center;width:30px;background-color: #4b85cc;color:white">
                                                    Trx Date
                                                </th>
                                                <th style="text-align:center;width:60px;background-color: #4b85cc;color:white">
                                                    Trx Number
                                                </th>
                                                <th style="text-align:center;width:200px;background-color: #4b85cc;color:white">
                                                    Description
                                                </th>
                                                <th style="text-align:center;width:70px;background-color: #4b85cc;color:white">
                                                    Charges
                                                </th>
                                                <th style="text-align:center;width:60px;background-color: #4b85cc;color:white">
                                                    Credits
                                                </th>
                                                <th style="text-align:center;width:60px;background-color: #4b85cc;color:white">
                                                    Balance
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <hr />
                        <div class="form-group">
                            <div class="col-md-12">
                                <div class="col-md-2 control-label" style="padding-top: 0px;">
                                    <button type="button" class="col-md-12 btn btn-primary" id="btnPrintStatement">Print<i class="fa fa-print" style="padding-left: 7px;"></i></button>
                                </div>
                                <div class="col-md-2 control-label" style="padding-top: 0px;">
                                    <button type="button" class="col-md-12 btn btn-primary" id="btnExportStatement">Export<i class="fa fa-download" style="padding-left: 7px;"></i></button>
                                </div>
                                <div class="col-md-2 control-label" style="padding-top: 0px;">
                                    <button type="button" class="col-md-12 btn btn-primary" id="btnEmailStatement">Email<i class="fa fa-envelope" style="padding-left: 7px;"></i></button>
                                </div>
                                <div class="col-md-2 col-md-offset-4 control-label" style="padding-top: 0px;">
                                    <button type="button" class="col-md-12 btn btn-primary" id="btnCloseStatements">Close<i class="fa fa-close" style="padding-left: 7px;"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


@* PartialView Invoice Detail *@
<div class="form-horizontal" id="form_invoicedetail"></div>

<div class="form-horizontal" id="form_paymentlist"></div>

@* PartialView CustomerCredit *@
<div class="form-horizontal" id="form_CusCreditDetails"></div>

@section pageplugins{
    @*<script src="@Url.Content("~/Content/admin/assets/global/plugins/jquery-ui/jquery-ui.min.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Content/admin/assets/global/plugins/jquery-validation/js/jquery.validate.min.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Content/admin/assets/global/plugins/jquery-inputmask/jquery.inputmask.bundle.min.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Content/admin/assets/global/scripts/datatable.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Content/admin/assets/global/plugins/datatables/datatables.min.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Content/admin/assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Content/admin/assets/global/scripts/app.min.js")" type="text/javascript" )"></script>
        <script src="@Url.Content("~/Content/admin/assets/pages/scripts/table-datatables-managed.min.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Content/admin/assets/global/plugins/bootstrap-multiselect/js/bootstrap-multiselect.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Content/admin/assets/global/plugins/bootstrap-typeahead/bootstrap3-typeahead.min.js")" type="text/javascript"></script>*@


    <script src="@Url.Content("~/Content/admin/assets/global/plugins/jquery-validation/js/jquery.validate.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/jquery-inputmask/jquery.inputmask.bundle.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/scripts/datatable.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/datatables/datatables.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/pages/scripts/table-datatables-managed.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/moment.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Content/admin/assets/global/plugins/bootstrap-typeahead/bootstrap3-typeahead.min.js")" type="text/javascript"></script>
    <script src="~/Scripts/jquery-ui.js" type="text/javascript"></script>
    <script src="~/Content/admin/assets/Card/dist/jquery.card.js"></script>
}
@section scripts{
    <script src="@Url.Content("~/Content/admin/assets/pages/scripts/components-date-time-pickers.min.js")" type="text/javascript"></script>

    <script type="text/javascript">
        function getCurrentUrl() {
            var customerId = $('#CustomerId').text();
            var masterTrxTypeId = $("#CustomerTransactionType").val();
            var spnStartDate = $("#spnStartDate").text();
            var spnEndDate = $("#spnEndtDate").text();
            return '@Url.Action("GetAllCustomerTransactions", "Customer", new { area = "Portal" })?CustomerId=' + customerId + '&TypeId=' + masterTrxTypeId + '&StartDate=' + spnStartDate + '&EndDate=' + spnEndDate;

        }

        $(document).ready(function () {
            applyAutoSeacrh();
            $('.datatableClass').hide();
            //$('#txtStartDate').inputmask("mm/dd/yyyy", {});
            //$('#txtEndtDate').inputmask("mm/dd/yyyy", {});

            $('#txtStartDate').change(function () {
                $('#spnStartDate').html($(this).val());
                if ($('#txtStartDate').val() != '' && $('#txtEndtDate').val() != '')
                    _bindTransactions()
            });
            $('#txtEndtDate').change(function () {
                $('#spnEndtDate').html($(this).val());
                if ($('#txtStartDate').val() != '' && $('#txtEndtDate').val() != '')
                    _bindTransactions()
            });

            $('#monthlist').change(function () {
                $('#spnStartDate').html('');
                if ($('#monthlist').val() != '' && $('#yearlist').val() != '')
                    _bindTransactions()
            });

            $('#yearlist').change(function () {
                $('#spnEndtDate').html('');
                if ($('#monthlist').val() != '' && $('#yearlist').val() != '')
                    _bindTransactions()
            });

            applyDurationFilter(3);
            $('#select_timeduration').change(function () {
                applyDurationFilter(parseInt($(this).val()));
            });
            //$(document).on('init.dt', function (e, settings) {
            //    var api = new $.fn.dataTable.Api(settings);
            //    if ($(api.table().node()).attr('id') == 'tblAllTra') {
            //        setPaging();
            //    }
            //});

            $('#btnCloseStatements').click(function () {
                $('#modal_showStatements').modal('hide');
            })

            $('#btnPrintStatement').click(function () {
                var customerId = $('#CustomerId').text();
                printCustomerStatement('@Url.Action("CustomerStatementPrint", "Customer", new { area = "Portal" })?customerId=' + customerId + '&start=' + $('#spnStartDate').text() + '&end=' + $('#spnEndtDate').text());
            });

            $('#btnExportStatement').click(function () {
                var customerId = $('#CustomerId').text();
                window.location.href = '@Url.Action("CustomerStatementExportToPDF", "Customer", new { area = "Portal" })?customerId=' + customerId + '&start=' + $('#spnStartDate').text() + '&end=' + $('#spnEndtDate').text();
            });

            $("#pageSize").change(function () {
                setPaging();
            });
            $('#CustomerTransactionType').change(function () {
                _bindTransactions();
            });
            @*$("#csearch-box").autocomplete({
                source: function (request, response) {
                    $.ajax({
                        url: '@Url.Action("GetRegionWiseCustomer", "Customer", new { area = "Portal" })',
                        data: {
                            customerName: $('#csearch-box').val()
                        },
                        type: "GET",
                        datatype: "json",
                        success: function (data) {
                            response($.map(data, function (val, item) {
                                return {
                                    label: val.CustomerName + " (" + val.CustomerNo + ")",
                                    value: val.CustomerId,
                                    CustomerId: val.CustomerId
                                }
                            }))
                        }
                    })
                },
                select: function (event, ui) {
                    $("#CustomerId").val(ui.item.CustomerId);
                    getCustomerDetails(ui.item.CustomerId);
                }
            });*@
            $('#spnStartDateStatements').html(moment(firstDay).format('L'));
            $('#spnEndtDateStatements').html(moment(lastDay).format('L'));
            settimedurationStatements_select(7);
            $('#txtStartDateStatements').inputmask("mm/dd/yyyy", {});
            $('#txtEndtDateStatements').inputmask("mm/dd/yyyy", {});

            $("#txtFromStatements").val(moment(firstDay).format('L'));
            $("#txtToStatements").val(moment(lastDay).format('L'));
            $("#txtFromStatements").prop("disabled", true);
            $("#txtToStatements").prop("disabled", true);

            $('#select_timedurationStatements').change(function () {
                $('#spnStartDateStatements').html('');
                $('#spnEndtDateStatements').html('');
                $('#divspandateStatements').show();
                $('#divSDStatements').hide();
                $('#divEDStatements').hide();
                switch (parseInt($(this).val())) {
                    case 1:
                        firstDay = moment().startOf('isoWeek').toString();
                        lastDay = moment().endOf('isoWeek').toString();
                        break;
                    case 2:
                        //code block
                        firstDay = moment().startOf('isoWeek').toString();
                        lastDay = new Date().toString();
                        break;
                    case 3:
                        firstDay = moment().subtract(0, 'month').startOf('month').toString();
                        lastDay = moment().subtract(0, 'month').endOf('month').toString();
                        break;
                    case 4:
                        //code block
                        firstDay = moment().subtract(0, 'month').startOf('month').toString();
                        lastDay = new Date().toString();
                        break;
                    case 5:
                        //code block
                        firstDay = moment().startOf('quarter').toString();
                        lastDay = moment().endOf('quarter').toString();
                        break;
                    case 6:
                        //code block
                        firstDay = moment().startOf('quarter').toString();
                        lastDay = new Date().toString();
                        break;
                    case 7:
                        //code block
                        firstDay = moment().startOf('year').toString();;
                        lastDay = moment().endOf('year').toString();
                        break;
                    case 8:
                        //code block
                        firstDay = moment().startOf('year').toString();
                        lastDay = new Date().toString();
                        break;
                    case 9:
                        //code block
                        firstDay = moment().add(-1, 'days').toString();
                        lastDay = moment().add(-1, 'days').toString();
                        break;
                    case 10:
                        //code block
                        firstDay = moment().subtract(1, 'week').startOf('week').toString();
                        lastDay = moment().subtract(1, 'week').endOf('week').toString();
                        break;
                    case 11:
                        //code block
                        firstDay = moment().subtract(1, 'month').startOf('month').toString();
                        lastDay = moment().subtract(1, 'month').endOf('month').toString();
                        break;
                    case 12:
                        //code block
                        firstDay = moment().subtract(1, 'quarter').startOf('quarter').toString();
                        lastDay = moment().subtract(1, 'quarter').endOf('quarter').toString();
                        break;
                    case 13:
                        //code block
                        firstDay = moment().subtract(1, 'year').startOf('year').toString();
                        lastDay = moment().subtract(1, 'year').endOf('year').toString();
                        break;
                    case 14:
                        //code block
                        $('#divspandateStatements').hide();
                        $('#divSDStatements').show();
                        $('#divEDStatements').show();
                        break;
                    default:
                        //code block
                }
                $('#spnStartDateStatements').html(moment(firstDay).format('L'));
                $('#spnEndtDateStatements').html(moment(lastDay).format('L'));

                _bindTransactionsForStatment($('#tbl_statementTransactions tbody'), 0, $('#spnStartDateStatements').text(), $('#spnEndtDateStatements').text(), true);
            });

        });

        function applyAutoSeacrh() {

                $.ajax({
                    type: "GET",
                    url: '@Url.Action("GetAllCustomer", "Customer", new { area = "Portal" })',
                    data: {},
                    success: function (data) {

                        var typeaheadSource = [];
                        $.each(data, function (key, value) {
                            typeaheadSource.push({ id: value.CustomerId, name: value.CustomerNo + ' ' + $.trim(value.Name) })
                        });
                        var box = $('#csearch-box').data('typeahead');
                        if (box != null) {

                            console.log('csearch source change');
                            box.source = typeaheadSource;
                        }
                        else {
                            console.log('csearch initiated');
                            $('#csearch-box').typeahead({
                                source: typeaheadSource,
                                updater: function (item) {
                                    console.log(item);
                                    getCustomerDetails(item.id);
                                    //redirect(item.id);
                                    return item;
                                },
                                minLength: 1
                            }).focus();
                        }
                    }
                });
            }
        function printCustomerStatement(data) {

            var afterPrint = function () {

            }

            var sURL = data;
            $('#iframe_statement').attr('src', document.location.origin + sURL);
            $('#iframe_statement').load(function () {

                // for ie and firefox
                window.onafterprint = afterPrint();

                // for chrome
                if (window.matchMedia) {
                    var mediaQueryList = window.matchMedia('print');
                    mediaQueryList.addListener(function (mql) {
                        if (mql.matches) {
                        } else {
                            afterPrint();
                        }
                    });
                }

                frames['iframe_statement'].print();
            });

        }
        function settimedurationStatements_select(id) {
            $('#select_timedurationStatements').val(id)
            $('#spnStartDateStatements').html('');
            $('#spnEndtDateStatements').html('');
            $('#divspandateStatements').show();
            $('#divSDStatements').hide();
            $('#divEDStatements').hide();
            switch (parseInt(id)) {
                case 1:
                    firstDay = moment().startOf('isoWeek').toString();
                    lastDay = moment().endOf('isoWeek').toString();
                    break;
                case 2:
                    //code block
                    firstDay = moment().startOf('isoWeek').toString();
                    lastDay = new Date().toString();
                    break;
                case 3:
                    firstDay = moment().subtract(0, 'month').startOf('month').toString();
                    lastDay = moment().subtract(0, 'month').endOf('month').toString();
                    break;
                case 4:
                    //code block
                    firstDay = moment().subtract(0, 'month').startOf('month').toString();
                    lastDay = new Date().toString();
                    break;
                case 5:
                    //code block
                    firstDay = moment().startOf('quarter').toString();
                    lastDay = moment().endOf('quarter').toString();
                    break;
                case 6:
                    //code block
                    firstDay = moment().startOf('quarter').toString();
                    lastDay = new Date().toString();
                    break;
                case 7:
                    //code block
                    firstDay = moment().startOf('year').toString();;
                    lastDay = moment().endOf('year').toString();
                    break;
                case 8:
                    //code block
                    firstDay = moment().startOf('year').toString();
                    lastDay = new Date().toString();
                    break;
                case 9:
                    //code block
                    firstDay = moment().add(-1, 'days').toString();
                    lastDay = moment().add(-1, 'days').toString();
                    break;
                case 10:
                    //code block
                    firstDay = moment().subtract(1, 'week').startOf('week').toString();
                    lastDay = moment().subtract(1, 'week').endOf('week').toString();
                    break;
                case 11:
                    //code block
                    firstDay = moment().subtract(1, 'month').startOf('month').toString();
                    lastDay = moment().subtract(1, 'month').endOf('month').toString();
                    break;
                case 12:
                    //code block
                    firstDay = moment().subtract(1, 'quarter').startOf('quarter').toString();
                    lastDay = moment().subtract(1, 'quarter').endOf('quarter').toString();
                    break;
                case 13:
                    //code block
                    firstDay = moment().subtract(1, 'year').startOf('year').toString();
                    lastDay = moment().subtract(1, 'year').endOf('year').toString();
                    break;
                case 14:
                    //code block
                    $('#divspandateStatements').hide();
                    $('#divSDStatements').show();
                    $('#divEDStatements').show();
                    break;
                default:
                    //code block
            }
            $('#spnStartDateStatements').html(moment(firstDay).format('L'));
            $('#spnEndtDateStatements').html(moment(lastDay).format('L'));
        }

        function showStatements() {
            _bindTransactionsForStatment($('#tbl_statementTransactions tbody'), 0, $('#spnStartDateStatements').text(), $('#spnEndtDateStatements').text(), true);

            $("#modal_showStatements").modal('show');

        }

        function getCustomerDetails(CustomerId) {
            $("#csearch-box").val('');
            $("#csearch-box").text('');
            $('#CustomerId').text(CustomerId);
            $.ajax({
                type: "GET",
                url: '@Url.Action("GetCustomerDetailsbyId", "Customer", new { area = "Portal" })',
                data: {
                    customerId: CustomerId
                },
                success: function (data) {
                    $('#CustomerId').text(data.CustomerId);
                    $('#CustomerNo').text(data.CustomerNo);
                    $('#CustomerName').text(data.CustomerName);
                    $('#CustomerAddress').text(data.Address);
                    $('#CustomerState').text(data.Address2);

                    $('#staCustomerNo').text(data.CustomerNo);
                    $('#staContactName').text(data.ContactName);
                    $('#staCustomerName').text(data.CustomerName);
                    $('#staPhone').text(data.Phone);
                    $("#csearch-box").val('');
                    $("#csearch-box").text('');
                    _bindTransactions();
                }
            });


        }

        function formatJSONDateUtc(jsonDate) {
            if (jsonDate != null) {
                var dtstr = jsonDate.substr(6);
                var dateString = dtstr.substring(0, dtstr.length - 2);
                var currentTime = new Date(parseInt(dateString));
                var date = moment.utc(currentTime).format("MM/DD/YYYY");
                return date;
            }
            return null;
        }

        function _bindTransactions() {

            $('.datatableClass').show();
            $('#tblAllTra').show();
            $('#totalAmount').text('');
            $('#totalTax').text('');
            $('#totalDebit').text('');
            $('#totalCredit').text('');
            $('#totalBalance').text('');
            var _monthVal = $('#monthlist').val();
            var _yearVal = $('#yearlist').val();
            var elem = $('#tblAllTra tbody');
            var customerId = $('#CustomerId').text();
            var masterTrxTypeId = $("#CustomerTransactionType").val();
            var spnStartDate = $("#spnStartDate").text();
            var spnEndDate = $("#spnEndtDate").text();

            $.ajax({
                url: '@Url.Action("GetAllCustomerTransactions", "Customer", new { area = "Portal" })?CustomerId=' + customerId + '&TypeId=' + masterTrxTypeId + '&StartDate=' + spnStartDate + '&EndDate=' + spnEndDate + '&month=' + _monthVal + '&year=' + _yearVal,
                success: function (res) {

                    var tempRow = "";
                    $(elem).html('');
                    var vBalamt = -parseFloat(res.StartingBalance);
                    var showAllTransactions = parseInt(masterTrxTypeId) == 0;

                    /*tempRow += '<tr>';
                    tempRow += '<td colspan="2" style="text-align: center;font-size: 12px;">&nbsp;</td>';
                    tempRow += '<td style="text-align: center;font-size: 12px;">' + spnStartDate + '</td>'
                    tempRow += '<td style="text-align: center;font-size: 12px;">&nbsp;</td>';
                    tempRow += '<td style="text-align: center;font-size: 12px;">Previous Balance (as of ' + spnStartDate + ')</td>';
                    tempRow += '<td style="text-align: center;font-size: 12px;">&nbsp;</td>';
                    tempRow += '<td style="text-align: center;font-size: 12px;border-right: 2px solid blue;">&nbsp;</td>';
                    tempRow += '<td style="text-align: center;font-size: 12px;">&nbsp;</td>';
                    tempRow += '<td style="text-align: center;font-size: 12px;border-right: 2px solid blue;">&nbsp;</td>';
                    tempRow += '<td style="float: right;font-size: 12px;">' + formatCurrency(vBalamt, true) + '</td>';
                    tempRow += '<td style="text-align: center;font-size: 12px;">&nbsp;</td>';
                    tempRow += '</tr>';
                    $(elem).append(tempRow); */

                    var totalCredit = 0.0;
                    var totaldebit = 0.0;
                    var totalAmount = 0.0;
                    var totalTax = 0.0;
                    var totalBalance = parseFloat(vBalamt);

                    $.each(res.Transactions, function (index, value) {

                        tempRow = "";

                        totalBalance = totalBalance + parseFloat(value.CreditAmount) - parseFloat(value.DebitAmount);
                        totalAmount = totalAmount + parseFloat(value.Amount);
                        totalTax = totalTax + parseFloat(value.TotalTax);
                        totaldebit = totaldebit + parseFloat(value.DebitAmount);
                        totalCredit = totalCredit + parseFloat(value.CreditAmount);

                        // wrap calculation in parseFloat(x.toFixed(2)) to eliminate float precision error

                        var Number = (value.Number != null ? (value.TransactionTypeId == 1 || value.TransactionTypeId == 3 ? value.Number : value.TransactionNumber) : value.TransactionNumber);

                        var clickHandler = 'showInvoiceDetail(' + value.RefId + ')';    //Customer Invoice
                        if (value.TransactionTypeId == 2) // payment
                            clickHandler = 'btnOpenPaymentDetail(' + value.RefId + ')';
                        if (value.TransactionTypeId == 3) // Customer Credit
                            clickHandler = 'OpenCustomerCreditDetail(' + value.RefId + ')';

                        tempRow += '<tr>';
                        tempRow += '<td  colspan="2" style="text-align: left;font-size: 12px;">' + value.TransactionTypeName + '</td>';
                        tempRow += '<td style="text-align: center;font-size: 12px;">' + formatJSONDateUtc(value.TransactionDate)  + '</td>'
                        tempRow += '<td style="text-align: center;font-size: 12px;"><a onclick="' + clickHandler + '">' + Number + '</a></td>';
                        tempRow += '<td style="text-align: left;font-size: 12px;">' + value.Description + '</td>';

                        tempRow += '<td style="text-align: right;font-size: 12px;">' + formatCurrency(value.Amount, true) + '</td>';
                        tempRow += '<td style="text-align: right;font-size: 12px;border-right: 2px solid blue;">' + formatCurrency(value.TotalTax, true) + '</td>';

                        tempRow += '<td style="text-align: right;font-size: 12px;border-left: 2px solid blue;">' + formatCurrency(value.DebitAmount, true) + '</td>';
                        tempRow += '<td style="text-align: right;font-size: 12px;border-right: 2px solid blue;">' + formatCurrency(value.CreditAmount, true) + '</td>';
                        //tempRow += '<td style="text-align: right;font-size: 12px;border-left: 2px solid blue;">' + formatCurrency(totalBalance, true) + '</td>';

                        tempRow += '<td style="text-align: center;font-size: 12px;">' + value.StatusName + '</td>';
                        tempRow += '</tr>';

                        $(elem).append(tempRow);
                    });

                    $('#totalAmount').text(formatCurrency(totalAmount, true));
                    $('#totalTax').text(formatCurrency(totalTax, true));
                    $('#totalDebit').text(formatCurrency(totaldebit, true));
                    $('#totalCredit').text(formatCurrency(totalCredit, true));
                    $('#totalBalance').text(formatCurrency(totalBalance, true));
                },
                error: function () { }
            });

        }

        /*Payment Detail*/
        function btnOpenPaymentDetail(strNo) {
              
            $.blockUI();

            var sURL = '@Url.Action("PaymentDetailPopup", "AccountReceivable", new { area = "Portal" })?paymentId=' + strNo;
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    $('#form_paymentlist').html(data);
                    $("#modal_paymentdetail").modal({ backdrop: 'static' });
                    $('.modal-dialog').draggable();

                    $.unblockUI();
                },
                error: function () {
                    $.unblockUI();
                    alert("Content load failed.");
                }
            });
        }

        /*Invoice Detail*/
          function showInvoiceDetail(id) {
              $.blockUI();
            var sURL = '@Url.Action("InvoiceDetail", "AccountReceivable", new { area = "Portal" })?Id=' + id;
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    $('#form_invoicedetail').html(data);
                    $("#modal_invoicedetail").modal({ backdrop: 'static' });
                    $('.modal-dialog').draggable();
                    $.unblockUI();
                },
                error: function () {
                    $.unblockUI();
                    alert("Content load failed.");
                }
            });
          }

        /*Customer Credit Detail*/
        function OpenCustomerCreditDetail(id) {
            
            $.blockUI();
            var sURL = '@Url.Action("CustomerCreditDetailPopup", "AccountReceivable", new { area = "Portal" })?Id=' + id;
            $.ajax({
                type: "GET",
                url: sURL,
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (data) {
                    $('#form_CusCreditDetails').html(data);
                    $("#modal_CusCreditDetail").modal({ backdrop: 'static' });
                    $('.modal-dialog').draggable();
                    $.unblockUI();
                },
                error: function () {
                    alert("Content load failed.");
                }
            });
        };

        function btnInvoicePopupClose() {
            $("#modal_invoicedetail").modal('hide');
        }

        function _bindTransactionsForStatment(elem, typeid, sdate, edate, isForStatements) {
            isForStatements = (isForStatements == true ? true : false);
            var customerId = $('#CustomerId').text();
          
            $.ajax({
                url: '@Url.Action("CustomerDetailTransactions", "Customer","Portal")&CustomerId=' + customerId + '&TypeId=' + typeid + '&StartDate=' + sdate + '&EndDate=' + edate,
                success: function (res) {

                    var tempRow = "";
                    $(elem).html('');
                    var vBalamt = -parseFloat(res.StartingBalance);
                    var showAllTransactions = parseInt(typeid) == 0;

                    tempRow += '<tr>';
                    tempRow += '<td style="text-align: center;font-size: 12px;">&nbsp;</td>';
                    tempRow += '<td style="text-align: center;font-size: 12px;">' + moment(new Date(sdate)).format("MM/DD/YYYY") + '</td>'
                    tempRow += '<td style="text-align: center;font-size: 12px;">&nbsp;</td>';
                    tempRow += '<td style="text-align: center;font-size: 12px;">Previous Balance (as of ' + moment(new Date(sdate)).format("MM/DD/YYYY") + ')</td>';
                    tempRow += '<td style="text-align: right;font-size: 12px;">&nbsp;</td>';
                    tempRow += '<td style="text-align: right;font-size: 12px;">&nbsp;</td>';
                    tempRow += '<td style="text-align: right;font-size: 12px;' + ((vBalamt < 0 && showAllTransactions) ? 'color:red' : '') + '">' + formatCurrency(vBalamt, true) + '</td>';
                    tempRow += '</tr>';
                    $(elem).append(tempRow);

                    var credits = 0;
                    var debits = 0;

                    $.each(res.Transactions, function (index, value) {
                        tempRow = "";

                        var amtBal = parseFloat(value.Amount);

                        if (value.AmountTypeListId == 2)
                            credits += amtBal;
                        else if (value.AmountTypeListId == 1)
                            debits += amtBal;

                        // wrap calculation in parseFloat(x.toFixed(2)) to eliminate float precision error
                        vBalamt = parseFloat((vBalamt + (value.AmountTypeListId == 2 ? parseFloat(value.Amount) : (-parseFloat(value.Amount)))).toFixed(2));

                        var Number = (value.Number != null ? (value.TransactionTypeId == 1 || value.TransactionTypeId == 3 ? value.Number : value.TransactionNumber) : value.TransactionNumber);

                        var clickHandler = 'showInvoiceDetail(' + value.RefId + ')';  //Invoice
                        if (value.TransactionTypeId == 2) // payment
                            clickHandler = 'btnOpenPaymentDetail(' + value.RefId + ')';
                        if (value.TransactionTypeId == 3) // Customer Credit 
                            clickHandler = 'OpenCustomerCreditDetail(' + value.RefId + ')';

                        tempRow += '<tr>';
                        tempRow += '<td style="text-align: center;font-size: 12px;">' + value.TransactionTypeName + '</td>';
                        tempRow += '<td style="text-align: center;font-size: 12px;">' + moment(new Date(parseInt(value.TransactionDate.substr(6)))).format("MM/DD/YYYY") + '</td>'
                        tempRow += '<td style="text-align: center;font-size: 12px;"><a onclick="' + clickHandler + '">' + Number + '</a></td>';
                        tempRow += '<td style="text-align: center;font-size: 12px;">' + value.Description + '</td>';
                        tempRow += '<td style="text-align: right;font-size: 12px;">' + ((value.AmountTypeListId == 2) ? formatCurrency(value.Amount, true) : "&nbsp;") + '</td>';
                        tempRow += '<td style="text-align: right;font-size: 12px;">' + ((value.AmountTypeListId == 1) ? formatCurrency(value.Amount, true) : "&nbsp;") + '</td>';
                        tempRow += '<td style="text-align: right;font-size: 12px;' + ((vBalamt < 0 && showAllTransactions) ? 'color:red' : '') + '">' + formatCurrency(showAllTransactions ? vBalamt : value.Amount, true) + '</td>';
                        tempRow += '</tr>';

                        $(elem).append(tempRow);
                    });

                    if (isForStatements) {
                        $("#spnStatements_PreviousBalance").text(formatCurrency(-res.StartingBalance, true));
                        $("#spnStatements_Credits").text(formatCurrency(credits, true));
                        $("#spnStatements_Debits").text(formatCurrency(debits, true));
                        $("#spnStatements_NewBalance").text(formatCurrency(-res.StartingBalance + credits - debits, true));
                    }
                },
                error: function () { }
            });
        }

        function formatCurrency(total, dollar) {
            dollar = (dollar == true ? true : false);
            var neg = false;
            if (total < 0) {
                neg = true;
                total = Math.abs(total);
            }
            return (neg ? "-" : '') + (dollar ? "$" : "") + parseFloat(total, 10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, "$1,").toString();
        }


        function setPaging() {
            var z = $("#pageSize").val();
            var table = $("#tblAllTra").DataTable();
            if (z > 0) {
                table.page.len(z).draw();
            }
            else if (z == -1) {
                table.page.len(table.rows().count()).draw();
            }
            else {
                table.page.page.len(25).draw();
            }
        }

        function applyDurationFilter(v) {
            $('#spnStartDate').html('');
            $('#spnEndtDate').html('');
            $('.divspandate').show();
            $('#divSD').hide();
            $('#divED').hide();
            $('#divmonth').hide();
            $('#divyear').hide();
            $('#monthlist').val('');
            $('#yearlist').val('');
            switch (v) {
                case 1:
                    firstDay = moment().startOf('isoWeek').toString();
                    lastDay = moment().endOf('isoWeek').toString();
                    break;
                case 2:
                    //code block
                    firstDay = moment().startOf('isoWeek').toString();
                    lastDay = new Date().toString();
                    break;
                case 3:
                    firstDay = moment().subtract(0, 'month').startOf('month').toString();
                    lastDay = moment().subtract(0, 'month').endOf('month').toString();
                    break;
                case 4:
                    //code block
                    firstDay = moment().subtract(0, 'month').startOf('month').toString();
                    lastDay = new Date().toString();
                    break;
                case 5:
                    //code block
                    firstDay = moment().startOf('quarter').toString();
                    lastDay = moment().endOf('quarter').toString();
                    break;
                case 6:
                    //code block
                    firstDay = moment().startOf('quarter').toString();
                    lastDay = new Date().toString();
                    break;
                case 7:
                    //code block
                    firstDay = moment().startOf('year').toString();;
                    lastDay = moment().endOf('year').toString();
                    break;
                case 8:
                    //code block
                    firstDay = moment().startOf('year').toString();
                    lastDay = new Date().toString();
                    break;
                case 9:
                    //code block
                    firstDay = moment().toString();
                    lastDay = moment().toString();
                    break;
                case 10:
                    //code block
                    firstDay = moment().add(-1, 'days').toString();
                    lastDay = moment().add(-1, 'days').toString();
                    break;
                case 11:
                    //code block
                    firstDay = moment().subtract(1, 'week').startOf('week').toString();
                    lastDay = moment().subtract(1, 'week').endOf('week').toString();
                    break;
                case 12:
                    //code block
                    firstDay = moment().subtract(1, 'month').startOf('month').toString();
                    lastDay = moment().subtract(1, 'month').endOf('month').toString();
                    break;
                case 13:
                    //code block
                    firstDay = moment().subtract(1, 'quarter').startOf('quarter').toString();
                    lastDay = moment().subtract(1, 'quarter').endOf('quarter').toString();
                    break;
                case 14:
                    //code block
                    firstDay = moment().subtract(1, 'year').startOf('year').toString();
                    lastDay = moment().subtract(1, 'year').endOf('year').toString();
                    break;
                case 15:
                    //code block
                    $('.divspandate').hide();
                    $('#divSD').show();
                    $('#divED').show();
                    $('#txtStartDate').val('');
                    $('#txtEndtDate').val('')
                    break;
                case 16:
                    //code block
                    $('.divspandate').hide();
                    $('#divSD').hide();
                    $('#divED').hide();
                    $('#divmonth').show();
                    $('#divyear').show();
                    break;
                default:
                    //code block
            }
            $('#spnStartDate').html(moment(firstDay).format('L'));
            $('#spnEndtDate').html(moment(lastDay).format('L'));
            var CustomerId = $('#CustomerId').text();
            if (CustomerId) {
                _bindTransactions();
            }

        };
    </script>
}